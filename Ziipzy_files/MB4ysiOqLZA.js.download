;/*FB_PKG_DELIM*/

__d("BladeRunnerConfig",["RTISubscriptionManagerConfig","WebDriverConfig","cr:3024","gkx","isEmpty"],(function(t,n,r,o,a,i,l){var e,s="javascript-sandbox",u="OverrideServer",c="www_sandbox",d="www_tier",m=(function(){function t(){}var o=t.prototype;return o.patchRequestHeaders=function(o){var t={},a=r("RTISubscriptionManagerConfig").bladerunner_www_sandbox,i=r("RTISubscriptionManagerConfig").is_intern;if((e||(e=r("isEmpty")))(r("WebDriverConfig").auxiliaryServiceInfo))a!=null&&(t[s]=a);else{var l,m=(l=r("WebDriverConfig").auxiliaryServiceInfo.BladeRunner)!=null?l:r("WebDriverConfig").auxiliaryServiceInfo["BladeRunner-sandcastle"];m!=null?(typeof m.ip_address=="string"?t[u]=m.ip_address+":18295":typeof m.hostname=="string"&&(t[u]=m.hostname+":18295"),typeof r("WebDriverConfig").originHost=="string"&&(t[c]="www."+r("WebDriverConfig").originHost)):a!=null&&(t[s]=a)}if(i===!0&&(t[d]="intern"),r("WebDriverConfig").isTestRunning&&r("gkx")("20919")){var p=n("cr:3024")==null?void 0:n("cr:3024").get();p!=null&&(t.is_test="true",t.original_request_id=p)}r("gkx")("20929")&&(t["Accept-Ack"]="RSAck");for(var _ in o)t[_]=o[_];return t.http_referer=window.location.href,t},t})(),p=new m,_=p;l.default=_}),98);
__d("BladeRunnerLogger",["FBLogger","ODS"],(function(t,n,r,o,a,i,l){var e,s="bladerunner_js_client",u={info:"info",warning:"warning",exception:"exception"},c=(function(){function t(){this.setFBLoggerLevel(1)}var n=t.prototype;return n.info=function(t){this.$2>=2&&r("FBLogger")(s).info("BladeRunner info: %s",t),this.$3(u.info,t)},n.warn=function(t){this.$2>=1&&r("FBLogger")(s).warn("BladeRunner warn: %s",t),this.$3(u.warning,t)},n.exception=function(t,n){n===void 0&&(n="");var e=n+" "+t.toString();this.$2>=0&&r("FBLogger")(s).warn("BladeRunner exception: %s, %s",n,t.toString()),this.$3(u.exception,e)},n.trimForLogging=function(t){var e=1024;return typeof t=="string"&&t.length>e?"[trimmed]:"+t.substring(0,e)+"...":t},n.bumpCounter=function(n,r){r===void 0&&(r=1),(e||(e=o("ODS"))).bumpEntityKey(2966,"BladeRunnerClient",n,r)},n.setClientSessionId=function(t){this.$1=t},n.setFBLoggerLevel=function(t){this.$2=t},n.$3=function(t,n){},t})(),d=new c,m=d;l.default=m}),98);
__d("BladeRunnerStreamStatus",[],(function(t,n,r,o,a,i){"use strict";var e={CREATED:0,ACCEPTED:1,REJECTED:2,STARTED:3,STOPPED:4,CLOSED:5};i.StreamStatus=e}),66);
__d("BladeRunnerTypes",[],(function(t,n,r,o,a,i,l){var e={REQUEST:1,DATA:2,DATA_ACK:3,STATUS_UPDATE:4,REWRITE_REQUEST:5,LOG:6},s={BLADE_RUNNER:1,GATEWAY:2};l.StreamFrameType=e,l.StreamRequestType=s}),98);
__d("BladeRunnerTypesInternal",["Base64","BladeRunnerLogger","BladeRunnerTypes"],(function(t,n,r,o,a,i,l){var e=(function(){function e(){}var t=e.prototype;return t.getHeaders=function(){if(this.headers!=null)return this.headers;throw new Error("Expected headers")},t.getInstrumentationData=function(){if(this.instrumentationData!=null&&this.instrumentationData.length>0)try{return JSON.parse(this.instrumentationData)}catch(e){return null}else return null},t.updateRetryRequestPayload=function(t){t!=null?this.payload=r("Base64").encode(t):this.payload=null},e.readObject=function(n){var t=new e;return t.streamId=f(n.streamId),t.requestType=f(n.requestType),t.payload=y(n.payload),t.headers=v(n.headers),t.extraHeader=y(n.extraHeader),t.requestTarget=y(n.requestTarget),t.instrumentationData=y(n.instrumentationData),t},e})(),s=(function(){function e(){}e.readObject=function(n){var t=new e;return t.streamId=f(n.streamId),t.dataId=g(n.dataId),t.data=y(n.data),t.shouldAck=R(n.shouldAck),t};var t=e.prototype;return t.rawData=function(){if(this.data==null)throw new Error("Expected data");return this.data},t.rawDataSize=function(){return this.data==null?0:this.data.length},t.decodeData=function(){if(this.data==null)throw new Error("Expected data");return r("Base64").decode(this.data)},t.setData=function(t){this.data=r("Base64").encode(t)},t.getInstrumentationData=function(){return this.instrumentationData!=null?JSON.parse(this.instrumentationData):null},e})(),u=(function(){function e(){}return e.readObject=function(n){var t=new e;return t.streamId=f(n.streamId),t.dataId=f(n.dataId),t.success=S(n.success),t.message=y(n.message),t.code=g(n.code),t},e})();u.ACK_CODE_LANDED_AND_ACCEPTED=20,u.ACK_CODE_LANDED_BUT_NOT_ACCEPTED=21,u.ACK_CODE_FAILED_TO_LAND=50;var c=(function(){function e(){}return e.readObject=function(n){var t=new e;return t.streamId=g(n.streamId),t.message=y(n.message),t},e})(),d=(function(){function e(){}return e.readObject=function(n){var t=new e;return t.streamId=f(n.streamId),t.status=f(n.status),t.message=y(n.message),t.code=g(n.code),t.shouldRetry=R(n.shouldRetry),t.retryDelayMs=g(n.retryDelayMs),t},e})(),m=(function(){function e(){}return e.readObject=function(n){var t=new e;return t.streamId=f(n.streamId),t.newBody=y(n.newBody),t.newExtraHeader=y(n.newExtraHeader),t.patchExtraHeader=y(n.patchExtraHeader),t.killBody=R(n.killBody),t.temporary=R(n.temporary),t},e})(),p=(function(){function t(){}var n=t.prototype;return n.getRequest=function(){if(this.type==o("BladeRunnerTypes").StreamFrameType.REQUEST&&this.request!=null)return this.request;throw new Error("Expected request")},n.getData=function(){if(this.type==o("BladeRunnerTypes").StreamFrameType.DATA&&this.data!=null)return this.data;throw new Error("Expected data")},n.getDataAck=function(){if(this.type==o("BladeRunnerTypes").StreamFrameType.DATA_ACK&&this.dataAck!=null)return this.dataAck;throw new Error("Expected dataAck")},n.getStatusUpdate=function(){if(this.type==o("BladeRunnerTypes").StreamFrameType.STATUS_UPDATE&&this.statusUpdate!=null)return this.statusUpdate;throw new Error("Expected status update")},n.getLog=function(){if(this.type==o("BladeRunnerTypes").StreamFrameType.LOG&&this.log!=null)return this.log;throw new Error("Expected log")},n.getRewriteRequest=function(){if(this.type==o("BladeRunnerTypes").StreamFrameType.REWRITE_REQUEST&&this.rewriteRequest!=null)return this.rewriteRequest;throw new Error("Expected rewrite request")},n.getStreamId=function(){if(this.type==o("BladeRunnerTypes").StreamFrameType.REQUEST&&this.request!=null)return this.request.streamId;if(this.type==o("BladeRunnerTypes").StreamFrameType.DATA&&this.data!=null)return this.data.streamId;if(this.type==o("BladeRunnerTypes").StreamFrameType.STATUS_UPDATE&&this.statusUpdate!=null)return this.statusUpdate.streamId;if(this.type==o("BladeRunnerTypes").StreamFrameType.LOG&&this.log!=null)return this.log.streamId;if(this.type==o("BladeRunnerTypes").StreamFrameType.REWRITE_REQUEST&&this.rewriteRequest!=null)return this.rewriteRequest.streamId;if(this.type==o("BladeRunnerTypes").StreamFrameType.DATA_ACK&&this.dataAck!=null)return this.dataAck.streamId;throw new Error("Frame with unexpected type")},n.isInstrumented=function(){return this.type===o("BladeRunnerTypes").StreamFrameType.REQUEST?this.getRequest().instrumentationData!=null:this.type===o("BladeRunnerTypes").StreamFrameType.DATA?this.getData().instrumentationData!=null:!1},t.readObject=function(a){var n=new t;switch(n.type=f(a.type),n.type){case o("BladeRunnerTypes").StreamFrameType.REQUEST:n.request=e.readObject(C(a.request));break;case o("BladeRunnerTypes").StreamFrameType.DATA:n.data=s.readObject(C(a.data));break;case o("BladeRunnerTypes").StreamFrameType.DATA_ACK:n.dataAck=u.readObject(C(a.dataAck));break;case o("BladeRunnerTypes").StreamFrameType.STATUS_UPDATE:n.statusUpdate=d.readObject(C(a.statusUpdate));break;case o("BladeRunnerTypes").StreamFrameType.LOG:n.log=c.readObject(C(a.log));break;case o("BladeRunnerTypes").StreamFrameType.REWRITE_REQUEST:n.rewriteRequest=m.readObject(C(a.rewriteRequest));break;default:return r("BladeRunnerLogger").warn("Frame with unexpected type: "+n.type),null}return n},t.newRequestFrame=function(n){var e=new t;return e.type=o("BladeRunnerTypes").StreamFrameType.REQUEST,e.request=n,e},t.newDataFrame=function(n){var e=new t;return e.type=o("BladeRunnerTypes").StreamFrameType.DATA,e.data=n,e},t.newDataAckFrame=function(n){var e=new t;return e.type=o("BladeRunnerTypes").StreamFrameType.DATA_ACK,e.dataAck=n,e},t.newStatusUpdateFrame=function(n){var e=new t;return e.type=o("BladeRunnerTypes").StreamFrameType.STATUS_UPDATE,e.statusUpdate=n,e},t.newLogFrame=function(n){var e=new t;return e.type=o("BladeRunnerTypes").StreamFrameType.LOG,e.log=n,e},t.newRewriteRequestFrame=function(n){var e=new t;return e.type=o("BladeRunnerTypes").StreamFrameType.REWRITE_REQUEST,e.rewriteRequest=n,e},t})(),_=(function(){function e(e,t,n){this.batchId=e,this.frames=t,this.instrumentationData=n}var t=e.prototype;return t.getFrames=function(){if(this.frames!=null)return this.frames;throw new Error("Expected frames")},t.getInstrumentationData=function(){if(this.instrumentationData!=null)try{return JSON.parse(this.instrumentationData)}catch(e){return null}else return null},t.getInstrumentationDataDfTraceId=function(){if(this.instrumentationData!=null)try{var e,t=JSON.parse(this.instrumentationData);return(e=t.dataFlowTracingData)==null?void 0:e.traceId}catch(e){return null}else return null},t.write=function(){return JSON.stringify(this)},t.isInstrumented=function(){return this.getFrames().some(function(e){return e.isInstrumented()})},e.read=function(n){var t=JSON.parse(n),r=t.batchId||0,o=[];for(var a of t.frames){var i=p.readObject(a);i!=null&&o.push(i)}var l=t.instrumentationData||null;return new e(r,o,l)},e})();function f(e){if(typeof e=="number")return e;throw new Error("Expected number")}function g(e){return e==null?null:f(e)}function h(e){if(typeof e=="string")return e;throw new Error("Expected string")}function y(e){return e==null?null:h(e)}function C(e){if(typeof e=="object"&&e!=null)return e;throw new Error("Expected object")}function b(e){if(typeof e=="object"&&e!=null){var t=e,n={};return Object.keys(t).forEach(function(e){var r=t[e];typeof r=="string"&&r!=null&&(n[e]=r)}),n}throw new Error("Expected string map")}function v(e){return e==null?null:b(e)}function S(e){if(typeof e=="boolean"&&e!=null)return e;throw new Error("Expected boolean")}function R(e){return e==null?null:S(e)}l.GatewayStreamRequest=e,l.GatewayStreamData=s,l.GatewayStreamDataAck=u,l.GatewayStreamLog=c,l.GatewayStreamStatusUpdate=d,l.GatewayStreamRewriteRequest=m,l.GatewayStreamFrame=p,l.GatewayStreamBatch=_}),98);
__d("RequestStreamE2EClientLoggerEvent",[],(function(t,n,r,o,a,i){var e=Object.freeze({RECEIVED:"received",SENT:"sent",FAILURE:"failure",PUBACK:"puback"});i.default=e}),66);
__d("RequestStreamE2EClientLoggerMessageType",[],(function(t,n,r,o,a,i){var e=Object.freeze({REQUEST_STREAM:"request_stream",AMENDMENT:"amendment",AMENDMENT_ACK:"amendment_ack",CANCEL:"cancel",RESPONSE:"response",RESPONSE_ACK:"response_ack",TIMED_REQUEST:"timed_request",INTERRUPT:"interrupt"});i.default=e}),66);
__d("BladeRunnerEventHandler",["BladeRunnerLogger","BladeRunnerStreamStatus","BladeRunnerTypes","BladeRunnerTypesInternal","RequestStreamE2EClientLoggerEvent","RequestStreamE2EClientLoggerMessageType","getErrorSafe","setTimeoutAcrossTransitions"],(function(t,n,r,o,a,i,l){var e=1e3,s=(function(){function t(e,t,n){this.$2=e,this.$1=t,this.$3=n}var n=t.prototype;return n.onProxyResponse=function(t){var e,n;this.$4(t);var a=[];for(var i of t.getFrames())this.$2.witnessFrame(i)&&a.push(i);var l=this.$2.getRequest();(e=l.e2eLogger)==null||e.logE2EEvent(r("RequestStreamE2EClientLoggerMessageType").RESPONSE,r("RequestStreamE2EClientLoggerEvent").SENT,{},(n=t.getInstrumentationData())==null?void 0:n.auxId,null,t.getInstrumentationDataDfTraceId()),a.length>0&&this.$5(new(o("BladeRunnerTypesInternal")).GatewayStreamBatch(t.batchId,a,t.instrumentationData))},n.onDisconnect=function(){this.$2.resetErrors();var e=new(o("BladeRunnerTypesInternal")).GatewayStreamStatusUpdate;e.streamId=this.$2.getRequest().streamId,e.status=o("BladeRunnerStreamStatus").StreamStatus.CLOSED,e.shouldRetry=!0,e.retryDelayMs=0;var t=new(o("BladeRunnerTypesInternal")).GatewayStreamBatch(null,[o("BladeRunnerTypesInternal").GatewayStreamFrame.newStatusUpdateFrame(e)]);this.onProxyResponse(t)},n.$4=function(n){var t=this,a=n.getFrames().filter(function(e){return e.type==o("BladeRunnerTypes").StreamFrameType.STATUS_UPDATE});for(var i of a){var l=i.getStatusUpdate();if(l.status==o("BladeRunnerStreamStatus").StreamStatus.CLOSED||l.status==o("BladeRunnerStreamStatus").StreamStatus.REJECTED){this.$2.onError();var s=l.shouldRetry!=null&&l.shouldRetry,u=l.message!=null?l.message:"null";if(s&&this.$2.getErrorCount()<=this.$2.getRetriesAllowed()){l.status=o("BladeRunnerStreamStatus").StreamStatus.STOPPED;var c=e;l.retryDelayMs!=null&&(c=l.retryDelayMs),r("BladeRunnerLogger").info("Can retry: stream "+l.streamId+" closed with status "+l.status+", message "+u+". Error count: "+this.$2.getErrorCount()+", retryDelay "+c+"ms. Already retrying: "+this.$2.getRetryRequestScheduled().toString()),this.$2.getRetryRequestScheduled()?r("BladeRunnerLogger").bumpCounter("stream_closed_already_retrying"):(r("BladeRunnerLogger").bumpCounter("stream_closed_will_retry"),this.$2.setRetryRequestScheduled(!0),c>0?r("setTimeoutAcrossTransitions")(function(){return t.$6()},c):this.$6())}else r("BladeRunnerLogger").info("Will not retry: stream "+l.streamId+" closed with status "+l.status+", message "+u+". Error count: "+this.$2.getErrorCount()+", shouldRetry "+s.toString()+". Already retrying: "+this.$2.getRetryRequestScheduled().toString()),s?r("BladeRunnerLogger").bumpCounter("stream_closed_retry_exceeded"):r("BladeRunnerLogger").bumpCounter("stream_closed_no_retry"),this.$3.removeStream(l.streamId)}}},n.$6=function(){if(this.$2.setRetryRequestScheduled(!1),this.$2.isAlive()){var e=this.$1.getUpdatedRequestBody();e!=null&&this.$2.updateRetryRequestPayload(e),this.$3.sendRetryStreamRequest(this.$2)}},n.$5=function(t){r("BladeRunnerLogger").bumpCounter("send_to_handler");var e=[];this.$1.onBatch(t);for(var n of t.getFrames())try{switch(n.type){case o("BladeRunnerTypes").StreamFrameType.DATA:this.$1.onData(n.getData()),e.push(n.getData());break;case o("BladeRunnerTypes").StreamFrameType.STATUS_UPDATE:this.$1.onStatusUpdate(n.getStatusUpdate().status);break;case o("BladeRunnerTypes").StreamFrameType.LOG:var a=n.getLog().message;a!=null&&this.$1.onLog(a);break;case o("BladeRunnerTypes").StreamFrameType.DATA_ACK:break;default:throw new Error("Frame with unexpected type")}}catch(e){var i=r("getErrorSafe")(e);r("BladeRunnerLogger").bumpCounter("send_to_handler_error"),r("BladeRunnerLogger").exception(i,"Failed sending frame to stream handler")}this.$7(e)},n.$7=function(t){var e=[];for(var n of t)if(n.shouldAck===!0&&n.dataId!=null){var r=new(o("BladeRunnerTypesInternal")).GatewayStreamDataAck;r.streamId=n.streamId,r.dataId=n.dataId,r.success=!0,e.push(r)}this.$3.sendDataAcks(e)},t})();l.default=s}),98);
__d("ChannelClientID",["MqttWebDeviceID","gkx","uuidv4"],(function(t,n,r,o,a,i,l){"use strict";var e,s=r("gkx")("21118")?r("uuidv4")():(e=r("MqttWebDeviceID")==null?void 0:r("MqttWebDeviceID").clientID)!=null?e:r("uuidv4")(),u={getID:function(){return s}};i.exports=u}),34);
__d("IrisSubscribeCheckerUtils",[],(function(t,n,r,o,a,i){"use strict";function e(){if(typeof window!="undefined"){var e,t=(e=window.location)==null?void 0:e.hostname;if(t==="m.facebook.com"||t==="mobile.facebook.com"||t==="mtouch.facebook.com")return!1}return!0}i.getIrisSubscribeCheckerInitialRunningState=e}),66);
__d("MqttEnvWebSocket",[],(function(t,n,r,o,a,i){"use strict";function e(e){return new WebSocket(e)}i.createWebSocket=e}),66);
__d("MqttEnv",["MqttEnvWebSocket","clearTimeout","setTimeout"],(function(t,n,r,o,a,i,l){"use strict";var e=Object.freeze({mqtt_waterfall_log_client_sampling:1,mqtt_ws_polling_enabled:3,mqtt_lp_use_fetch:9,mqtt_fast_lp:11,mqtt_lp_no_delay:12,mqtt_enable_publish_over_polling:13,mqttweb_global_connection_counter:15}),s=(function(){function e(){this.$1=null,this.$2=null,this.$3=null,this.$4=null,this.$5=null,this.$6=null,this.$7=null,this.$8=null,this.$9=null,this.$10=null,this.$11=null}var t=e.prototype;return t.random=function(){return this.$1!=null?this.$1():Math.random()},t.isUserLoggedInNow=function(){return this.$2!=null?this.$2():!0},t.setIsUserLoggedInNow=function(t){this.$2=t},t.clearTimeout=function(t){if(this.$3!=null){this.$3(t);return}r("clearTimeout")(t)},t.setTimeout=function(t,n){for(var e=arguments.length,o=new Array(e>2?e-2:0),a=2;a<e;a++)o[a-2]=arguments[a];return this.$4!=null?this.$4.apply(null,arguments):r("setTimeout").apply(null,arguments)},t.getLoggerInstance=function(){return this.$5!=null?this.$5():u.getInstance()},t.genGk=function(t){return this.$6!=null?this.$6(t):!1},t.createSocket=function(t,n){return this.$7!=null?this.$7(t,n):o("MqttEnvWebSocket").createWebSocket(t)},t.scheduleCallback=function(t){return this.$8!=null?this.$8(t):t()},t.scheduleLoggingCallback=function(t){return this.$9!=null?this.$9(t):t()},t.configRead=function(t,n){return this.$10!=null?this.$10(t,n):n},t.configWrite=function(t,n){this.$11!=null&&this.$11(t,n)},t.initialize=function(t,n,r,o,a,i,l,s,u,c,d){this.$1=t,this.$2=n,this.$3=r,this.$4=o,this.$5=a,this.$6=i,this.$7=l,this.$8=s,this.$9=u,this.$10=c,this.$11=d},e})(),u=(function(){function e(){}e.getInstance=function(){return new e};var t=e.prototype;return t.setAppId=function(t){},t.eventLogConnect=function(t){},t.eventLogPull=function(t){},t.eventLogPullFinish=function(t){},t.eventLogDisconnect=function(t){},t.eventLogOutgoingPublish=function(t){},t.eventLogIncomingPublish=function(t){},t.eventLogPublishTimeout=function(t){},t.eventLogMiscellaneousError=function(t){},t.logIfLoggedOut=function(){},t.logError=function(t){},t.logErrorWarn=function(t){},t.logWarn=function(t){},t.debugTrace=function(t){},t.bumpCounter=function(t){},t.getBrowserConnectivity=function(){return!0},e})(),c=new s;function d(e){c.setIsUserLoggedInNow(e)}l.MqttGkNames=e,l.Env=c,l.setIsUserLoggedInNow=d}),98);
__d("IrisSubscribeChecker",["IrisSubscribeCheckerUtils","MqttEnv"],(function(t,n,r,o,a,i,l){"use strict";var e=(function(){function e(e){this.$1=o("MqttEnv").Env.getLoggerInstance(),this.$2=null,this.$3=!1,this.$4=!1,this.$5=!1,this.$6=o("IrisSubscribeCheckerUtils").getIrisSubscribeCheckerInitialRunningState(),this.$7=0,this.$8=e}var t=e.prototype;return t.start=function(){this.$6=!0},t.stop=function(){this.$6=!1,this.$9()},t.onConnectAttempt=function(){},t.onConnectFailure=function(){this.$9()},t.onConnected=function(){var e=this;this.$7++,this.$9(),this.$3=!1,this.$4=!1,this.$5=!1,this.$6&&(this.$2=o("MqttEnv").Env.setTimeout(function(){e.$10()},8e3))},t.onConnectSuccess=function(){},t.onConnectionLost=function(){this.$9()},t.onConnectionDisconnect=function(){},t.onSubscribe=function(t){t==="/t_ms"&&(this.$3=!0)},t.onUnsubscribe=function(t){},t.onPublish=function(t){(t==="/messenger_sync_get_diffs"||t==="/messenger_sync_create_queue")&&(this.$4=!0,this.$3&&(this.$5=!0,this.$9()))},t.onMessage=function(t){},t.onWSFatal=function(){},t.$9=function(){this.$2&&(o("MqttEnv").Env.clearTimeout(this.$2),this.$2=null)},t.$10=function(){if(this.$4===!1){var e=this.$7==1?"no_iris_session_initialConnect":"no_iris_session";this.$1.bumpCounter(e),this.$8()?this.$1.bumpCounter(e+".withProvider"):this.$1.bumpCounter(e+".withoutProvider"),this.$3===!0?this.$1.bumpCounter(e+".withTopicSubscribe"):this.$1.bumpCounter(e+".withoutTopicSubscribe")}this.$3===!1&&this.$1.bumpCounter("no_iris_topic_subscribe"),this.$3===!0&&this.$4===!0&&this.$5===!1&&this.$1.bumpCounter("session_before_topic_subscribe")},e})();l.default=e}),98);
__d("MetaConfig",["invariant","BanzaiLazyQueue","ExecutionEnvironment","MetaConfigMap"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u={},c={_:function(n){var t=r("MetaConfigMap").get(n);t!=null||s(0,57910,n);var a=t.value,i=t.log_id;return i!=null&&u[n]!==!0&&((e||(e=r("ExecutionEnvironment"))).isInBrowser&&o("BanzaiLazyQueue").queuePost("metaconfig_exposure",{identifier:n,log_id:i}),u[n]=!0),a}},d=c;l.default=d}),98);
__d("CacheStorage",["ErrorGuard","ExecutionEnvironment","WebStorage","cr:6943","cr:8958","emptyFunction","err"],(function(t,n,r,o,a,i,l){var e,s,u,c,d="_@_",m="3b",p="CacheStorageVersion",_={length:0,getItem:c=r("emptyFunction"),setItem:c,clear:c,removeItem:c,key:c},f=(function(){function e(e){this._store=e}var t=e.prototype;return t.getStore=function(){return this._store},t.keys=function(){for(var e=[],t=0;t<this._store.length;t++){var n=this._store.key(t);n!=null&&e.push(n)}return e},t.get=function(t){return this._store.getItem(t)},t.set=function(t,n){this._store.setItem(t,n)},t.remove=function(t){this._store.removeItem(t)},t.clear=function(){this._store.clear()},t.clearWithPrefix=function(t){t=t||"";for(var e=this.keys(),n=0;n<e.length;n++){var r=e[n];r!=null&&r.startsWith(t)&&this.remove(r)}},e})(),g=(function(t){function n(){var n;return t.call(this,(n=(e||(e=r("WebStorage"))).getLocalStorage())!=null?n:_)||this}return babelHelpers.inheritsLoose(n,t),n.available=function(){return!!(e||(e=r("WebStorage"))).getLocalStorage()},n})(f),h=(function(t){function n(){var n;return t.call(this,(n=(e||(e=r("WebStorage"))).getSessionStorage())!=null?n:_)||this}return babelHelpers.inheritsLoose(n,t),n.available=function(){return!!(e||(e=r("WebStorage"))).getSessionStorage()},n})(f),y=(function(){function e(){this._store={}}var t=e.prototype;return t.getStore=function(){return this._store},t.keys=function(){return Object.keys(this._store)},t.get=function(t){return this._store[t]===void 0?null:this._store[t]},t.set=function(t,n){this._store[t]=n},t.remove=function(t){t in this._store&&delete this._store[t]},t.clear=function(){this._store={}},t.clearWithPrefix=function(t){t=t||"";for(var e=this.keys(),n=0;n<e.length;n++){var r=e[n];r.startsWith(t)&&this.remove(r)}},e.available=function(){return!0},e})(),C={memory:y,localstorage:g,sessionstorage:h},b=(function(){function t(e,t){this._changeCallbacks=[],this._key_prefix="_cs_";var o;this._exception=null,t&&(this._key_prefix=t),e==="AUTO"||!e?o="memory":o=e,o&&(!C[o]||!C[o].available()?((s||(s=r("ExecutionEnvironment"))).canUseDOM,this._backend=new y):this._backend=new C[o]);var a=this.useBrowserStorage();a&&n("cr:6943").listen(window,"storage",this._onBrowserValueChanged.bind(this));var i=a?this._backend.getStore().getItem(p):this._backend.getStore()[p];i!==m&&this.clearOwnKeys()}var o=t.prototype;return o.useBrowserStorage=function(){return this._backend.getStore()===(e||(e=r("WebStorage"))).getLocalStorage()||this._backend.getStore()===(e||(e=r("WebStorage"))).getSessionStorage()},o.addValueChangeCallback=function(t){var e=this;return this._changeCallbacks.push(t),{remove:function(){e._changeCallbacks.slice(e._changeCallbacks.indexOf(t),1)}}},o._onBrowserValueChanged=function(t){this._changeCallbacks&&String(t.key).startsWith(this._key_prefix)&&this._changeCallbacks.forEach(function(e){e(t.key,t.oldValue,t.newValue)})},o.keys=function(){var e=this,t=[];return(u||(u=r("ErrorGuard"))).guard(function(){if(e._backend)for(var n=e._backend.keys(),r=e._key_prefix.length,o=0;o<n.length;o++)n[o].substr(0,r)==e._key_prefix&&t.push(n[o].substr(r))},{name:"CacheStorage"})(),t},o.set=function(o,a,i){if(this._backend){if(this.useBrowserStorage()&&t._persistentWritesDisabled)return this._exception=r("err")("writes disabled"),!1;var e;typeof a=="string"?e=d+a:i?e=n("cr:8958").stringify(a):(e={__t:Date.now(),__v:a},e=n("cr:8958").stringify(e));for(var l=this._backend,s=this._key_prefix+o,u=!0,c=null;u;)try{c=null,l.set(s,e),u=!1}catch(e){c=e;var m=l.keys().length;this._evictCacheEntries(),u=l.keys().length<m}return c!==null?(this._exception=c,!1):(this._exception=null,!0)}return this._exception=r("err")("no back end"),!1},o.getLastSetExceptionMessage=function(){return this._exception?this._exception.message:null},o.getLastSetException=function(){return this._exception},o.getStorageKeyCount=function(){var e=this._backend;return e?e.keys().length:0},o._evictCacheEntries=function(){var e=[],r=this._backend;r.keys().forEach(function(o){if(o!==p){var a=r.get(o);if(a===void 0){r.remove(o);return}if(!t._hasMagicPrefix(a)){try{a=n("cr:8958").parse(a,i.id)}catch(e){r.remove(o);return}a&&a.__t!==void 0&&a.__v!==void 0&&e.push([o,a.__t])}}}),e.sort(function(e,t){return e[1]-t[1]});for(var o=0;o<Math.ceil(e.length/2);o++)r.remove(e[o][0])},o.get=function(o,a){var e;if(this._backend)if((u||(u=r("ErrorGuard"))).applyWithGuard(function(){e=this._backend.get(this._key_prefix+o)},this,[],{onError:function(){e=null},name:"CacheStorage:get"}),e!=null)if(t._hasMagicPrefix(e))e=e.substr(d.length);else try{e=n("cr:8958").parse(e,i.id),e&&e.__t!==void 0&&e.__v!==void 0&&(e=e.__v)}catch(t){e=void 0}else e=void 0;return e===void 0&&a!==void 0&&(e=a,this.set(o,e)),e},o.remove=function(t){this._backend&&(u||(u=r("ErrorGuard"))).applyWithGuard(this._backend.remove,this._backend,[this._key_prefix+t],{name:"CacheStorage:remove"})},o._setVersion=function(){var e=this;(u||(u=r("ErrorGuard"))).applyWithGuard(function(){e.useBrowserStorage()?e._backend.getStore().setItem(p,m):e._backend.getStore()[p]=m},this,[],{name:"CacheStorage:setVersion"})},o.clear=function(){this._backend&&((u||(u=r("ErrorGuard"))).applyWithGuard(this._backend.clear,this._backend,[],{name:"CacheStorage:clear"}),this._setVersion())},o.clearOwnKeys=function(){this._backend&&((u||(u=r("ErrorGuard"))).applyWithGuard(this._backend.clearWithPrefix,this._backend,[this._key_prefix],{name:"CacheStorage:clearOwnKeys"}),this._setVersion())},t.getAllStorageTypes=function(){return Object.keys(C)},t._hasMagicPrefix=function(t){return t.substr(0,d.length)===d},t.disablePersistentWrites=function(){t._persistentWritesDisabled=!0},t})();b._persistentWritesDisabled=!1,i.exports=b}),34);
__d("CrossWindowEventEmitter",["CacheStorage","EventEmitter","cr:8958"],(function(t,n,r,o,a,i,l){"use strict";var e=(function(e){function t(t){var o;return o=e.call(this)||this,o.$CrossWindowEventEmitter$p_2=t,o.$CrossWindowEventEmitter$p_1=new(r("CacheStorage"))("localstorage",t+":"),o.$CrossWindowEventEmitter$p_1.addValueChangeCallback(function(t,r,a){var i=t.split(":")[1],l;try{l=n("cr:8958").parse(a)}catch(e){l=void 0}if(l&&l.__v){var s;(s=e.prototype.emit).call.apply(s,[o,i].concat(l.__v))}}),o}babelHelpers.inheritsLoose(t,e);var o=t.prototype;return o.emit=function(n){for(var t,r=arguments.length,o=new Array(r>1?r-1:0),a=1;a<r;a++)o[a-1]=arguments[a];this.emitRemote.apply(this,[n].concat(o)),(t=e.prototype.emit).call.apply(t,[this,n].concat(o))},o.emitRemote=function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];this.$CrossWindowEventEmitter$p_1.set(t,n)},t})(r("EventEmitter"));l.default=e}),98);
__d("MqttGlobalStreamCounter",["CrossWindowEventEmitter","MqttEnv","uuidv4"],(function(t,n,r,o,a,i,l){"use strict";var e=(function(){function e(){var e=this;this.isTabClosed=!1,this.otherTabs=new Map,this.thisTab={totalConnectionStreams:0},this.broadcastChannel=new(r("CrossWindowEventEmitter"))("MqttGlobalStreamCounter"),this.broadcastChannel.addListener("count-updated",function(t){var n=JSON.parse(String(t)),r=!1;e.otherTabs.has(n.key)||(r=!0),n.event==="DELETE"?e.otherTabs.delete(n.key):n.event==="UPDATE"&&n.value!=null&&(e.otherTabs.set(n.key,n.value),r&&e.$1())}),this.tabID=r("uuidv4")()}var t=e.prototype;return t.streamRequested=function(){this.thisTab.totalConnectionStreams++,this.$1()},t.streamClosed=function(){this.thisTab.totalConnectionStreams>0&&(this.thisTab.totalConnectionStreams--,this.$1())},t.tabClosed=function(){if(!this.isTabClosed){this.isTabClosed=!0;var e={key:this.tabID,event:"DELETE"};this.broadcastChannel.emitRemote("count-updated",JSON.stringify(e))}},t.getGlobalState=function(){var e={totalConnectionStreams:this.thisTab.totalConnectionStreams};return this.otherTabs.forEach(function(t){e.totalConnectionStreams+=t.totalConnectionStreams}),e},t.$1=function(){var e={key:this.tabID,event:"UPDATE",value:this.thisTab};this.broadcastChannel.emitRemote("count-updated",JSON.stringify(e))},t.isEnabled=function(){return!0},e})(),s=o("MqttEnv").Env.genGk(o("MqttEnv").MqttGkNames.mqttweb_global_connection_counter)?new e:{streamRequested:function(){},streamClosed:function(){},tabClosed:function(){},getGlobalState:function(){return{totalConnectionStreams:-1}},isEnabled:function(){return!1}},u=function(){return s};l.getInstance=u}),98);
__d("MqttAnalyticsHook",["MqttEnv","MqttGlobalStreamCounter"],(function(t,n,r,o,a,i,l){"use strict";var e=(function(){function e(){this.$1=o("MqttEnv").Env.getLoggerInstance(),this.$2=o("MqttGlobalStreamCounter").getInstance(),this.$3=0,this.$4=0,this.$5=0,this.$6=0,this.$1.bumpCounter("session_start"),o("MqttEnv").Env.isUserLoggedInNow()||this.$1.bumpCounter("session_start.logout")}var t=e.prototype;return t.onConnectAttempt=function(){this.$1.bumpCounter("ws_connect_attempt"),this.$2.streamRequested()},t.onConnectFailure=function(){this.$4++,this.$1.bumpCounter("ws_connect_failure"),this.$1.debugTrace("connect","Connect failed existing streams count "+this.$2.getGlobalState().totalConnectionStreams),this.$2.streamClosed()},t.onConnected=function(){this.$1.bumpCounter("ws_connect_connected")},t.onConnectSuccess=function(){this.$3===0&&this.$1.bumpCounter("ws_connect_first_success"),this.$3++,this.$1.bumpCounter("ws_connect_success")},t.onConnectionLost=function(){this.$1.bumpCounter("ws_disconnect")},t.onConnectionDisconnect=function(){this.$2.streamClosed()},t.onSubscribe=function(t){},t.onUnsubscribe=function(t){},t.onPublish=function(t){this.$1.bumpCounter("ws_publish."+t)},t.onMessage=function(t){this.$1.bumpCounter("message_arrived."+t)},t.onWSFatal=function(){this.$1.bumpCounter("ws_fatal")},t.onPollRequestSent=function(){this.$1.bumpCounter("polling_request_send"),this.$2.streamRequested()},t.onPollRequestSuccess=function(){this.$1.bumpCounter("polling_request_succeed"),this.$5===0&&this.$1.bumpCounter("polling_first_success"),this.$5++},t.onPollResponse=function(t){this.$1.bumpCounter("lp.message_arrived."+t)},t.onPollFinish=function(){this.$1.bumpCounter("polling_request_finish"),this.$2.streamRequested()},t.onPollRequestFailed=function(t){this.$1.bumpCounter("polling_request_failed"),this.$1.bumpCounter("polling_request_failed_"+t),this.$6++,this.$1.debugTrace("PollRequest","Request failed existing streams count "+this.$2.getGlobalState().totalConnectionStreams),this.$2.streamClosed()},t.onPollShutdownAbort=function(){this.$2.streamClosed()},t.onTabClose=function(){this.$2.tabClosed()},e})();l.default=e}),98);
__d("MqttConnectionHookCollection",[],(function(t,n,r,o,a,i){"use strict";var e=(function(){function e(){this.$1=new Set}var t=e.prototype;return t.addHook=function(t){this.$1.add(t)},t.removeHook=function(t){this.$1.delete(t)},t.onConnectAttempt=function(){this.$1.forEach(function(e){e.onConnectAttempt==null||e.onConnectAttempt()})},t.onConnectFailure=function(){this.$1.forEach(function(e){e.onConnectFailure==null||e.onConnectFailure()})},t.onConnected=function(){this.$1.forEach(function(e){e.onConnected==null||e.onConnected()})},t.onConnectSuccess=function(){this.$1.forEach(function(e){e.onConnectSuccess==null||e.onConnectSuccess()})},t.onConnectionLost=function(){this.$1.forEach(function(e){e.onConnectionLost==null||e.onConnectionLost()})},t.onConnectionDisconnect=function(){this.$1.forEach(function(e){e.onConnectionDisconnect==null||e.onConnectionDisconnect()})},t.onSubscribe=function(t){this.$1.forEach(function(e){e.onSubscribe==null||e.onSubscribe(t)})},t.onUnsubscribe=function(t){this.$1.forEach(function(e){e.onUnsubscribe==null||e.onUnsubscribe(t)})},t.onPublish=function(t){this.$1.forEach(function(e){e.onPublish==null||e.onPublish(t)})},t.onMessage=function(t){this.$1.forEach(function(e){e.onMessage==null||e.onMessage(t)})},t.onWSFatal=function(){this.$1.forEach(function(e){e.onWSFatal==null||e.onWSFatal()})},e})();i.default=e}),66);
__d("MqttProtocolUtils",["MqttEnv"],(function(t,n,r,o,a,i,l){"use strict";function e(e,t){if(e==null)return t;var n=new Uint8Array(e.length+t.length);return n.set(e),n.set(t,e.length),n}function s(e,t){var n=t,r=0,o=1,a;do{if(n===e.length)return null;a=e[n++],r+=(a&127)*o,o*=128}while((a&128)!==0);return{offset:n,value:r}}function u(e){for(var t=e,n=new Array(1),r=0;r<4;r++){var o=t%128;if(t>>=7,t>0)n[r]=o|128;else{n[r]=o;break}}return n}function c(e,t,n){var r=n;return t[r++]=e>>8,t[r++]=e%256,r}function d(e,t){return 256*e[t]+e[t+1]}function m(e){for(var t=0,n=0,r=e.length;n<r;n++){var o=e.charCodeAt(n);o<128?t+=1:o<2048?t+=2:o>=55296&&o<=56319?(t+=4,n++):t+=3}return t}function p(e,t,n,r){var o=c(t,n,r);return _(e,n,o),o+t}function _(e,t,n){for(var r=n,o=0,a=e.length;o<a;o++){var i=e.charCodeAt(o);i<128?t[r++]=i:i<2048?(t[r++]=192|i>>6,t[r++]=128|i&63):i<55296||i>=57344?(t[r++]=224|i>>12,t[r++]=128|i>>6&63,t[r++]=128|i&63):(i=65536+((i&1023)<<10|e.charCodeAt(++o)&1023),t[r++]=240|i>>18,t[r++]=128|i>>12&63,t[r++]=128|i>>6&63,t[r++]=128|i&63)}}function f(e,t,n){for(var r=[],o=t,a=0;o<t+n;){var i=e[o++];if(i<128)r[a++]=String.fromCharCode(i);else if(i>191&&i<224){var l=e[o++];r[a++]=String.fromCharCode((i&31)<<6|l&63)}else if(i>239&&i<365){var s=e[o++],u=e[o++],c=e[o++],d=((i&7)<<18|(s&63)<<12|(u&63)<<6|c&63)-65536;r[a++]=String.fromCharCode(55296+(d>>10)),r[a++]=String.fromCharCode(56320+(d&1023))}else{var m=e[o++],p=e[o++];r[a++]=String.fromCharCode((i&15)<<12|(m&63)<<6|p&63)}}return r.join("")}var g=(function(){function e(e,t,n,r){this.$1=e,this.$2=t,this.$5=n,this.$6=r,this.$4=!1}var t=e.prototype;return t.$7=function(){var e=this;this.$4?(this.$4=!1,this.$5(),this.$3=o("MqttEnv").Env.setTimeout(function(){e.$7()},this.$2()*1e3)):this.$6()},t.reset=function(){var e=this;this.$4=!0,this.$3&&(o("MqttEnv").Env.clearTimeout(this.$3),this.$3=null);var t=this.$1()*1e3;t>0&&(this.$3=o("MqttEnv").Env.setTimeout(function(){e.$7()},t))},t.cancel=function(){this.$3&&(o("MqttEnv").Env.clearTimeout(this.$3),this.$3=null)},e})();l.UTF8Length=m,l.convertStringToUTF8=_,l.concatBuffers=e,l.decodeMultiByteInt=s,l.convertUTF8ToString=f,l.encodeMultiByteInt=u,l.writeUInt16BE=c,l.readUInt16BE=d,l.writeString=p,l.Pinger=g}),98);
__d("MqttUtils",["MqttEnv"],(function(t,n,r,o,a,i,l){"use strict";function e(e,t){return u(e,"sid",t.toString())}function s(e,t){var n=e;return t.forEach(function(e,t){n=u(n,t,e)}),n}function u(e,t,n){return e.indexOf("?")>0?e+"&"+t+"="+n:e+"?"+t+"="+n}function c(){return Math.floor(o("MqttEnv").Env.random()*Number.MAX_SAFE_INTEGER)}function d(e,t,n){var r=arguments.length>1?e.then(t,n):e;r.then(null,function(e){o("MqttEnv").Env.setTimeout(function(){throw e instanceof Error?e:new Error("promiseDone")},0)})}function m(e,t,n,r){var a=!1;o("MqttEnv").Env.setTimeout(function(){a||(a=!0,n(new Error("promise timeout")))},r),d(e,function(e){a||(a=!0,t(e))},function(e){a||(a=!0,n(e))})}function p(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var o=0;return e.replace(/%s/g,function(){return String(n[o++])})}l.endpointWithSessionId=e,l.endpointWithExtraParameters=s,l.endpointWithExtraParameter=u,l.generateSessionId=c,l.promiseDone=d,l.promiseDoneWithTimeout=m,l.sprintf=p}),98);
__d("MqttProtocolCodec",["MqttProtocolUtils","MqttUtils","err"],(function(t,n,r,o,a,i,l){"use strict";var e=Object.freeze({CONNECT:1,CONNACK:2,PUBLISH:3,PUBACK:4,SUBSCRIBE:8,SUBACK:9,UNSUBSCRIBE:10,UNSUBACK:11,PINGREQ:12,PINGRESP:13,DISCONNECT:14}),s=[0,6,77,81,73,115,100,112,3];function u(t,n){var a=n,i=a,l=t[a],s=l>>4;a+=1;var u=o("MqttProtocolUtils").decodeMultiByteInt(t,a);if(u==null)return{position:i,wireMessage:null};a=u.offset;var c=a+u.value;if(c>t.length)return{position:i,wireMessage:null};var d;switch(s){case e.CONNACK:{var p=t[a++],h=!!(p&1),y=t[a++];d=new f(h,y);break}case e.PUBLISH:{var v=l&15,S=v>>1&3,R=o("MqttProtocolUtils").readUInt16BE(t,a);a+=2;var L=o("MqttProtocolUtils").convertUTF8ToString(t,a,R);a+=R;var E=null;S===1&&(E=o("MqttProtocolUtils").readUInt16BE(t,a),a+=2);var k=C.createWithBytes(t.subarray(a,c)),I=(v&1)===1,T=(v&8)===8;d=new b(L,k,S,E,I,T);break}case e.PINGREQ:d=new m("PINGREQ");break;case e.PINGRESP:d=new m("PINGRESP");break;case e.PUBACK:case e.UNSUBACK:{var D=o("MqttProtocolUtils").readUInt16BE(t,a);d=new g(s===e.PUBACK?"PUBACK":"UNSUBACK",D);break}case e.SUBACK:{var x=o("MqttProtocolUtils").readUInt16BE(t,a);a+=2;var $=t.subarray(a,c);d=new _(x,$);break}default:throw r("err")(o("MqttUtils").sprintf("Invalid MQTT message type %s.",s))}return{position:c,wireMessage:d}}function c(e){for(var t=[],n=0;n<e.length;){var r=u(e,n),o=r.wireMessage;if(n=r.position,o)t.push(o);else break}var a=null;return n<e.length&&(a=e.subarray(n)),{messages:t,remaining:a}}var d=(function(){function t(t){this.messageType=e[t]}var n=t.prototype;return n.encode=function(){throw new TypeError("Cannot abstract class WireMessage")},t})(),m=(function(e){function t(t){return e.call(this,t)||this}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.encode=function(){var e=new ArrayBuffer(2),t=new Uint8Array(e);return t[0]=(this.messageType&15)<<4,e},t})(d),p=(function(e){function t(){return e.call(this,"DISCONNECT")||this}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.encode=function(){var e=(this.messageType&15)<<4,t=new ArrayBuffer(2),n=new Uint8Array(t);return n[0]=e,n.set(o("MqttProtocolUtils").encodeMultiByteInt(0),1),t},t})(d),_=(function(e){function t(t,n){var r;return r=e.call(this,"SUBACK")||this,r.messageIdentifier=t,r.returnCode=n,r}return babelHelpers.inheritsLoose(t,e),t})(d),f=(function(e){function t(t,n){var r;return r=e.call(this,"CONNACK")||this,r.sessionPresent=t,r.returnCode=n,r}return babelHelpers.inheritsLoose(t,e),t})(d),g=(function(e){function t(t,n){var r;return r=e.call(this,t)||this,r.messageIdentifier=n,r}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.encode=function(){var e=(this.messageType&15)<<4,t=2,n=o("MqttProtocolUtils").encodeMultiByteInt(t),r=n.length+1,a=new ArrayBuffer(t+r),i=new Uint8Array(a);return i[0]=e,i.set(n,1),r=o("MqttProtocolUtils").writeUInt16BE(this.messageIdentifier,i,r),a},t})(d),h=(function(e){function t(t,n){var r;return r=e.call(this,"CONNECT")||this,r.clientId=t,r.connectOptions=n,r}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.encode=function(){var e,t=(this.messageType&15)<<4,n=s.length+3;n+=(e=o("MqttProtocolUtils")).UTF8Length(this.clientId)+2,n+=e.UTF8Length(this.connectOptions.userName)+2;var r=e.encodeMultiByteInt(n),a=new ArrayBuffer(1+r.length+n),i=new Uint8Array(a);i[0]=t;var l=1;i.set(r,1),l+=r.length,i.set(s,l),l+=s.length;var u=130;return i[l++]=u,l=e.writeUInt16BE(this.connectOptions.getKeepAliveIntervalSeconds(),i,l),l=e.writeString(this.clientId,e.UTF8Length(this.clientId),i,l),l=e.writeString(this.connectOptions.userName,e.UTF8Length(this.connectOptions.userName),i,l),a},t})(d),y=(function(t){function n(e,n,r,a){var i;if(i=t.call(this,e)||this,i.topic=n,r<0&&r>1||r===1&&a==null)throw new TypeError(o("MqttUtils").sprintf("Argument Invalid. qos: %s messageType: %s.",r,e));return i.qos=r,i.messageIdentifier=a,i}babelHelpers.inheritsLoose(n,t);var r=n.prototype;return r.encode=function(){var t=(this.messageType&15)<<4;t|=2;var n=o("MqttProtocolUtils").UTF8Length(this.topic),r=2+n+2;this.messageType===e.SUBSCRIBE&&(r+=1);var a=o("MqttProtocolUtils").encodeMultiByteInt(r),i=new ArrayBuffer(1+a.length+r),l=new Uint8Array(i);l[0]=t;var s=1;return l.set(a,1),s+=a.length,this.messageIdentifier!=null&&(s=o("MqttProtocolUtils").writeUInt16BE(this.messageIdentifier,l,s)),s=o("MqttProtocolUtils").writeString(this.topic,n,l,s),this.messageType===e.SUBSCRIBE&&this.qos!=null&&(l[s++]=this.qos),i},n})(d),C=(function(){function e(e,t){this.payloadString=e,this.payloadBytes=t}e.createWithString=function(n){var t=new Uint8Array(new ArrayBuffer(o("MqttProtocolUtils").UTF8Length(n)));return o("MqttProtocolUtils").convertStringToUTF8(n,t,0),new e(n,t)},e.createWithBytes=function(n){var t=o("MqttProtocolUtils").convertUTF8ToString(n,0,n.length);return new e(t,n)};var t=e.prototype;return t.string=function(){return this.payloadString},t.bytes=function(){return this.payloadBytes},e})(),b=(function(e){function t(t,n,r,o,a,i){var l;if(l=e.call(this,"PUBLISH")||this,l.topic=t,l.payloadMessage=n,l.qos=r,l.messageIdentifier=o,l.retained=a!=null?a:!1,l.duplicate=i!=null?i:!1,l.qos===1&&l.messageIdentifier==null)throw new TypeError("Argument Invalid. messageIdentifier: null and qos: 1");return l}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.encode=function(){var e=(this.messageType&15)<<4;this.duplicate&&(e|=8),e=e|=this.qos<<1,this.retained&&e!=1;var t=o("MqttProtocolUtils").UTF8Length(this.topic),n=t+2,r=this.qos===0?0:2;n+=r;var a=this.payloadMessage.bytes();n+=a.byteLength;var i=o("MqttProtocolUtils").encodeMultiByteInt(n),l=new ArrayBuffer(1+i.length+n),s=new Uint8Array(l);s[0]=e,s.set(i,1);var u=1+i.length;return u=o("MqttProtocolUtils").writeString(this.topic,t,s,u),this.qos!==0&&this.messageIdentifier!=null&&(u=o("MqttProtocolUtils").writeUInt16BE(this.messageIdentifier,s,u)),s.set(a,u),l},t})(d),v=C.createWithString,S=C.createWithBytes,R={Base:d,ConnAck:f,Connect:h,Disconnect:p,Ping:m,PubAckUnsubAck:g,Publish:b,Subscription:y};l.MESSAGE_TYPE=e,l.decodeMessage=u,l.decodeByteMessages=c,l.Message=C,l.createMessageWithString=v,l.createMessageWithBytes=S,l.WireMessage=R}),98);
__d("MqttTypes",[],(function(t,n,r,o,a,i){"use strict";var e=function(t,n,r){this.errorCode=t,this.errorName=n,this.errorMessage=r},l=Object.freeze({APP_DISCONNECT:new e(7,"APP_DISCONNECT","Disconnect initiated by app"),BROWSER_CLOSE:new e(11,"BROWSER_CLOSE","Browser closed"),CONNACK_FAILURE:new e(5,"CONNACK_FAILURE","Connection failure due to connack"),CONNECT_TIMEOUT:new e(4,"CONNECT_TIMEOUT","Connect timed out"),INVALID_DATA_TYPE:new e(3,"INVALID_DATA_TYPE","Received non-arraybuffer from socket."),PING_TIMEOUT:new e(6,"PING_TIMEOUT","Ping timeout"),RECONNECT:new e(10,"RECONNECT","Reconnecting"),SERVER_DISCONNECT:new e(8,"SERVER_DISCONNECT","Disconnect message sent my server"),SOCKET_CLOSE:new e(9,"SOCKET_CLOSE","Socket connection closed"),SOCKET_ERROR:new e(1,"SOCKET_ERROR","Socket error"),SOCKET_MESSAGE:new e(2,"SOCKET_MESSAGE","Unable to parse invalid socket message")}),s=function(t,n){this.mqttError=t,this.connAck=n},u=(function(e){function t(t,n,r){var o;return r===void 0&&(r=null),o=e.call(this,n)||this,o.isRecoverable=t,o.originalError=r,o}return babelHelpers.inheritsLoose(t,e),t})(babelHelpers.wrapNativeSuper(Error));i.MqttError=e,i.MqttErrors=l,i.ConnectFailure=s,i.MqttChannelError=u}),66);
__d("MqttProtocolClient",["ErrorSerializer","MqttEnv","MqttProtocolCodec","MqttProtocolUtils","MqttTypes","err","getErrorSafe"],(function(t,n,r,o,a,i,l){"use strict";var e=20,s=6e4,u=(function(){function t(e){var t=this;this.$12=function(e,n,r){n===void 0&&(n=null),t.$9.bumpCounter("protocol.debug.disconnect.internal."+e.errorName),t.$9.bumpCounter("protocol.debug.disconnect.internal");var a=t.$5,i=t.$2,l=i.onConnectFailure,s=i.onConnectionLost;t.setConnected(!1),t.$14(),a?o("MqttEnv").Env.scheduleCallback(function(){s(e,n)}):o("MqttEnv").Env.scheduleCallback(function(){l(t.$11,new(o("MqttTypes")).ConnectFailure(e,r!=null?r:-1),n)})},this.$13=function(e){var n=t.$6;if(n==null)return t.$9.bumpCounter("protocol.socket_send.failed.socket_null.<message type>"),0;if(n.readyState!==n.OPEN)return t.$9.bumpCounter("protocol.socket_send.failed.socket_not_open.<message type>"),0;var r=e.encode(),o=r.byteLength;return n.send(r),o},this.$3=e,this.$2={getKeepAliveIntervalSeconds:function(){return 10},getKeepAliveTimeoutSeconds:function(){return 10},ignoreSubProtocol:!1,mqttVersion:3,onConnectFailure:function(t,n,r){},onConnection:function(){},onConnectionLost:function(t,n){},onConnectSuccess:function(t){},onMessageArrived:function(t,n,r){},onMessageDelivered:function(t){},userName:""},this.$1="mqttwsclient",this.$4=0,this.$5=!1,this.$9=o("MqttEnv").Env.getLoggerInstance(),this.$11=0}var n=t.prototype;return n.connect=function(n){var t=this;if(this.$5)throw r("err")("Invalid state: connect - already connected");this.$2=n,this.setConnected(!1),this.$7!=null&&(o("MqttEnv").Env.clearTimeout(this.$7),this.$7=null),this.$7=o("MqttEnv").Env.setTimeout(function(){t.$9.bumpCounter("protocol.error.connect.timeout"),t.$12(o("MqttTypes").MqttErrors.CONNECT_TIMEOUT)},e*1e3),this.$6=o("MqttEnv").Env.createSocket(this.$3),this.$6.binaryType="arraybuffer",this.$6.onopen=function(){t.setConnected(!0),t.$9.debugTrace("Socket-Open","MQTTProtocolClient Socket Open"),t.$11=t.$13(new(o("MqttProtocolCodec")).WireMessage.Connect(t.$1,n)),n.onConnection()},this.$6.onmessage=function(e){var n=e.data;if(!(n instanceof ArrayBuffer)){t.$9.bumpCounter("protocol.error.onmessage.type"),t.$12(o("MqttTypes").MqttErrors.INVALID_DATA_TYPE);return}try{var a=new Uint8Array(n);t.$10!=null&&(a=o("MqttProtocolUtils").concatBuffers(t.$10,a),t.$9.bumpCounter("protocol.debug.usingMessagesBuffer"),delete t.$10,t.$10=null);var i=o("MqttProtocolCodec").decodeByteMessages(a),l=i.messages;t.$10=i.remaining;for(var s=0;s<l.length;s++)t.handleMessage(l[s])}catch(e){var u=r("getErrorSafe")(e);t.$10=null,t.$9.logError(u,o("MqttTypes").MqttErrors.SOCKET_MESSAGE.errorMessage),t.$9.bumpCounter("protocol.error.onmessage.parse"),t.$12(o("MqttTypes").MqttErrors.SOCKET_MESSAGE,u.message)}},this.$6.onerror=function(e){t.$9.bumpCounter("protocol.error.socket"),t.$9.debugTrace("Socket-Error","MQTTProtocolClient Socket Error");var n=typeof e=="object"&&e!=null&&"error"in e&&!("message"in e)?e.error:e;t.$12(o("MqttTypes").MqttErrors.SOCKET_ERROR,r("ErrorSerializer").toReadableMessage(r("getErrorSafe")(n)))},this.$6.onclose=function(e){t.$9.bumpCounter("protocol.socket.close"),e.wasClean||t.$9.debugTrace("Socket-Unclean-Close","MQTTProtocolClient error code: "+e.code+" reason: "+e.reason),t.$12(o("MqttTypes").MqttErrors.SOCKET_CLOSE,e.code+" : "+e.reason)},this.$8!=null&&this.$8.cancel(),this.$8=new(o("MqttProtocolUtils")).Pinger(n.getKeepAliveIntervalSeconds,n.getKeepAliveTimeoutSeconds,this.$13.bind(this,new(o("MqttProtocolCodec")).WireMessage.Ping("PINGREQ")),function(e,n){return t.$12(o("MqttTypes").MqttErrors.PING_TIMEOUT,e,n)})},n.$14=function(){var e=this;this.setConnected(!1),this.$8!=null&&this.$8.cancel(),this.$7!=null&&(o("MqttEnv").Env.clearTimeout(this.$7),this.$7=null),this.$6!=null&&(this.$6.onopen=function(t){e.$9.debugTrace("Socket Open After Teardown","Socket opening after teardown")},this.$6.onmessage=function(e){},this.$6.onerror=function(e){},this.$6.onclose=function(t){e.$9.debugTrace("Socket Close After Teardown","code: "+t.code+", reason: "+t.reason)},this.$6.close(),this.$6=null),this.$2.onConnectSuccess=function(e){},this.$2.onConnectFailure=function(e,t){},this.$2.onConnection=function(){},this.$2.onConnectionLost=function(e){},this.$2.onMessageArrived=function(e,t,n){},this.$2.onMessageDelivered=function(e){}},n.disconnect=function(t){if(this.$6==null||this.$6.readyState!==this.$6.OPEN||!this.$5){this.$14();return}this.$13(new(o("MqttProtocolCodec")).WireMessage.Disconnect),this.$9.bumpCounter("protocol.debug.disconnect"),this.$12(t)},n.isConnected=function(){return this.$5},n.setConnected=function(t){this.$5=t},n.subscribe=function(t){if(!this.$5)throw this.$9.bumpCounter("protocol.error.subscribe.notconnected"),r("err")("Invalid state: subscribe - not connected");this.$9.bumpCounter("protocol.subscribe."+t);var e=new(o("MqttProtocolCodec")).WireMessage.Subscription("SUBSCRIBE",t,0,this.$15());this.$13(e)},n.unsubscribe=function(t){if(!this.$5)throw this.$9.bumpCounter("protocol.error.unsubscribe.notconnected"),r("err")("Invalid state: unsubscribe - not connected");this.$9.bumpCounter("protocol.unsubscribe."+t);var e=new(o("MqttProtocolCodec")).WireMessage.Subscription("UNSUBSCRIBE",t,0,this.$15());this.$13(e)},n.publish=function(t,n,r){return this.$16(t,o("MqttProtocolCodec").createMessageWithString(n),r)},n.publishBinary=function(t,n,r){return this.$16(t,o("MqttProtocolCodec").createMessageWithBytes(n),r)},n.$16=function(t,n,r){this.$5||this.$9.bumpCounter("protocol.error.publish.notconnected"),this.$9.bumpCounter("protocol.publish."+t);var e=this.$15(),a=new(o("MqttProtocolCodec")).WireMessage.Publish(t,n,r,e);return this.$13(a),e},n.$15=function(){return++this.$4===s&&(this.$4=1),this.$4},n.handleMessage=function(t){var e=this;switch(t.messageType){case o("MqttProtocolCodec").MESSAGE_TYPE.CONNACK:if(this.$7!=null&&(o("MqttEnv").Env.clearTimeout(this.$7),this.$7=null),t instanceof o("MqttProtocolCodec").WireMessage.ConnAck){var n=t;if(n.returnCode!==0){this.$9.bumpCounter("protocol.error.connack.invalidreturncode"),this.setConnected(!1),this.$12(o("MqttTypes").MqttErrors.CONNACK_FAILURE,"connack code="+n.returnCode,n.returnCode);return}o("MqttEnv").Env.scheduleCallback(function(){e.$2.onConnectSuccess(e.$11)}),this.$8!=null&&this.$8.reset()}break;case o("MqttProtocolCodec").MESSAGE_TYPE.PUBLISH:if(t instanceof o("MqttProtocolCodec").WireMessage.Publish){var a=t;o("MqttEnv").Env.scheduleCallback(function(){e.$2.onMessageArrived(a.topic,a.payloadMessage,a.qos)});var i=a.messageIdentifier;if(this.$9.bumpCounter("protocol.publish.received"),a.qos===1&&i!=null){var l=new(o("MqttProtocolCodec")).WireMessage.PubAckUnsubAck("PUBACK",i);this.$13(l)}}break;case o("MqttProtocolCodec").MESSAGE_TYPE.PUBACK:if(t instanceof o("MqttProtocolCodec").WireMessage.PubAckUnsubAck){var s=t,u=s.messageIdentifier;this.$9.bumpCounter("protocol.puback.received"),o("MqttEnv").Env.scheduleCallback(function(){e.$2.onMessageDelivered(u)})}break;case o("MqttProtocolCodec").MESSAGE_TYPE.PINGRESP:this.$8!=null&&this.$8.reset();break;case o("MqttProtocolCodec").MESSAGE_TYPE.DISCONNECT:this.$12(o("MqttTypes").MqttErrors.SERVER_DISCONNECT);break;case o("MqttProtocolCodec").MESSAGE_TYPE.SUBACK:this.$9.bumpCounter("protocol.suback.received");break;case o("MqttProtocolCodec").MESSAGE_TYPE.UNSUBACK:this.$9.bumpCounter("protocol.unsuback.received");break;default:this.$9.logError(r("err")("MqttProtocolClient: Received unhandled message type: "+t.messageType),"Received unhandled message type"),this.$9.bumpCounter("protocol.error.handlemessage.unsupportedtype");break}},t})();l.default=u}),98);
__d("MqttPublishListener",[],(function(t,n,r,o,a,i){"use strict";var e=Object.freeze({NOT_CONNECTED:"NOT_CONNECTED",PUBLISH_ERROR:"PUBLISH_ERROR",QUEUED:"QUEUED",SENT:"SENT",ACKED:"ACKED",NOT_ACKED:"NOT_ACKED"});i.MqttPublishEvent=e}),66);
__d("MqttUserNameUtils",[],(function(t,n,r,o,a,i){"use strict";function e(e){return e!=null?e:typeof document=="object"&&document&&document.hasFocus&&document.hasFocus()}function l(){return navigator.userAgent}i.getMqttForegroundStatus=e,i.getUserAgent=l}),66);
__d("MqttUserName",["MqttUserNameUtils"],(function(t,n,r,o,a,i,l){"use strict";var e=(function(){function e(e,t,n,r,a,i,l,s,u,c,d,m){l===void 0&&(l=null),s===void 0&&(s=""),u===void 0&&(u="websocket"),c===void 0&&(c=null),d===void 0&&(d=null),m===void 0&&(m=null),this.$1=e,this.$2=t,this.$3=n,this.$4=r,this.$5=a,this.$6=i,this.$7=o("MqttUserNameUtils").getMqttForegroundStatus(),this.$8=l,this.$9=s,this.$10=u,this.$11=c,this.$12=d,this.$13=m}var t=e.prototype;return t.gen=function(t,n,r,a){a===void 0&&(a=[]);var e=o("MqttUserNameUtils").getMqttForegroundStatus(this.$7),i=r.map(function(e){var t={isBase64Publish:!1,messageId:e.messageId,payload:e.payload,qos:e.qos,topic:e.topic};return typeof t.payload!="string"&&(t.payload=btoa(String.fromCharCode.apply(null,t.payload)),t.isBase64Publish=!0),t}),l={a:o("MqttUserNameUtils").getUserAgent(),asi:this.$13,aid:this.$5,aids:this.$12!=null?Object.fromEntries(this.$12):null,chat_on:this.$6,cp:this.$3,ct:this.$10,d:this.$4,dc:"",ecp:this.$2,fg:e,gas:this.$8,mqtt_sid:"",no_auto_fg:!0,p:this.$11,pack:a,php_override:this.$9,pm:i,s:t,st:n,u:this.$1};return JSON.stringify(l)},t.setForegroundState=function(t){this.$7=t},t.setChatVisibility=function(t){this.$6=t},t.getEndpointCapabilities=function(){return this.$2},t.getDeviceId=function(){return this.$4},t.setEndpointCapabilities=function(t){this.$2=t},t.getIsGuestAuthStringPresent=function(){return this.$8!==null},e})();l.default=e}),98);
__d("MqttConnection",["MqttConnectionHookCollection","MqttEnv","MqttProtocolClient","MqttPublishListener","MqttTypes","MqttUserName","MqttUtils","Promise","err","getErrorSafe"],(function(t,n,r,o,a,i,l){"use strict";var e,s=15,u=15,c=1,d=1,m=64,p="publish",_="subscribe",f="unsubscribe",g=function(t){},h=18e4,y=5*1e3,C=15,b=21,v=(function(){function t(){var e=this;this.$38=function(){return e.$20},this.$39=function(){return e.$21},this.$8=!1,this.$10=o("MqttEnv").Env.getLoggerInstance(),this.$11="Disconnected",this.$17=new Set,this.$24=new Map,this.$12=0,this.$13=0,this.$14=0,this.$15=0,this.$16=0,this.$8=!1,this.$5="",this.$6=new(r("MqttUserName"))("",0,1,"",0,!0),this.$9=0,this.$18=0,this.$19=!1,this.$7=null;var t=function(){};this.$1=t,this.$2=t,this.$3=t,this.$25=!1,this.$26=!1,this.$27=new(r("MqttConnectionHookCollection")),this.$4=function(){return[]},this.$20=s,this.$21=u,this.$22=null,this.$23=0}var a=t.prototype;return a.run=function(t){var e=this,n=t.endpoint,r=t.extraConnectMessageProvider,o=t.mqttUserName,a=t.onJSError,i=t.onMessageReceived,l=t.onStateChange,c=t.subscribedTopics;if(this.$8){this.$10.debugTrace("run","Run called while in running state.");return}this.$1=l,this.$3=i,this.$5=n,this.$6=o,this.$8=!0,this.$18=Date.now(),this.$12=0,this.$13=0,this.$2=a||g,c&&c.forEach(function(t){return e.$17.add(t)}),this.$4=r,this.$20=s,this.$21=u,this.$28()},a.shutdown=function(t){this.$29(t),this.$30("shutdown"),this.$8=!1,this.$10.debugTrace("shutdown","Shutdown")},a.subscribe=function(t){return this.$17.add(t),this.ensureConnected(_)&&this.$31(t),!0},a.publish=function(t,n,r,o){return this.$32(t,n,r,o)},a.publishBinary=function(t,n,r,o){return this.$32(t,n,r,o)},a.$32=function(a,i,l,s){var t={reject:function(t){},resolve:function(){}};s!=null&&(t.listener=s);var u=new(e||(e=n("Promise")))(function(e,n){t.resolve=e,t.reject=n}),c=this.ensureConnected(p);return c?this.$33(a,i,l,t):(s==null||s.onEvent(o("MqttPublishListener").MqttPublishEvent.NOT_CONNECTED),t.reject(r("err")("Client disconnected"))),u},a.unsubscribe=function(t){return this.$17.delete(t),this.ensureConnected(f)&&this.$34(t),!0},a.addHook=function(t){this.$27.addHook(t)},a.removeHook=function(t){this.$27.removeHook(t)},a.isRunning=function(){return this.$8},a.getSessionId=function(){return this.$9},a.hasFatal=function(){return this.$25},a.hasConnectSuccess=function(){return this.$26},a.canPublish=function(){return this.ensureConnected("canPublish")},a.ensureConnected=function(t){return!(!this.$8||this.$7==null||!this.$7.isConnected())},a.connectionState=function(){return this.$11},a.mqttStateFromConnectionState=function(t){switch(t){case"Connecting":case"TransportConnected":return"Connecting";case"Connected":return"Connected";case"Disconnected":return"Disconnected"}throw r("err")("Unknown state "+t)},a.testOnlyGetSubscribedTopics=function(){return this.$17},a.getDisconnectCount=function(){return this.$23},a.$29=function(t){this.$8&&this.$7!=null&&(this.$35("Disconnected"),this.$7!=null&&(this.$7.disconnect(t),this.$27.onConnectionDisconnect()),this.$7=null)},a.$36=function(t){if(this.$11==="Connected"&&t==="Disconnected"&&this.$18===0){this.$18=Date.now();return}if(t==="Connecting"&&this.$18!==0&&!this.$19){this.$10.bumpCounter("protocol.reconnectstarted"),this.$19=!0;return}if(t==="Connected"&&this.$18!==0){var e=Date.now()-this.$18;switch(Math.floor(e/3e4)){case 0:this.$10.bumpCounter("protocol.reconnectedwithin30s");break;case 1:this.$10.bumpCounter("protocol.reconnectedwithin60s");break;case 2:this.$10.bumpCounter("protocol.reconnectedwithin90s");break;case 3:this.$10.bumpCounter("protocol.reconnectedwithin120s");break;default:this.$10.bumpCounter("protocol.reconnectedmorethan120s");break}this.$18=0,this.$19=!1;return}},a.$35=function(t){t!==this.$11&&(this.$10.debugTrace("MQTTConnection-updateState","State changed to: "+t),this.$36(t),this.$11=t,this.$1(t))},a.$28=function(){var e=this;if(this.$8){this.$11!=="Disconnected"&&this.$10.debugTrace("Reconnect","Current State not disconnected: "+this.$11),this.$35("Connecting");var t=Date.now(),n=this.$10.getBrowserConnectivity();this.$9=o("MqttUtils").generateSessionId();var a=Array.from(this.$17),i=o("MqttUtils").endpointWithSessionId(this.$5,this.$9),l=o("MqttUtils").endpointWithExtraParameter(i,"cid",this.$6.getDeviceId());try{this.$7=new(r("MqttProtocolClient"))(l);var s=this.$37(),u=s.map(function(e){return e.topic}),c=this.$6.gen(this.$9,a,s);this.$7!=null&&(this.$13+=1,this.$7.connect({getKeepAliveIntervalSeconds:this.$38,getKeepAliveTimeoutSeconds:this.$39,ignoreSubProtocol:!0,mqttVersion:3,onConnectFailure:function(o,i,l){return e.$40(i,t,e.$18,a,u,n,o,l)},onConnection:function(){return e.$41(s,a)},onConnectionLost:function(n,r){return e.$42(n,r)},onConnectSuccess:function(o){return e.$43(t,e.$18,a,u,n,o)},onMessageArrived:function(n,r,o){return e.$44(n,r,o)},onMessageDelivered:function(n){return e.$45(n)},userName:c}),this.$10.bumpCounter("protocol.connectattempt"),this.$6.getIsGuestAuthStringPresent()&&this.$10.bumpCounter("guestAuthentication.connectattempt"),this.$27.onConnectAttempt())}catch(e){var d=r("getErrorSafe")(e);this.$10.bumpCounter("js_error_in_init_exception"),this.$35("Disconnected"),this.$46(!1,!1,t,this.$18,a,[],n,null,14,"init error - "+d.message),e!=null&&this.$10.logErrorWarn(d,"ws_js_error"),this.$27.onWSFatal(),this.$47(new(o("MqttTypes")).MqttChannelError(!1,"ws_js_error",d),"client_init")}}},a.$37=function(){var e=this.$4(),t=65536;return e.map(function(e){return e.messageId=t--,e})},a.$31=function(t){try{if(this.$7!=null)return this.$7.subscribe(t),this.$10.debugTrace("#doSubscribe","Subscribing to "+t),this.$27.onSubscribe(t),this.$10.bumpCounter("protocol.subscribe"),!0}catch(n){var e=r("getErrorSafe")(n);this.$10.logError(e,"Exception subscribing"),this.$10.bumpCounter("subscribe_exception."+t),this.$10.bumpCounter("protocol.subscribe.error")}return!1},a.$34=function(t){try{if(this.$7!=null)return this.$7.unsubscribe(t),this.$10.debugTrace("#doUnsubscribe","Unsubscribing to "+t),this.$27.onUnsubscribe(t),this.$10.bumpCounter("protocol.unsubscribe"),!0}catch(n){var e=r("getErrorSafe")(n);this.$10.logError(e,"Exception unsubscribing"),this.$10.bumpCounter("unsubscribe_exception."+t),this.$10.bumpCounter("protocol.unsubscribe.error")}return!1},a.$33=function(t,n,a,i){if(this.$7!=null)try{var e,l;typeof n=="string"?l=this.$7.publish(t,n,a):l=this.$7.publishBinary(t,n,a),this.$10.bumpCounter("protocol.publish");var s=l!=null?l:"null";return this.$10.debugTrace("#doPublish","publish "+t+" with messageId:"+s+" qos:"+a),this.$27.onPublish(t),(e=i.listener)==null||e.onEvent(o("MqttPublishListener").MqttPublishEvent.SENT),l!=null?(this.$10.bumpCounter("publish.ack_expected"),this.$24.set(l,i)):i.resolve(),!0}catch(e){var u=r("getErrorSafe")(e);return this.$10.logError(u,"Exception publishing"),this.$10.bumpCounter("publish_exception."+t),i.reject(u),this.$10.bumpCounter("protocol.publish.error"),!1}else return!1},a.$48=function(t){var e=this;if(t===void 0&&(t=null),!!this.$8){this.$29(o("MqttTypes").MqttErrors.RECONNECT),this.$30("reconnect"),this.$49(),this.$9=-1,this.$16=0;var n=t;n==null&&(n=c*Math.pow(2,this.$12)),n=Math.max(n,d),n=Math.min(n,m);var r=n*(1e3+o("MqttEnv").Env.random()*200);this.$10.debugTrace("#scheduleReconnect","Reconnect in "+r+" ms"),this.$22=o("MqttEnv").Env.setTimeout(function(){e.$28()},r),this.$12+=1}},a.$49=function(){var e=Date.now()-this.$16,t=this.$16!==0&&e>y,n=this.$12>C;(t||n)&&(this.$12=0),this.$16!==0&&e<=y&&this.$10.bumpCounter("short_lived_session"),n&&this.$10.bumpCounter("connection_attempt_limit")},a.$46=function(t,n,r,o,a,i,l,s,u,c){t?this.$14++:this.$15++;var e=Date.now();this.$10.eventLogConnect({ackReceived:n,attemptNumber:this.$13,connectionState:this.mqttStateFromConnectionState(this.$11),connectionStatus:t,disconnectCount:this.$23,duration:e-r,errorCode:u,errorMessage:c,failTotal:this.$15,hostname:this.$5,messageSizeBytes:s,osConnectivity:l,publishes:i,sessionID:this.$9,subscribedTopics:a,successTotal:this.$14,total_duration:e-o}),t&&(this.$13=0)},a.$40=function(t,n,r,o,a,i,l,s){var e=t.mqttError,u=s!=null?e.errorMessage+" - "+s:e.errorMessage;if(this.$10.debugTrace("connect","Connect failed "+u),this.$10.bumpCounter("protocol.onconnectfailure"),this.$6.getIsGuestAuthStringPresent()&&this.$10.bumpCounter("guestAuthentication.onconnectfailure"),this.$27.onConnectFailure(),this.$46(!1,t.connAck!==-1,n,r,o,a,i,l,e.errorCode,u),t.connAck!=null&&(this.$10.bumpCounter("protocol.connect_failure."+t.connAck),t.connAck===b)){this.$48(h);return}this.$48()},a.$41=function(t,n){var e=this;this.$10.bumpCounter("protocol.onconnection"),this.$10.debugTrace("Connect","Socket established"),this.$27.onConnected(),this.$6.getIsGuestAuthStringPresent()&&this.$10.bumpCounter("guestAuthentication.onconnection"),n.forEach(function(t){e.$27.onSubscribe(t)}),t.forEach(function(t){e.$27.onPublish(t.topic)}),this.$35("TransportConnected")},a.$43=function(t,n,r,o,a,i){this.$10.bumpCounter("protocol.onconnectsuccess"),this.$10.debugTrace("connect","Connect success"),this.$6.getIsGuestAuthStringPresent()&&this.$10.bumpCounter("guestAuthentication.onconnectsucess"),this.$27.onConnectSuccess(),this.$26=!0,this.$35("Connected"),this.$46(!0,!0,t,n,r,o,a,i),this.$50(r),this.$16=Date.now()},a.$42=function(t,n){if(this.$10.bumpCounter("protocol.onconnectionlost"),this.$23++,t.errorCode){var e=n!=null?t.errorMessage+" - "+n:t.errorMessage;this.$10.eventLogDisconnect({disconnectCount:this.$23,duration:Date.now()-this.$16,errorCode:t.errorCode,errorMessage:e,sessionID:this.$9})}this.$10.debugTrace("connect","connection lost"),this.$27.onConnectionLost(),this.$6.getIsGuestAuthStringPresent()&&this.$10.bumpCounter("guestAuthentication.onconnectionlost"),this.$48()},a.$44=function(t,n,o){this.$10.bumpCounter("protocol.onmessagearrived"),this.$6.getIsGuestAuthStringPresent()&&this.$10.bumpCounter("guestAuthentication.onmessagearrived"),this.$10.debugTrace("onMessageArrived","Message received on "+t),this.$27.onMessage(t);try{this.$3(t,n,o)}catch(n){var e=r("getErrorSafe")(n);this.$10.logError(e,"Listener threw error"),this.$10.bumpCounter("listener_error."+t)}},a.$45=function(t){var e;this.$10.bumpCounter("protocol.onmessagedelivered");var n=t!=null?t:"null";if(this.$10.debugTrace("onMessageDelivered","Delivered Message {ID: "+n+"}"),t!=null){var r=this.$24.get(t);if(r==null){this.$10.bumpCounter("protocol.message_with_unknown_id");return}this.$24.delete(t),(e=r.listener)==null||e.onEvent(o("MqttPublishListener").MqttPublishEvent.ACKED),r.resolve(),this.$10.bumpCounter("publish.ack_received")}},a.$30=function(t){this.$10.bumpCounter("protocol.fail_all_unacked_publishes."+t),this.$24.forEach(function(e,n,a){var i;(i=e.listener)==null||i.onEvent(o("MqttPublishListener").MqttPublishEvent.NOT_ACKED),e.reject(r("err")(t))}),this.$24.clear()},a.$50=function(t){var e=this,n=new Set(t);n.forEach(function(t){e.$17.has(t)||e.unsubscribe(t)});var r=new Set(this.$17);r.forEach(function(t){n.has(t)||e.subscribe(t)})},a.$47=function(t,n){try{this.$10.bumpCounter("js_error_in_init"),this.$10.bumpCounter(n+".error"),this.$25=!0;var e=t?t.message:"error";this.$10.debugTrace("onError",n+": "+e),this.$2(t)}catch(e){var o=r("getErrorSafe")(e);this.$10.bumpCounter("js_error_in_error_logging"),this.$10.logError(o,"JS error while trying to log previous error")}},a.setRunning_OnlyForTests=function(t){this.$8=t},t})();l.default=v}),98);
__d("MqttWebSocketUtils",[],(function(t,n,r,o,a,i){"use strict";function e(){return"WebSocket"in t&&t.WebSocket!=null&&"CLOSING"in t.WebSocket.prototype}i.hasWSSupport=e}),66);
__d("isFastRefreshEnabledForCurrentDomain",[],(function(t,n,r,o,a,i){"use strict";function e(){return!1}i.default=e}),66);
__d("MqttChannel",["ChannelClientID","IrisSubscribeChecker","MetaConfig","MqttAnalyticsHook","MqttConnection","MqttEnv","MqttPublishListener","MqttTypes","MqttUserName","MqttUtils","MqttWebSocketUtils","Promise","Run","err","getErrorSafe","isFastRefreshEnabledForCurrentDomain","promiseDone","requireDeferred"],(function(t,n,r,o,a,i,l){"use strict";var e,s=29125,u=(function(){function t(e){var t=this,n=e.endpoint,a=e.pollingEndpoint,i=e.userFbid,l=e.appId,s=e.initialSubscribedTopics,u=e.capabilities,c=e.clientCapabilities,d=e.chatVisibility,m=d===void 0?!0:d,p=e.guestAuthString,_=p===void 0?null:p,f=e.phpOverride,g=f===void 0?"":f,h=e.clientType,y=h===void 0?"websocket":h,C=e.deviceId,b=C===void 0?r("ChannelClientID").getID():C,v=e.pageId,S=v===void 0?null:v,R=e.assetIds,L=R===void 0?null:R,E=e.appSpecificInfo,k=E===void 0?null:E;if(this.$11=o("MqttEnv").Env.getLoggerInstance(),this.$11.setAppId(l),this.$12=new(r("MqttUserName"))(i,u,c,b,l,m,_,g,y,S,L,k),this.$1=n,this.$2=a,this.$5="Disconnected",this.$7="LPInactive",this.$6="Disconnected",this.$3=[],this.$4=new Set,this.$8=new Map,this.$9=new Map,this.$10=new(r("MqttConnection")),this.$13=null,this.$16=new(r("MqttAnalyticsHook")),this.$15=new Map,this.$14=[],!o("MqttEnv").Env.isUserLoggedInNow()&&!r("isFastRefreshEnabledForCurrentDomain")()&&(_==null||_=="")){this.$11.bumpCounter("logged_out_init");return}this.$10.addHook(this.$16),this.$10.addHook(new(r("IrisSubscribeChecker"))(function(){return t.$4.size>0})),this.$17(s),this.$18()}var a=t.prototype;return a.$17=function(t){var e=this;if(this.$10.isRunning()){this.$19("run","Connection started calling run again");return}if(o("MqttEnv").Env.genGk(o("MqttEnv").MqttGkNames.mqtt_ws_polling_enabled)){if(r("MetaConfig")._("15")){this.$19("MqttChannel","Websocket disabled, will do long polling only");return}else if(!o("MqttWebSocketUtils").hasWSSupport()){this.$19("MqttChannel","Websocket Unavailable, will do long polling only"),this.$11.bumpCounter("ws_unavailable_polling");return}}this.$10.run({endpoint:this.$1,extraConnectMessageProvider:function(){return e.$20()},mqttUserName:this.$12,onJSError:function(n){e.$21(n)},onMessageReceived:function(n,r,o){e.$22(n,r,o)},onStateChange:function(n){e.$23(n)},subscribedTopics:t}),this.$24()},a.$24=function(){var e=this,t=o("Run").onUnload(function(){e.$25(o("MqttTypes").MqttErrors.BROWSER_CLOSE)})},a.shutdown=function(){this.$25(o("MqttTypes").MqttErrors.APP_DISCONNECT)},a.$25=function(t){this.$10&&this.$10.shutdown(t),this.$13&&this.$13.shutdown(),this.$16.onTabClose()},a.publish=function(t,n,r){return r===void 0&&(r={qos:1,skipBuffer:!1}),this.$26(t,n,r)},a.publishBinary=function(t,n,r){return r===void 0&&(r={qos:1,skipBuffer:!1}),this.$26(t,n,r)},a.$26=function(t,n,r){r===void 0&&(r={qos:1,skipBuffer:!1});var e;return r.qos===0?e=this.$27(t,n,r.listener):e=this.$28(t,n,r),o("MqttUtils").promiseDone(e,function(){},function(e){var t;(t=r.listener)==null||t.onEvent(o("MqttPublishListener").MqttPublishEvent.PUBLISH_ERROR)}),e},a.$27=function(t,n,r){return this.$29(t,n,0,r,1,null)},a.$28=function(r,a,i){var t={reject:function(t){},resolve:function(){}},l=new(e||(e=n("Promise")))(function(e,n){t.resolve=e,t.reject=n}),s=o("MqttEnv").Env.random(),u={ack:t,attempt:0,options:i,payload:a,publishToken:s,startTime:Date.now(),timeoutId:null,topic:r};if(i.skipBuffer)if(this.$10.connectionState()==="Connecting"){var c;this.$14.push(u),(c=i.listener)==null||c.onEvent(o("MqttPublishListener").MqttPublishEvent.QUEUED)}else this.$30(u);else{var d;u.timeoutId=this.$31(s),this.$15.set(s,u),(d=i.listener)==null||d.onEvent(o("MqttPublishListener").MqttPublishEvent.QUEUED),this.$32(u)}return l},a.$30=function(t){t.attempt+=1,o("MqttUtils").promiseDone(this.$29(t.topic,t.payload,t.options.qos,t.options.listener,t.attempt,t.startTime),function(){t.ack.resolve()},function(e){t.ack.reject(e)})},a.$32=function(t){var e=this;t.attempt+=1,o("MqttUtils").promiseDone(this.$29(t.topic,t.payload,t.options.qos,t.options.listener,t.attempt,t.startTime),function(){return e.$33(t)},function(e){})},a.$29=function(t,n,a,i,l,s){var e=this,u,c,d=this.getConnectionState(),m=Date.now();return!this.$10.canPublish()&&this.$13&&this.$13.canPublish()?(typeof n=="string"?u=this.$13.publish(t,n,a):u=this.$13.publishBinary(t,n,a),c="lp",i!=null&&(u=u.then(function(){return i.onEvent(o("MqttPublishListener").MqttPublishEvent.SENT)})),this.$11.bumpCounter("try_publish_lp")):(typeof n=="string"?u=this.$10.publish(t,n,a,i):u=this.$10.publishBinary(t,n,a,i),c="ws",this.$11.bumpCounter("try_publish_ws")),r("promiseDone")(u,function(){e.$11.eventLogOutgoingPublish({attempt:l,connectionState:d,disconnectCount:e.$10.getDisconnectCount(),errorMessage:null,firstAttemptStartTime:s,payloadSizeBytes:n.length*2,protocol:c,qos:a,sessionID:e.$10.getSessionId(),success:!0,thisAttemptStartTime:m,topic:t})},function(r){e.$11.eventLogOutgoingPublish({attempt:l,connectionState:d,disconnectCount:e.$10.getDisconnectCount(),errorMessage:r!=null?r.toString():null,firstAttemptStartTime:s,payloadSizeBytes:n.length*2,protocol:c,qos:a,sessionID:e.$10.getSessionId(),success:!1,thisAttemptStartTime:m,topic:t})}),u},a.subscribe=function(t,n){var e=this;this.$10.subscribe(t);var r=this.$8.get(t);return r?r.push(n):(r=[n],this.$8.set(t,r)),function(){var r=e.$8.get(t)||[],o=r.filter(function(e){return e!==n});e.$8.set(t,o),o.length===0&&e.unsubscribeAll(t)}},a.subscribeBinary=function(t,n){var e=this;this.$10.subscribe(t);var r=this.$9.get(t);return r?r.push(n):(r=[n],this.$9.set(t,r)),function(){var r=e.$9.get(t)||[],o=r.filter(function(e){return e!==n});e.$9.set(t,o),o.length===0&&e.unsubscribeAll(t)}},a.subscribeChannelEvents=function(t){var e=this;return this.$3.push(t),function(){e.unsubscribeChannelEvents(t)}},a.unsubscribeChannelEvents=function(t){var e=this.$3.indexOf(t);e>-1&&this.$3.splice(e,1)},a.registerExtraConnectPayloadProvider=function(t){var e=this;if(this.$19("MqttChannel","registerExtraConnectPayloadProvider called"),this.$4.add(t),this.$10.isRunning()){var n=t.getPublishMessages();n.forEach(function(t){typeof t.payload=="string"?e.publish(t.topic,t.payload,{qos:t.qos,skipBuffer:!0}):e.publishBinary(t.topic,t.payload,{qos:t.qos,skipBuffer:!0})})}},a.unregisterExtraConnectPayloadProvider=function(t){this.$4.delete(t)},a.unsubscribeAll=function(t){this.$10.unsubscribe(t),this.$8.delete(t),this.$9.delete(t)},a.getConnectionState=function(){return this.$5},a.getLongPollingStatus=function(){return this.$7},a.getEndpoint=function(){return this.$1},a.addHook=function(t){this.$10.addHook(t)},a.removeHook=function(t){this.$10.removeHook(t)},a.testOnlyMessageReceived=function(t,n){this.$22(t,n,-1)},a.$34=function(t){var e=this.$15.get(t);e!=null&&e.timeoutId!=null&&o("MqttEnv").Env.clearTimeout(e.timeoutId),this.$15.delete(t)},a.$31=function(t){var e=this;return o("MqttEnv").Env.setTimeout(function(t){var n=e.$15.get(t);if(n){var o=n.topic;e.$11.bumpCounter("publish_timeout."+o),e.$11.debugTrace("publish_timeout","Timeout publishing topic: "+o+" publishToken: "+t),e.$34(t),n.ack.reject(r("err")("Publish Timed Out"))}},s,t)},a.$33=function(t){var e=t.publishToken,n=this.$15.get(e);n&&(this.$34(e),t.ack.resolve(),this.$11.debugTrace("publish_success","Topic: "+t.topic+" publishToken: "+t.publishToken),this.$11.bumpCounter("publish_success."+t.topic))},a.$22=function(t,n,o){var e=this.$8.get(t);if(this.$11.eventLogIncomingPublish({connectionState:this.getConnectionState(),disconnectCount:this.$10.getDisconnectCount(),payloadSizeBytes:n.payloadString.length*2,qos:o,sessionID:this.$10.getSessionId(),topic:t}),!e)this.$11.debugTrace("_onMessageReceived",t+" being dropped, no listeners");else for(var a of e)try{a(n.payloadString)}catch(e){this.$11.logError(r("getErrorSafe")(e),"Listener exception"),this.$11.bumpCounter("listener_error")}var i=this.$9.get(t);if(this.$11.eventLogIncomingPublish({connectionState:this.getConnectionState(),disconnectCount:this.$10.getDisconnectCount(),payloadSizeBytes:n.payloadBytes.length,qos:o,sessionID:this.$10.getSessionId(),topic:t}),!i)this.$11.debugTrace("_onMessageReceived",t+" being dropped, no binary listeners");else for(var l of i)try{l(n.payloadBytes)}catch(e){this.$11.logError(r("getErrorSafe")(e),"Binary Listener exception"),this.$11.bumpCounter("listener_error")}},a.$21=function(t){if(o("MqttEnv").Env.genGk(o("MqttEnv").MqttGkNames.mqtt_ws_polling_enabled)){t.isRecoverable?this.$11.bumpCounter("recoverable_error_skipped"):this.$11.bumpCounter("unrecoverable_error_skipped");return}t.isRecoverable?this.$11.bumpCounter("recoverable_error_not_skipped"):this.$11.bumpCounter("unrecoverable_error_not_skipped"),this.$35(t)},a.$36=function(t){this.$35(t)},a.$35=function(t){for(var e of this.$3)e.onJSError&&e.onJSError(t)},a.$37=function(){var e=this;this.$14.forEach(function(t){e.$30(t),e.$11.bumpCounter("publish_from_temp_buffer."+t.topic)}),this.$14=[],this.$15.forEach(function(t,n,r){e.$32(t),e.$11.bumpCounter("publish_from_buffer."+t.topic)})},a.$23=function(t){t==="Connecting"?(this.$14.forEach(function(e){e.ack.reject(r("err")("Client Reconnecting - "+e.topic))}),this.$14=[]):t==="TransportConnected"&&this.$37(),this.$19("_changeState","Connection state = "+t),this.$38(t,this.$7)},a.$39=function(t,n){this.$13&&this.$13.canPublish()&&this.$37(),this.$19("_changeLPStatus","LP status = "+t+", LP Request status = "+n),this.$38(this.$6,t)},a.$38=function(t,n){var e=this.$10.mqttStateFromConnectionState(t);this.$13&&this.$13.canPublish()&&(e="Connected"),this.$6=t,(e!==this.$5||n!=this.$7)&&(this.$5=e,this.$7=n,this.$40(e))},a.$40=function(t){for(var e of this.$3)e.onMQTTStateChanged(t)},a.$20=function(){var e=this,t=[];return this.$4.forEach(function(n){try{var o=n.getPublishMessages();Array.prototype.push.apply(t,o)}catch(t){e.$11.logError(r("getErrorSafe")(t),"ConnectPayload provider exception"),e.$11.bumpCounter("connectPayloadProvider_error")}}),t},a.$18=function(){var e=this;o("MqttEnv").Env.genGk(o("MqttEnv").MqttGkNames.mqtt_ws_polling_enabled)&&!r("MetaConfig")._("262")&&this.$2&&this.$2!=""&&r("requireDeferred")("MqttLongPollingRunner").__setRef("MqttChannel").onReady(function(t){var n=new t(e.$2,e.$12,e.$10.hasFatal(),e.$10.hasConnectSuccess(),function(t,n,r){return e.$22(t,n,r)},function(){var t=Array.from(e.$8.keys()),n=Array.from(e.$9.keys());return Array.from(new Set(t.concat(n)))},function(){return e.$20()},function(t){e.$36(t)},function(t,n){e.$39(t,n)});n.start(),e.$10.addHook(n),n.addHook(e.$16),e.$13=n,e.$11.debugTrace("MqttChannel","longPollingRunner loaded")})},a.$19=function(t,n){this.$11.debugTrace(t,"Mqtt channel: "+n)},a.setForegroundState=function(t){this.$12&&this.$12.setForegroundState(t)},a.setChatVisibility=function(t){this.$12&&this.$12.setChatVisibility(t)},a.getEndpointCapabilities=function(){return this.$12.getEndpointCapabilities()},a.setEndpointCapabilities=function(t){this.$12.setEndpointCapabilities(t)},a.getConnection_OnlyForTests=function(){return this.$10},t})();l.default=u}),98);
__d("MqttConfig",["MqttWebConfig"],(function(t,n,r,o,a,i,l){"use strict";l.default=r("MqttWebConfig")}),98);
__d("CurrentMessengerUser",["CurrentEnvironment","CurrentUser"],(function(t,n,r,o,a,i,l){"use strict";function e(){return r("CurrentUser").getID()}function s(){return r("CurrentEnvironment").instagramdotcom?r("CurrentUser").getEIMU():r("CurrentUser").getID()}function u(){return r("CurrentUser").getPageMessagingMailboxId()}function c(){return r("CurrentUser").isWorkUser()}function d(){return r("CurrentUser").isTestUser()}function m(){return r("CurrentUser").isEmployee()}function p(){return r("CurrentUser").getAppID()}function _(){return r("CurrentUser").getAccountID()}function f(){return r("CurrentUser").isLoggedInNow()}l.getID=e,l.getIDorEIMU=s,l.getPageMessagingMailboxId=u,l.isWorkUser=c,l.isTestUser=d,l.isEmployee=m,l.getAppID=p,l.getAccountID=_,l.isLoggedInNow=f}),98);
__d("MqttEnvConfigStorage",["WebStorage"],(function(t,n,r,o,a,i,l){var e,s="mqtt:";function u(t,n){var o=(e||(e=r("WebStorage"))).getLocalStorage();if(o){var a=o.getItem(s+t);if(a!=null)return a}return n}function c(t,n){var o=(e||(e=r("WebStorage"))).getLocalStorage();if(o)if(n==null)o.removeItem(s+t);else var a=(e||(e=r("WebStorage"))).setItemGuarded(o,s+t,n)}l.configRead=u,l.configWrite=c}),98);
__d("MqttUnifiedClientConnectFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(t,n,r,o,a,i,l){"use strict";var e=r("getFalcoLogPolicy_DO_NOT_USE")("1744057"),s=o("FalcoLoggerInternal").create("mqtt_unified_client_connect",e),u=s;l.default=u}),98);
__d("MqttUnifiedClientDisconnectFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(t,n,r,o,a,i,l){"use strict";var e=r("getFalcoLogPolicy_DO_NOT_USE")("1744058"),s=o("FalcoLoggerInternal").create("mqtt_unified_client_disconnect",e),u=s;l.default=u}),98);
__d("MqttUnifiedClientIncomingPublishFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(t,n,r,o,a,i,l){"use strict";var e=r("getFalcoLogPolicy_DO_NOT_USE")("1744059"),s=o("FalcoLoggerInternal").create("mqtt_unified_client_incoming_publish",e),u=s;l.default=u}),98);
__d("MqttUnifiedClientOutgoingPublishFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(t,n,r,o,a,i,l){"use strict";var e=r("getFalcoLogPolicy_DO_NOT_USE")("1744060"),s=o("FalcoLoggerInternal").create("mqtt_unified_client_outgoing_publish",e),u=s;l.default=u}),98);
__d("generateLiteTypedLogger",["Banzai","JstlMigrationFalcoEvent","getDataWithLoggerOptions"],(function(t,n,r,o,a,i,l){"use strict";function e(e,t,n){var o=e.split(":")[0],a=e.split(":")[1];o=="logger"?r("JstlMigrationFalcoEvent").log(function(){return{logger_config_name:a,payload:t}}):r("Banzai").post(e,t,n)}function s(t){return{log:function(o,a){e(t,r("getDataWithLoggerOptions")(o,a),r("Banzai").BASIC)},logVital:function(o,a){e(t,r("getDataWithLoggerOptions")(o,a),r("Banzai").VITAL)},logImmediately:function(o,a){e(t,r("getDataWithLoggerOptions")(o,a),{signal:!0})}}}l.default=s}),98);
__d("MqttWsClientTypedLoggerLite",["generateLiteTypedLogger"],(function(t,n,r,o,a,i){"use strict";a.exports=n("generateLiteTypedLogger")("logger:MqttWsClientLoggerConfig")}),null);
__d("MqttLogger",["ChannelClientID","FBLogger","LogHistory","MetaConfig","MqttEnv","MqttGlobalStreamCounter","MqttUnifiedClientConnectFalcoEvent","MqttUnifiedClientDisconnectFalcoEvent","MqttUnifiedClientIncomingPublishFalcoEvent","MqttUnifiedClientOutgoingPublishFalcoEvent","MqttWsClientTypedLoggerLite","NetworkStatus","ODS","Random"],(function(t,n,r,o,a,i,l){"use strict";var e,s=r("MetaConfig")._("99"),u="mqtt_client",c=100,d="WEBSOCKET",m=typeof window!="undefined"?window:self,p=null,_={CLIENT_ERROR:"mqtt_client_error",CONNECT:"mqtt_client_connect",DISCONNECT:"mqtt_client_disconnect",PUBLISH:"mqtt_client_publish",PUBLISH_TIMEOUT:"mqtt_qos1_publish_timeout",SOCKET_DISCONNECT:"mqtt_protocol_error"},f={CONNECT:"connect",DISCONNECT:"disconnect",INCOMING_PUBLISH:"incoming_publish",OUTGOING_PUBLISH:"outgoing_publish"},g=(function(){function t(e){this.$1=o("LogHistory").getInstance(u),this.$2=0,this.$3=Date.now(),this.$4=r("ChannelClientID").getID(),this.$7(),this.$5=o("MqttGlobalStreamCounter").getInstance(),this.$5.isEnabled()||(this.$5=null),this.$6=e}t.getInstance=function(n){return p||(p=new t(n)),p};var n=t.prototype;return n.setAppId=function(t){this.$2===0&&(this.$2=t)},n.eventLogConnect=function(t){var e,n,o=t.ackReceived,a=t.attemptNumber,i=t.connectionState,l=t.connectionStatus,s=t.disconnectCount,u=t.duration,c=t.errorMessage,m=t.failTotal,p=t.hostname,g=t.messageSizeBytes,h=t.osConnectivity,y=t.sessionID,C=t.successTotal,b=t.total_duration,v=l?"success":"failed";this.bumpCounter(_.CONNECT+"."+v);var S=C/(C+m),R=h&&this.getBrowserConnectivity(),L={acked:o,attempt_number:a.toString(),client_type:d,connection_state:i,disconnect_count:s.toString(),duration:u.toString(),error:c,event_type:f.CONNECT,extra_data:{connect_success_rate:S.toString(),device_id:this.$4,hostname:p,connectionStatus:l.toString(),exposure:(e=this.$6)!=null?e:""},os_connectivity:R,payload_size:g==null?void 0:g.toString(),session_id:y.toString(),total_duration:b.toString(),ws_count:(n=this.$5)==null?void 0:n.getGlobalState().totalConnectionStreams.toString()};this.$8(function(){r("MqttUnifiedClientConnectFalcoEvent").log(function(){return L})})},n.eventLogPull=function(t){var e=t.duration,n=t.errorMessage,r=t.hostname,a=t.pullEventName,i=t.sessionID,l=t.status,s={connection_status:l,device_id:this.$4,duration:e,error_message:n,hostname:r,href:m.location.hostname,logged_in:o("MqttEnv").Env.isUserLoggedInNow(),session_id:i};this.$9(a,s)},n.eventLogPullFinish=function(t){var e=t.duration,n=t.errorMessage,r=t.publishReceived,a=t.publishSent,i=t.pullEventName,l=t.sessionID,s={device_id:this.$4,duration:e,error_message:n,href:m.location.hostname,logged_in:o("MqttEnv").Env.isUserLoggedInNow(),publish_received:r,publish_sent:a,session_id:l};this.$9(i,s)},n.eventLogDisconnect=function(t){var e,n,o=t.disconnectCount,a=t.duration,i=t.errorMessage,l=t.sessionID;this.bumpCounter(_.DISCONNECT);var s={client_type:d,connection_state:"Disconnected",disconnect_count:o.toString(),duration:a.toString(),error:i,event_type:f.DISCONNECT,extra_data:{device_id:this.$4,exposure:(e=this.$6)!=null?e:""},os_connectivity:this.getBrowserConnectivity(),session_id:l.toString(),ws_count:(n=this.$5)==null?void 0:n.getGlobalState().totalConnectionStreams.toString()};this.$8(function(){r("MqttUnifiedClientDisconnectFalcoEvent").log(function(){return s})})},n.eventLogOutgoingPublish=function(t){var e=t.attempt,n=t.connectionState,o=t.disconnectCount,a=t.errorMessage,i=t.firstAttemptStartTime,l=t.payloadSizeBytes,s=t.protocol,u=t.qos,c=t.sessionID,m=t.success,p=t.thisAttemptStartTime,g=t.topic;this.bumpCounter(_.PUBLISH+"."+g);var h=Date.now(),y={acked:u===1?m:null,attempt_number:e.toString(),client_type:d,connection_state:n,disconnect_count:o.toString(),duration:(h-p).toString(),error:a,event_type:f.OUTGOING_PUBLISH,extra_data:{device_id:this.$4,protocol:s},os_connectivity:this.getBrowserConnectivity(),payload_size:l.toString(),qos:u.toString(),session_id:c.toString(),topic:g,total_duration:i!=null?(h-i).toString():null};this.$8(function(){r("MqttUnifiedClientIncomingPublishFalcoEvent").log(function(){return y})})},n.eventLogIncomingPublish=function(t){var e=t.connectionState,n=t.disconnectCount,o=t.payloadSizeBytes,a=t.qos,i=t.sessionID,l=t.topic,s={client_type:d,connection_state:e,disconnect_count:n.toString(),event_type:f.INCOMING_PUBLISH,extra_data:{device_id:this.$4},os_connectivity:this.getBrowserConnectivity(),payload_size:o.toString(),qos:a.toString(),session_id:i.toString(),topic:l},u=l=="/webrtc"||l=="/rtc_multi";this.$10(function(){r("MqttUnifiedClientOutgoingPublishFalcoEvent").log(function(){return s})},50,u)},n.logError=function(t,n){o("MqttEnv").Env.scheduleLoggingCallback(function(){try{r("FBLogger")(u).catching(t).mustfix(n)}catch(e){}})},n.logErrorWarn=function(t,n){o("MqttEnv").Env.scheduleLoggingCallback(function(){try{r("FBLogger")(u).catching(t).warn(n)}catch(e){}})},n.logWarn=function(t,n){var e=this;o("MqttEnv").Env.scheduleLoggingCallback(function(){try{e.$1.warn(t,n)}catch(e){}})},n.debugTrace=function(t,n){var e=this;o("MqttEnv").Env.scheduleLoggingCallback(function(){try{e.$1.debug(t,n)}catch(e){}})},n.bumpCounter=function(n){var t=this;o("Random").coinflip(c)&&o("MqttEnv").Env.scheduleLoggingCallback(function(){t.$2!==0&&(e||(e=o("ODS"))).bumpEntityKey(2966,"mqtt_ws_client",t.$2+"."+n,c),(e||(e=o("ODS"))).bumpEntityKey(2966,"mqtt_ws_client",n,c)})},n.$9=function(t,n,a){var e=this;o("MqttEnv").Env.scheduleLoggingCallback(function(){n.event_type=t,n.app_id=e.$2,n.online=e.$11();var o=JSON.stringify(n);e.$1.log(t,o,{weight:a}),t!==_.DISCONNECT&&r("MqttWsClientTypedLoggerLite").log(n)})},n.$10=function(t,n,r){var e;s&&n!==0?e=r||o("Random").coinflip(n):e=!0,e&&o("MqttEnv").Env.scheduleCallback(t)},n.$8=function(t){this.$10(t,0,!1)},n.$11=function(){return m.navigator&&m.navigator.onLine!==void 0?m.navigator.onLine:!1},n.getBrowserConnectivity=function(){return r("NetworkStatus").isOnline()},n.$7=function(){var e=this;if(m.navigator&&m.navigator.onLine!==void 0){var t=function(n){var t=n.online;t||e.bumpCounter("browser_disconnect")};r("NetworkStatus").onChange(t)}},t})();l.default=g}),98);
__d("MqttEnvGk",["MqttEnv","MqttLogger","gkx"],(function(t,n,r,o,a,i,l){"use strict";function e(e){switch(e){case o("MqttEnv").MqttGkNames.mqtt_waterfall_log_client_sampling:return r("gkx")("21119");case o("MqttEnv").MqttGkNames.mqtt_ws_polling_enabled:return!0;case o("MqttEnv").MqttGkNames.mqtt_lp_use_fetch:return r("gkx")("21120");case o("MqttEnv").MqttGkNames.mqtt_fast_lp:return!1;case o("MqttEnv").MqttGkNames.mqtt_lp_no_delay:return r("gkx")("21122");case o("MqttEnv").MqttGkNames.mqtt_enable_publish_over_polling:return r("gkx")("21123");case o("MqttEnv").MqttGkNames.mqttweb_global_connection_counter:return r("gkx")("21124");default:return r("MqttLogger").getInstance().logError(new Error("unknown gk"),"Unknown GK value "+e),!1}}l.default=e}),98);
__d("MqttEnvInitializer",["CurrentMessengerUser","MqttEnv","MqttEnvConfigStorage","MqttEnvGk","MqttLogger","Random","clearTimeout","setTimeoutAcrossTransitions"],(function(t,n,r,o,a,i,l){"use strict";function e(e){o("MqttEnv").Env.initialize(r("Random").random,o("CurrentMessengerUser").isLoggedInNow,r("clearTimeout"),r("setTimeoutAcrossTransitions"),function(){return r("MqttLogger").getInstance()},r("MqttEnvGk"),e!=null?e:null,null,null,o("MqttEnvConfigStorage").configRead,o("MqttEnvConfigStorage").configWrite)}var s={genGk:r("MqttEnvGk"),initialize:e};l.default=s}),98);
__d("FBMqttChannel",["MqttChannel","MqttConfig","MqttEnvInitializer"],(function(t,n,r,o,a,i,l){"use strict";var e;r("MqttEnvInitializer").initialize();var s=new(r("MqttChannel"))({appId:(e=r("MqttConfig")).appID,capabilities:e.capabilities,chatVisibility:!1,clientCapabilities:e.clientCapabilities,endpoint:e.endpoint,initialSubscribedTopics:e.subscribedTopics,phpOverride:e.hostNameOverride,pollingEndpoint:e.pollingEndpoint,userFbid:e.fbid});l.default=s}),98);
__d("RtiRequestStreamE2eClientBatchFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(t,n,r,o,a,i,l){"use strict";var e=r("getFalcoLogPolicy_DO_NOT_USE")("819"),s=o("FalcoLoggerInternal").create("rti_request_stream_e2e_client_batch",e),u=s;l.default=u}),98);
__d("RtiRequestStreamE2eClientFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(t,n,r,o,a,i,l){"use strict";var e=r("getFalcoLogPolicy_DO_NOT_USE")("1857112"),s=o("FalcoLoggerInternal").create("rti_request_stream_e2e_client",e),u=s;l.default=u}),98);
__d("RequestStreamE2ELogger",["ConstUriUtils","FBLogger","RequestStreamE2EClientLoggerEvent","RequestStreamE2EClientLoggerMessageType","RtiRequestStreamE2eClientBatchFalcoEvent","RtiRequestStreamE2eClientFalcoEvent","WebStorage"],(function(t,n,r,o,a,i,l){"use strict";var e,s="rs_debug_logging",u=["FBGQLS:COMMENT_CREATE_SUBSCRIBE","FBGQLS:COMMENT_LIKE_SUBSCRIBE","FBGQLS:FEEDBACK_COMMENT_PERMISSION_TOGGLE_SUBSCRIBE","FBGQLS:FEEDBACK_TYPING_SUBSCRIBE","FBLQ:comet_notifications_live_query_experimental"],c=0;function d(){var e=Date.now();return c>=e?c+=1:c=e,c.toString()}var m=(function(){function e(e,t,n,r,a,i,l,s,u,c){this.$10=[],this.$11=!1,this.$1=e,this.$2=t,this.$3=n,this.$4=r,this.$5=a,this.$6=i,this.$7=l,this.$8=s,this.$9=u,this.$12=c!=null?c:!1;var d=o("ConstUriUtils").getUri(window.location.href);d&&(this.$13=d.getDomain())}var t=e.prototype;return t.logE2EEvent=function(t,n,r,o,a,i,l){if(r===void 0&&(r=null),o===void 0&&(o=null),a===void 0&&(a=null),i===void 0&&(i=null),l===void 0&&(l=null),this.$3!=="Falco"){var e={request_id:this.$1,resume_id:"0",retry_id:a,transport:this.$2,method:this.$3,use_case:this.$4,request_log_context:this.$5,force_log_context:this.$6,e2e_sample_rate:this.$7,message_type:t,event:n,timestamp_ms:d(),aux_id:o,additional_data:r,dgw_stream_group_logging_id:this.$8,dgw_count_prior_streams_in_group:this.$9,domain:this.$13,df_trace_id:i};this.$14(e,l)}},t.$14=function(t,n){if(!this.$12){r("RtiRequestStreamE2eClientFalcoEvent").log(function(){return t});return}if(this.$10.push(t),this.$11||t.event==r("RequestStreamE2EClientLoggerEvent").FAILURE||t.message_type==r("RequestStreamE2EClientLoggerMessageType").RESPONSE){var e={events:this.$10};r("RtiRequestStreamE2eClientBatchFalcoEvent").log(function(){return e}),this.$10=[],this.$11=!0}},t.getRequestId=function(){return this.$1},e})();function p(e,t,n){if(e==null||e.method==null)return null;var r=!1;if(u.includes(e.method)&&(r=!0),t==null||t.length==0)return null;var o=JSON.parse(t);return o.requestId==null?null:new m(o.requestId,n,e.method,_(e.method,e),o.requestLogContext,o.forceLogContext,o.sampleRate,o.dgwStreamGroupLoggingId,o.dgwCountPriorStreamsInGroup,r)}function _(e,t){if(e==="FBLQ"&&t.config_id)return t.config_id;if(e==="SKY"){if(t.topic){var n=t.topic.lastIndexOf("/");return n>0?t.topic.substr(0,n):t.topic}return}return e}function f(e,t,n,o,a,i){if(a===void 0&&(a=null),i===void 0&&(i=null),!(e==null||e.requestId==null||e.clientLoggingDisabled!=null)){var l={request_id:e.requestId,resume_id:"0",transport:t,e2e_sample_rate:e.sampleRate,message_type:n,event:o,timestamp_ms:d(),aux_id:e.auxId,additional_data:a,df_trace_id:i};r("RtiRequestStreamE2eClientFalcoEvent").log(function(){return l})}}l.RequestStreamE2ELogger=m,l.createStreamLogger=p,l.logRequestStreamE2EEventStatic=f}),98);
__d("RequestStreamTransport",["$InternalEnum"],(function(t,n,r,o,a,i){"use strict";var e=n("$InternalEnum").Mirrored(["WEB_BR_MQTT","WEB_RS_MQTT","WEB_RS_STARGATE"]);i.RequestStreamTransport=e}),66);
__d("BladeRunnerSocket",["BladeRunnerEventHandler","BladeRunnerLogger","BladeRunnerStreamStatus","BladeRunnerTypes","BladeRunnerTypesInternal","CurrentUser","FBMqttChannel","MqttPublishListener","Promise","RequestStreamE2EClientLoggerEvent","RequestStreamE2EClientLoggerMessageType","RequestStreamE2ELogger","RequestStreamTransport","getErrorSafe","justknobx","uuidv4"],(function(t,n,r,o,a,i,l){"use strict";var e,s="Connected",u="Disconnected",c="/br_sr",d="/sr_res",m=null;function p(e){var t,n;switch(e.type){case o("BladeRunnerTypes").StreamFrameType.REQUEST:return(t=e.request)==null?void 0:t.getInstrumentationData();case o("BladeRunnerTypes").StreamFrameType.DATA:return(n=e.data)==null?void 0:n.getInstrumentationData()}return null}function _(e){switch(e.type){case o("BladeRunnerTypes").StreamFrameType.REQUEST:return r("RequestStreamE2EClientLoggerMessageType").REQUEST_STREAM;case o("BladeRunnerTypes").StreamFrameType.DATA:return r("RequestStreamE2EClientLoggerMessageType").AMENDMENT}return null}function f(e){if(e===null)return null;switch(e){case o("BladeRunnerStreamStatus").StreamStatus.ACCEPTED:return"Accepted";case o("BladeRunnerStreamStatus").StreamStatus.REJECTED:return"Rejected";case o("BladeRunnerStreamStatus").StreamStatus.STARTED:return"Started";case o("BladeRunnerStreamStatus").StreamStatus.STOPPED:return"Stopped";case o("BladeRunnerStreamStatus").StreamStatus.CLOSED:return"Closed"}return null}function g(e){var t,n={};return e==null||(t=e.frames)==null||t.forEach(function(e){if(e.type===o("BladeRunnerTypes").StreamFrameType.STATUS_UPDATE){var t,r=(t=e.statusUpdate)==null?void 0:t.status,a=f(r);a!==null&&(n.flow_status=a)}}),n}function h(e,t){var n,r;switch(e.type){case o("BladeRunnerTypes").StreamFrameType.REQUEST:t.data_base64_size=(n=e.request)==null||(n=n.payload)==null||(n=n.length)==null?void 0:n.toString();break;case o("BladeRunnerTypes").StreamFrameType.DATA:t.data_base64_size=(r=e.data)==null||(r=r.rawDataSize())==null?void 0:r.toString();break}return null}function y(e,t,n){var a,i=p(e);if(i!=null){var l=_(e);if(l!=null){var s=null;switch(t){case o("MqttPublishListener").MqttPublishEvent.SENT:s=r("RequestStreamE2EClientLoggerEvent").SENT;break;case o("MqttPublishListener").MqttPublishEvent.ACKED:s=r("RequestStreamE2EClientLoggerEvent").PUBACK;break;case o("MqttPublishListener").MqttPublishEvent.NOT_ACKED:case o("MqttPublishListener").MqttPublishEvent.NOT_CONNECTED:case o("MqttPublishListener").MqttPublishEvent.PUBLISH_ERROR:s=r("RequestStreamE2EClientLoggerEvent").FAILURE,n.reason==null&&(n.reason=t);break}if(s!=null)if(h(e,n),((a=e.request)==null?void 0:a.e2eLogger)!=null&&i.clientLoggingDisabled==null){var u;(u=e.request)==null||u.e2eLogger.logE2EEvent(l,s,n,i.auxId)}else o("RequestStreamE2ELogger").logRequestStreamE2EEventStatic(i,o("RequestStreamTransport").RequestStreamTransport.WEB_BR_MQTT,l,s,n)}}}var C=(function(){function t(e){this.$1=[],this.$2=0,this.$3=0,this.$4=null,this.$5=0,this.$6=new Map,this.$7=e!=null?e:r("FBMqttChannel"),this.$8=new Map,r("BladeRunnerLogger").setClientSessionId(r("uuidv4")()),this.$9()}t.get=function(){return m==null&&(m=new t(r("FBMqttChannel"))),m};var a=t.prototype;return a.sendNewStreamRequest=function(n,o){var e=new(r("BladeRunnerEventHandler"))(n,o,this),a=n.getRequest();if(this.$6.set(a.streamId,e),!this.$10()){this.$11(e,a.streamId);return}this.getStreamCount()<=t.maxStreamCount?this.$12(a):(r("BladeRunnerLogger").bumpCounter("socket_request_throttled_max_streams"),r("BladeRunnerLogger").warn("Maximum stream count reached, will not send request: "+JSON.stringify(n.getRequest().getHeaders())),this.$11(e,a.streamId))},a.sendRetryStreamRequest=function(t){this.$12(t.getRequest())},a.sendCancel=function(t){r("BladeRunnerLogger").bumpCounter("socket_send_cancel");var e=new(o("BladeRunnerTypesInternal")).GatewayStreamStatusUpdate;e.streamId=t.streamId,e.status=o("BladeRunnerStreamStatus").StreamStatus.CLOSED,this.$13(e,t),this.removeStream(t.streamId)},a.sendAmendment=function(t,n,a){r("BladeRunnerLogger").bumpCounter("socket_send_amendment");var e=new(o("BladeRunnerTypesInternal")).GatewayStreamData;e.streamId=t,e.setData(n),a!=null&&(e.instrumentationData=a),this.$14(e)},a.sendAmendmentWithAck=function(a,i,l){var t=this;r("BladeRunnerLogger").bumpCounter("socket_send_amendment");var s=this.$15(),u=new(o("BladeRunnerTypesInternal")).GatewayStreamData;u.streamId=a,u.setData(i),u.shouldAck=!0,u.dataId=s,l!=null&&(u.instrumentationData=l);var c=new(e||(e=n("Promise")))(function(e,n){t.$8.set(s,{resolve:e,reject:n})});return this.$14(u),c},a.$14=function(t){this.$1.push(o("BladeRunnerTypesInternal").GatewayStreamFrame.newDataFrame(t)),this.$16()},a.sendDataAcks=function(t){r("BladeRunnerLogger").bumpCounter("socket_send_data_ack",t.length),this.$17(t)},a.removeStream=function(t){this.$6.delete(t)},a.getStreamCount=function(){return this.$6.size},a.getNextStreamId=function(){return this.$5++,this.$5},a.onMQTTStateChanged=function(t){this.$16(),!(t!=u&&t!=s||this.$4==t)&&(this.$4=t,r("BladeRunnerLogger").info("MQTTStateChanged: "+t),t==u?(r("BladeRunnerLogger").bumpCounter("mqtt_state_disconnected"),this.$18()):t==s&&r("BladeRunnerLogger").bumpCounter("mqtt_state_connected"))},a.$12=function(t){if(r("BladeRunnerLogger").bumpCounter("socket_send_request"),this.$1.push(o("BladeRunnerTypesInternal").GatewayStreamFrame.newRequestFrame(t)),!this.$16()){var e;(e=t.e2eLogger)==null||e.logE2EEvent(r("RequestStreamE2EClientLoggerMessageType").REQUEST_STREAM,r("RequestStreamE2EClientLoggerEvent").FAILURE,{reason:"MQTT Not Connected"})}},a.$13=function(t,n){if(this.$1.push(o("BladeRunnerTypesInternal").GatewayStreamFrame.newStatusUpdateFrame(t)),this.$16()){var e;(e=n.e2eLogger)==null||e.logE2EEvent(r("RequestStreamE2EClientLoggerMessageType").CANCEL,r("RequestStreamE2EClientLoggerEvent").SENT)}},a.$17=function(t){for(var e of t)this.$1.push(o("BladeRunnerTypesInternal").GatewayStreamFrame.newDataAckFrame(e));this.$16()},a.$19=function(){return this.$2++,this.$2},a.$15=function(){return this.$3++,this.$3},a.$16=function(){var e=!1;if(this.$7.getConnectionState()===s&&this.$1.length>0)try{this.$20(this.$1),e=!0}catch(e){}finally{this.$1=[]}return e},a.$20=function(t){var e=this,n=new(o("BladeRunnerTypesInternal")).GatewayStreamBatch(this.$19(),t),a=n.write();if(a.length>this.$21()){var i=Math.floor(t.length/2);if(i===0){t.forEach(function(e){return y(e,o("MqttPublishListener").MqttPublishEvent.PUBLISH_ERROR,{reason:"too long"})});var l=new Error("Publish is too long: "+a.length);throw l.stack,this.$22(n,l,"Publish is too long"),l}this.$20(t.slice(0,i)),this.$20(t.slice(i,t.length))}else try{r("BladeRunnerLogger").info("send message to "+c+" ("+a.length+" bytes)");var s={qos:1,skipBuffer:!1};if(n.isInstrumented()){var u=Date.now();s.listener={onEvent:function(n){var e=(Date.now()-u).toString();t.forEach(function(t){y(t,n,{latency:e})})}}}this.$7.publish(c,a,s).catch(function(t){e.$22(n,t,"Failed publishing to MQTT")}),r("BladeRunnerLogger").bumpCounter("mqtt_publish_success")}catch(e){var d=r("getErrorSafe")(e);throw this.$22(n,d,"Failed publishing to MQTT"),d}},a.$9=function(){var e=this;r("BladeRunnerLogger").info("Starting socket with endpoint "+this.$7.getEndpoint()+" useragent "+navigator.userAgent),this.onMQTTStateChanged(this.$7.getConnectionState()),this.$7.subscribeChannelEvents({onMQTTStateChanged:function(n){e.onMQTTStateChanged(n)},onJSError:function(t){var e=t!=null&&typeof t.isRecoverable=="boolean"?t.isRecoverable:!1;e?r("BladeRunnerLogger").bumpCounter("mqtt_channel_recoverable_error"):(r("BladeRunnerLogger").warn("JS error in MQTTChannel: "+(typeof t=="object"&&t!=null?t.toString():"unknown error")+", "+JSON.stringify(t)),r("BladeRunnerLogger").bumpCounter("mqtt_channel_error"))}}),this.$7.subscribe(c,function(e){throw new Error("Unexpected response: "+c+" "+e.toString())}),this.$7.subscribe(d,function(t){e.$23(t)})},a.$23=function(t){var e=o("BladeRunnerTypesInternal").GatewayStreamBatch.read(t);this.processBatch(e)},a.$22=function(t,n,a){for(var e of t.getFrames())if(e.type===o("BladeRunnerTypes").StreamFrameType.REQUEST){var i=e.getRequest(),l=this.$6.get(i.streamId);l!=null&&this.$24(l,i.streamId,o("BladeRunnerStreamStatus").StreamStatus.CLOSED,!0,null)}else if(e.type===o("BladeRunnerTypes").StreamFrameType.DATA){var s=e.getData(),u=s.dataId;if(s.shouldAck!=null&&s.shouldAck&&u!=null){var c=new(o("BladeRunnerTypesInternal")).GatewayStreamDataAck;c.streamId=s.streamId,c.dataId=u,c.success=!1,c.code=o("BladeRunnerTypesInternal").GatewayStreamDataAck.ACK_CODE_FAILED_TO_LAND,c.message=a,this.$25(c)}}r("BladeRunnerLogger").info("Failed publishing to MQTT: "+n.message),r("BladeRunnerLogger").bumpCounter("mqtt_publish_error")},a.$25=function(t){var e=this.$8.get(t.dataId);e!=null&&(this.$8.delete(t.dataId),t.success?e.resolve(!0):t.code===o("BladeRunnerTypesInternal").GatewayStreamDataAck.ACK_CODE_LANDED_BUT_NOT_ACCEPTED?e.resolve(!1):e.reject(t.message))},a.processBatch=function(t){try{o("RequestStreamE2ELogger").logRequestStreamE2EEventStatic(t.getInstrumentationData(),o("RequestStreamTransport").RequestStreamTransport.WEB_BR_MQTT,r("RequestStreamE2EClientLoggerMessageType").RESPONSE,r("RequestStreamE2EClientLoggerEvent").RECEIVED,g(t),t.getInstrumentationDataDfTraceId()),r("BladeRunnerLogger").bumpCounter("socket_process_batch");var e=JSON.stringify(t);r("BladeRunnerLogger").info("Received batch ("+e.length+" bytes)");var n=null;for(var a of t.getFrames()){var i=a.getStreamId();if(n==null&&(n=i),i!=null&&n!=i)throw new Error("Received batch with frames for multiple streams");a.type==o("BladeRunnerTypes").StreamFrameType.DATA_ACK&&this.$25(a.getDataAck())}if(n!=null){var l=this.$6.get(n);l!=null?l.onProxyResponse(t):r("BladeRunnerLogger").info("Received batch with frames for unknown stream id: "+n)}else r("BladeRunnerLogger").info("Received batch with no frames")}catch(e){var s=r("getErrorSafe")(e);throw r("BladeRunnerLogger").exception(s,"Failed processing batch from MQTT"),r("BladeRunnerLogger").bumpCounter("socket_process_batch_error"),s}},a.$18=function(){this.$6.forEach(function(e,t,n){e.onDisconnect()})},a.$11=function(t,n){this.$24(t,n,o("BladeRunnerStreamStatus").StreamStatus.REJECTED,!1,0)},a.$24=function(t,n,r,a,i){var e=new(o("BladeRunnerTypesInternal")).GatewayStreamStatusUpdate;e.streamId=n,e.status=r,e.shouldRetry=a,e.retryDelayMs=i;var l=new(o("BladeRunnerTypesInternal")).GatewayStreamBatch(null,[o("BladeRunnerTypesInternal").GatewayStreamFrame.newStatusUpdateFrame(e)]);t.onProxyResponse(l)},a.$10=function(){return r("CurrentUser").isLoggedIn()?!0:(r("BladeRunnerLogger").bumpCounter("request_stream_user_logged_out"),!1)},a.$21=function(){var e=1048576,t=512*1024;try{var n=r("justknobx")._("317");t=n*e}catch(e){}return Math.max(t-1024,0)},t})();C.maxStreamCount=2e3,l.default=C}),98);
__d("BladeRunnerStream",["Promise","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i){var e,l=(function(){function t(e){this.$1=e}var r=t.prototype;return r.getStreamHandler=function(){return this.$1},r.cancel=function(){},r.amendWithAck=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){return!1});function t(t){return e.apply(this,arguments)}return t})(),r.amendFireAndForget=function(t){},r.amendWithoutAck=function(t){},r.start=function(){return(e||(e=n("Promise"))).resolve()},r.isAlive=function(){return!1},r.canAmend=function(){return!1},r.getStatus=function(){return null},r.getStreamId=function(){return 0},t})();i.default=l}),66);
__d("BladeRunnerStreamState",["BladeRunnerLogger","BladeRunnerStreamStatus","BladeRunnerTypes"],(function(t,n,r,o,a,i,l){var e=(function(){function e(e){this.$1=e,this.$2=null,this.$3=0,this.$4=!1,this.$5=0,this.$6=!1}var t=e.prototype;return t.getRequest=function(){return this.$1},t.updateRetryRequestPayload=function(t){this.$1.updateRetryRequestPayload(t)},t.isAlive=function(){return!(this.$2==o("BladeRunnerStreamStatus").StreamStatus.CLOSED||this.$2==o("BladeRunnerStreamStatus").StreamStatus.REJECTED)},t.canAmend=function(){return this.$2==o("BladeRunnerStreamStatus").StreamStatus.ACCEPTED||this.$2==o("BladeRunnerStreamStatus").StreamStatus.STARTED||this.$2==o("BladeRunnerStreamStatus").StreamStatus.STOPPED},t.getLastStatus=function(){return this.$2},t.setLastStatus=function(t){this.$2=t},t.onError=function(){this.$3+=1},t.getErrorCount=function(){return this.$3},t.resetErrors=function(){this.$3=0},t.getRetryRequestScheduled=function(){return this.$6},t.setRetryRequestScheduled=function(t){this.$6=t},t.witnessFrame=function(t){switch(t.type){case o("BladeRunnerTypes").StreamFrameType.STATUS_UPDATE:var e=t.getStatusUpdate(),n=!0;switch(e.status){case o("BladeRunnerStreamStatus").StreamStatus.ACCEPTED:n=!this.$4,this.$4||(this.$4=!0);break;case o("BladeRunnerStreamStatus").StreamStatus.STARTED:n=this.getLastStatus()!=o("BladeRunnerStreamStatus").StreamStatus.STARTED;break;case o("BladeRunnerStreamStatus").StreamStatus.STOPPED:n=this.getLastStatus()==o("BladeRunnerStreamStatus").StreamStatus.STARTED;break;case o("BladeRunnerStreamStatus").StreamStatus.CLOSED:case o("BladeRunnerStreamStatus").StreamStatus.REJECTED:default:n=!0}return this.setLastStatus(e.status),n;case o("BladeRunnerTypes").StreamFrameType.REWRITE_REQUEST:return this.$7(t.getRewriteRequest()),!1;default:return!0}},t.setRetriesAllowed=function(t){this.$5=t},t.getRetriesAllowed=function(){return this.$5},t.$7=function(t){if(!(t.temporary!=null||t.temporary==!0)){if(t.newBody!=null&&(this.$1.payload=t.newBody),t.newExtraHeader!=null&&(this.$1.extraHeader=t.newExtraHeader,this.$1.headers=JSON.parse(t.newExtraHeader)),t.patchExtraHeader!=null)try{var e=JSON.parse(t.patchExtraHeader),n=this.$1.extraHeader!=null?JSON.parse(this.$1.extraHeader):{};this.$1.headers==null&&(this.$1.headers={});for(var o of Object.keys(e))this.$1.headers[o]=e[o],n[o]=e[o];this.$1.extraHeader=JSON.stringify(n)}catch(e){r("BladeRunnerLogger").warn("Failed to patch header: "+t.patchExtraHeader)}t.killBody!=null&&t.killBody==!0&&(this.$1.payload=null)}},e})();l.default=e}),98);
__d("BladeRunnerSocketStream",["BladeRunnerStream","BladeRunnerStreamState","BladeRunnerStreamStatus","Promise","RequestStreamE2EClientLoggerEvent","RequestStreamE2EClientLoggerMessageType","asyncToGeneratorRuntime","uuidv4"],(function(t,n,r,o,a,i,l){var e,s=4,u={reason:"stream_dead"},c=(function(t){function a(e,n,o){var a;return a=t.call(this,e)||this,a.$BladeRunnerSocketStream$p_1=o,a.$BladeRunnerSocketStream$p_2=new(r("BladeRunnerStreamState"))(n),a.$BladeRunnerSocketStream$p_2.setRetriesAllowed(s),a}babelHelpers.inheritsLoose(a,t);var i=a.prototype;return i.start=function(){var t=this;return new(e||(e=n("Promise")))(function(e){t.send(),e()})},i.send=function(){var e,t,n=this.$BladeRunnerSocketStream$p_2.getRequest();(e=n.e2eLogger)==null||e.logE2EEvent(r("RequestStreamE2EClientLoggerMessageType").REQUEST_STREAM,r("RequestStreamE2EClientLoggerEvent").RECEIVED,{data_base64_size:(t=n.payload)==null||(t=t.length)==null?void 0:t.toString()}),this.$BladeRunnerSocketStream$p_1.sendNewStreamRequest(this.$BladeRunnerSocketStream$p_2,this.getStreamHandler())},i.amendWithAck=(function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var o,a=this.$BladeRunnerSocketStream$p_2.getRequest(),i=a.getInstrumentationData();if(i){var l,s;i.auxId=r("uuidv4")(),(l=a.e2eLogger)==null||l.logE2EEvent(r("RequestStreamE2EClientLoggerMessageType").AMENDMENT,r("RequestStreamE2EClientLoggerEvent").RECEIVED,{data_size:t==null||(s=t.length)==null?void 0:s.toString()},i.auxId)}if(this.canAmend()){if(i){var c,d;(c=a.e2eLogger)==null||c.logE2EEvent(r("RequestStreamE2EClientLoggerMessageType").AMENDMENT,r("RequestStreamE2EClientLoggerEvent").SENT,{data_size:t==null||(d=t.length)==null?void 0:d.toString()},i.auxId)}return this.$BladeRunnerSocketStream$p_1.sendAmendmentWithAck(a.streamId,this.$BladeRunnerSocketStream$p_3(t),i==null?null:JSON.stringify(i))}return(o=a.e2eLogger)==null||o.logE2EEvent(r("RequestStreamE2EClientLoggerMessageType").AMENDMENT,r("RequestStreamE2EClientLoggerEvent").FAILURE,u,i==null?void 0:i.auxId),(e||(e=n("Promise"))).reject("Stream is closed or not accepted")});function o(e){return t.apply(this,arguments)}return o})(),i.amendFireAndForget=function(t){var e=this.$BladeRunnerSocketStream$p_2.getRequest(),n=e.getInstrumentationData();if(n){var o,a;n.auxId=r("uuidv4")(),(o=e.e2eLogger)==null||o.logE2EEvent(r("RequestStreamE2EClientLoggerMessageType").AMENDMENT,r("RequestStreamE2EClientLoggerEvent").RECEIVED,{data_size:t==null||(a=t.length)==null?void 0:a.toString()},n.auxId)}if(this.canAmend()){if(this.$BladeRunnerSocketStream$p_1.sendAmendment(this.$BladeRunnerSocketStream$p_2.getRequest().streamId,this.$BladeRunnerSocketStream$p_3(t),n==null?null:JSON.stringify(n)),n){var i,l;(i=e.e2eLogger)==null||i.logE2EEvent(r("RequestStreamE2EClientLoggerMessageType").AMENDMENT,r("RequestStreamE2EClientLoggerEvent").SENT,{data_size:t==null||(l=t.length)==null?void 0:l.toString()},n.auxId)}}else{var s;throw(s=e.e2eLogger)==null||s.logE2EEvent(r("RequestStreamE2EClientLoggerMessageType").AMENDMENT,r("RequestStreamE2EClientLoggerEvent").FAILURE,u,n==null?void 0:n.auxId),new Error("Stream is closed or not accepted")}},i.amendWithoutAck=function(t){this.amendFireAndForget(t)},i.$BladeRunnerSocketStream$p_3=function(t){return typeof t=="object"?btoa(new TextDecoder("utf8").decode(t)):t},i.cancel=function(){var e,t=this.$BladeRunnerSocketStream$p_2.getRequest();(e=t.e2eLogger)==null||e.logE2EEvent(r("RequestStreamE2EClientLoggerMessageType").CANCEL,r("RequestStreamE2EClientLoggerEvent").RECEIVED),this.isAlive()&&(this.$BladeRunnerSocketStream$p_1.sendCancel(this.$BladeRunnerSocketStream$p_2.getRequest()),this.$BladeRunnerSocketStream$p_2.setLastStatus(o("BladeRunnerStreamStatus").StreamStatus.CLOSED),this.getStreamHandler().onClientCancel())},i.isAlive=function(){return this.$BladeRunnerSocketStream$p_2.isAlive()},i.canAmend=function(){return this.$BladeRunnerSocketStream$p_2.canAmend()},i.getStatus=function(){return this.$BladeRunnerSocketStream$p_2.getLastStatus()},i.getStreamId=function(){return this.$BladeRunnerSocketStream$p_2.getRequest().streamId},a})(r("BladeRunnerStream"));l.default=c}),98);
__d("RequestStreamE2ESampling",["invariant","Random","RequestStreamE2EClientSamplingConfig","uuidv4"],(function(t,n,r,o,a,i,l,s){"use strict";function e(e){return e==null?!1:e.requestId!=null&&typeof e.requestId=="string"&&e.forceLogContext!=null&&typeof e.forceLogContext=="string"}function u(e,t){var n=r("RequestStreamE2EClientSamplingConfig").sampleRate;if(n>1&&e!=null){var o=r("RequestStreamE2EClientSamplingConfig").methodToSamplingMultiplier[e];o==0?n=0:o!=null&&(n/=o)}return n==1?1:n/t}function c(e,t,n,o){var a=r("uuidv4")();(t.requestId==null||t.requestId===""||typeof t.requestId!="string")&&(e.requestId!=null&&typeof e.requestId=="string"?t.requestId=e.requestId:t.requestId=a),t.requestId+="/_"+a.substring(0,4),t.resumeId="0",n!=null?t.sampleRate=n:t.sampleRate=void 0;var i="";o!=null&&o.length>0&&(i=o),i.length>0&&(t.requestLogContext!=null&&t.requestLogContext.length>0?t.requestLogContext+=":":t.requestLogContext="",t.requestLogContext+=i),(e==null?void 0:e.method)==="Falco"&&(t.clientLoggingDisabled="Falco");var l={};for(var s of Object.keys(t).sort())l[s]=t[s];return JSON.stringify(l)}function d(t,n,o,a){n&&(!n.requestId.includes("/")&&!n.requestId.includes("#")||s(0,41721));var i=u(t.method,a!=null?a:1);return r("Random").coinflip(i)?c(t,n||{requestId:""},i,o):e(n)?c(t,n||{requestId:""},null,o):""}l.isForceLogged=e,l.getSampleRateForLogging=u,l.normalizeInstrumentationData=c,l.validateInstrumentationData=d}),98);
__d("BladeRunnerClient",["Base64","BladeRunnerConfig","BladeRunnerLogger","BladeRunnerSocket","BladeRunnerSocketStream","BladeRunnerTypes","BladeRunnerTypesInternal","RequestStreamE2ELogger","RequestStreamE2ESampling","RequestStreamTransport","cr:2046346"],(function(t,n,r,o,a,i,l){var e=(function(){function e(e,t){this.$2=o("RequestStreamTransport").RequestStreamTransport.WEB_BR_MQTT,this.$1=e!=null?e:r("BladeRunnerSocket").get(),t&&(this.$2=t)}var t=e.prototype;return t.createStream=function(t,n,r,o){return this.$3(t,n,r,o)},t.requestStream=function(t,r,o,a){var e=this.$3(t,r,o,a);return e.send(),n("cr:2046346")!=null&&n("cr:2046346").startPulsarTest(),e},t.logInfo=function(t){r("BladeRunnerLogger").info(t)},t.bumpCounter=function(t){r("BladeRunnerLogger").bumpCounter(t)},t.$3=function(t,n,a,i){var e=new(o("BladeRunnerTypesInternal")).GatewayStreamRequest;return e.streamId=this.$1.getNextStreamId(),e.requestType=o("BladeRunnerTypes").StreamRequestType.BLADE_RUNNER,e.headers=r("BladeRunnerConfig").patchRequestHeaders(t),e.extraHeader=JSON.stringify(e.headers),e.payload=n!=null?r("Base64").encode(n):null,i!=null&&(i.transport="WEB_RS_MQTT"),e.instrumentationData=o("RequestStreamE2ESampling").validateInstrumentationData(e.headers||{},i),e.e2eLogger=o("RequestStreamE2ELogger").createStreamLogger(e.headers,e.instrumentationData,this.$2),new(r("BladeRunnerSocketStream"))(a,e,this.$1)},e})();l.default=e}),98);
__d("BladeRunnerDeferredClient",["Promise","nullthrows","requireDeferred"],(function(t,n,r,o,a,i,l){var e,s=(function(){function t(){this.$1=null}var o=t.prototype;return o.requestStream=function(t,n,o,a){return this.$2(),r("nullthrows")(this.$1).then(function(e){return e.requestStream(t,n,o,a)})},o.logInfo=function(t){return this.$2(),r("nullthrows")(this.$1).then(function(e){e.logInfo(t)})},o.bumpCounter=function(t){return this.$2(),r("nullthrows")(this.$1).then(function(e){e.bumpCounter(t)})},o.$2=function(){this.$1==null&&(this.$1=new(e||(e=n("Promise")))(function(e){r("requireDeferred")("BladeRunnerClient").__setRef("BladeRunnerDeferredClient").onReady(function(t){e(new t)})}))},t})(),u=new s;l.default=u}),98);
__d("BladeRunnerStreamHandler",[],(function(t,n,r,o,a,i){function e(e){throw new TypeError('"'+e+'" is read-only')}var l=(function(){function e(e,t,n,r,o,a){this.$1=e,this.$2=t,this.$3=n||function(e){},this.$4=r||function(e){},this.$5=o||function(e){},this.$6=a}var t=e.prototype;return t.onData=function(t){var e=this.$1,n=this.$2;if(e!=null)e(t.decodeData());else if(n!=null){for(var r=atob(t.rawData()),o=new Uint8Array(r.length),a=0;a<r.length;a++)o[a]=r.charCodeAt(a);n(o.buffer)}},t.onStatusUpdate=function(t){this.$3(t)},t.onLog=function(t){this.$4(t)},t.onBatch=function(t){this.$5(t)},t.onClientCancel=function(){},t.getUpdatedRequestBody=function(){if(this.$6!=null)return this.$6()},e})();i.default=l}),66);
__d("BladeRunnerInstrumentedStreamHandler",["BladeRunnerDeferredClient","BladeRunnerStreamHandler","BladeRunnerStreamStatus","setTimeoutAcrossTransitions"],(function(t,n,r,o,a,i,l){var e=6e4,s=(function(t){function n(n,o){var a;return a=t.call(this)||this,a.$BladeRunnerInstrumentedStreamHandler$p_1=n,a.$BladeRunnerInstrumentedStreamHandler$p_2=o,a.$BladeRunnerInstrumentedStreamHandler$p_3=Date.now(),a.$BladeRunnerInstrumentedStreamHandler$p_5=r("setTimeoutAcrossTransitions")(function(){a.$BladeRunnerInstrumentedStreamHandler$p_4==null&&a.$BladeRunnerInstrumentedStreamHandler$p_6(-1,Date.now())},e),a}babelHelpers.inheritsLoose(n,t);var a=n.prototype;return a.onData=function(t){r("BladeRunnerDeferredClient").bumpCounter("received_data."+this.$BladeRunnerInstrumentedStreamHandler$p_2),this.$BladeRunnerInstrumentedStreamHandler$p_1.onData(t)},a.onStatusUpdate=function(t){this.$BladeRunnerInstrumentedStreamHandler$p_6(t,Date.now()),this.$BladeRunnerInstrumentedStreamHandler$p_1.onStatusUpdate(t)},a.onLog=function(t){this.$BladeRunnerInstrumentedStreamHandler$p_1.onLog(t)},a.onBatch=function(t){this.$BladeRunnerInstrumentedStreamHandler$p_1.onBatch(t)},a.onClientCancel=function(){this.$BladeRunnerInstrumentedStreamHandler$p_6(o("BladeRunnerStreamStatus").StreamStatus.CLOSED,Date.now())},a.$BladeRunnerInstrumentedStreamHandler$p_6=function(t,n){if(r("BladeRunnerDeferredClient").bumpCounter("received_status_"+t+"."+this.$BladeRunnerInstrumentedStreamHandler$p_2),this.$BladeRunnerInstrumentedStreamHandler$p_4==null){this.$BladeRunnerInstrumentedStreamHandler$p_4=n;var e=Math.max(this.$BladeRunnerInstrumentedStreamHandler$p_4-this.$BladeRunnerInstrumentedStreamHandler$p_3,0),o=e>=1e4?Math.round(Math.min(e/1e4,6))*10:Math.round(Math.min(e/1e3,10));r("BladeRunnerDeferredClient").bumpCounter("status_latency."+this.$BladeRunnerInstrumentedStreamHandler$p_2+"."+o+".s")}clearTimeout(this.$BladeRunnerInstrumentedStreamHandler$p_5)},n})(r("BladeRunnerStreamHandler"));l.default=s}),98);
__d("CometEventListener",["FBLogger"],(function(t,n,r,o,a,i,l){"use strict";function e(e,t,n,o){if(e.addEventListener)return e.addEventListener(t,n,o),{remove:function(){e.removeEventListener(t,n,typeof o!="boolean"?o.capture:o)}};throw r("FBLogger")("comet_infra").mustfixThrow('Attempted to listen to eventType "%s" on a target that does not have addEventListener.',t)}var s={addListenerWithOptions:function(n,r,o,a){return e(n,r,o,a)},bubbleWithPassiveFlag:function(n,r,o,a){return e(n,r,o,{capture:!1,passive:a})},capture:function(n,r,o){return e(n,r,o,!0)},captureWithPassiveFlag:function(n,r,o,a){return e(n,r,o,{capture:!0,passive:a})},listen:function(n,r,o){return e(n,r,o,!1)},registerDefault:function(t,n){throw r("FBLogger")("comet_infra").mustfixThrow("EventListener.registerDefault is not implemented.")},suppress:function(t){t.preventDefault(),t.stopPropagation()}};l.default=s}),98);
__d("TWriteBuffer",[],(function(t,n,r,o,a,i){var e=(function(){function e(t){t===void 0&&(t=e.DEFAULT_BYTE_BUFFER_SIZE),this.$1=new DataView(new ArrayBuffer(t)),this.$2=0}var t=e.prototype;return t.write=function(t){this.$2+t.length>this.$1.byteLength&&this.$3(this.$2+t.length);for(var e=0;e<t.length;e++)this.$1.setUint8(this.$2+e,t[e]);return this.$2+=t.length,t.length},t.writeByte=function(t){return this.$2+1>this.$1.byteLength&&this.$3(this.$2+1),this.$1.setUint8(this.$2,t),this.$2++,1},t.writeFloatBE=function(t){return this.$2+Float32Array.BYTES_PER_ELEMENT>this.$1.byteLength&&this.$3(this.$2+Float32Array.BYTES_PER_ELEMENT),this.$1.setFloat32(this.$2,t),this.$2+=Float32Array.BYTES_PER_ELEMENT,Float32Array.BYTES_PER_ELEMENT},t.writeDoubleBE=function(t){return this.$2+Float64Array.BYTES_PER_ELEMENT>this.$1.byteLength&&this.$3(this.$2+Float64Array.BYTES_PER_ELEMENT),this.$1.setFloat64(this.$2,t),this.$2+=Float64Array.BYTES_PER_ELEMENT,Float64Array.BYTES_PER_ELEMENT},t.toByteArray=function(){var e=new Uint8Array(this.$1.buffer,0,this.$2);return e},t.currentSize=function(){return this.$2},t.getUnderlyingDataView=function(){return this.$1},t.$3=function(t){var e=t*2;if(!Number.isSafeInteger(e))throw new Error("unable to resize");for(var n=new DataView(new ArrayBuffer(e)),r=0;r<this.$2;r++)n.setUint8(r,this.$1.getUint8(r));this.$1=n},t.readByte=function(){throw new Error("operation not supported")},t.readBytes=function(t){throw new Error("operation not supported")},t.readFloatBE=function(){throw new Error("operation not supported")},t.readDoubleBE=function(){throw new Error("operation not supported")},e})();e.DEFAULT_BYTE_BUFFER_SIZE=16,i.default=e}),66);
__d("StringToUtf8",["TWriteBuffer"],(function(t,n,r,o,a,i,l){var e=function(t){for(var e=new(r("TWriteBuffer"))(t.length),n,o=0;o<t.length;o++)if(n=t.charCodeAt(o),n<128)e.writeByte(n);else if(n<2048)e.writeByte(n>>6|192),e.writeByte(n&63|128);else if((n&64512)==55296){if(o+1>=t.length)throw new Error("UTF-16 string is truncated: ["+n.toString(16)+"]");if((t.charCodeAt(o+1)&64512)!==56320)throw new Error("Invalid UTF-16 string: ["+n.toString(16)+", "+t.charCodeAt(o+1).toString(16)+"]");n=65536+((n&1023)<<10)+(t.charCodeAt(++o)&1023),e.writeByte(n>>18|240),e.writeByte(n>>12&63|128),e.writeByte(n>>6&63|128),e.writeByte(n&63|128)}else e.writeByte(n>>12|224),e.writeByte(n>>6&63|128),e.writeByte(n&63|128);return e.toByteArray()};l.StringToUtf8=e}),98);
__d("ThriftTypes",[],(function(t,n,r,o,a,i){var e=Object.freeze({STOP:0,VOID:1,BOOL:2,BYTE:3,I08:3,DOUBLE:4,I16:6,I32:8,I64:10,STRING:11,STRUCT:12,MAP:13,SET:14,LIST:15,FLOAT:19}),l=e;i.default=l}),66);
__d("Utf8ToString",[],(function(t,n,r,o,a,i){var e=function(t,n){throw new Error(t+": ["+n.map(function(e){return e.toString(16)}).toString()+"]")},l=function(n){e("Invalid UTF-8 sequence",n)},s=function(n,r){e("Not enough bytes for "+n+"-byte sequence",r)},u=function(t){for(var e=0,n=[];e<t.length;){var r=t[e++];if(r<128)n.push(String.fromCharCode(r));else if(r>=128&&r<194)l([r]);else if(r>=194&&r<224){e>=t.length&&s(2,[r]);var o=t[e++];(o&192)!==128&&l([r,o]),n.push(String.fromCharCode((r&31)<<6|o&63))}else if(r>=240&&r<245){e+2>=t.length&&s(4,[r]);var a=t[e++],i=t[e++],u=t[e++];(r==240&&(!(a>=144&&a<192)||(i&192)!==128||(u&192)!==128)||r>=241&&r<244&&((a&192)!==128||(i&192)!==128||(u&192)!==128)||r==244&&(!(a>=128&&a<144)||(i&192)!==128||(u&192)!==128))&&l([r,a,i,u]);var c=((r&7)<<18|(a&63)<<12|(i&63)<<6|u&63)-65536;n.push(String.fromCharCode(55296+(c>>10))),n.push(String.fromCharCode(56320+(c&1023)))}else if(r>=245)l([r]);else{e+1>=t.length&&s(3,[r]);var d=t[e++],m=t[e++];r==224?d>=160&&d<192||l([r,d,m]):r>=225&&r<237?d>=128&&d<192||l([r,d,m]):r==237?d>=128&&d<160||l([r,d,m]):r>=238&&r<240&&(d>=128&&d<192||l([r,d,m])),m>=128&&m<192||l([r,d,m]),n.push(String.fromCharCode((r&15)<<12|(d&63)<<6|m&63))}}return n.join("")};i.Utf8ToString=u}),66);
__d("jsbi",[],(function(t,n,r,o,a,i){(function(e,t){typeof i=="object"&&typeof a!="undefined"?a.exports=t():typeof define=="function"&&define.amd?define(t):e.JSBI=t()})(this,function(){"use strict";function e(t){return e=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){for(var n,r=0;r<t.length;r++)n=t[r],n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}function r(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}function o(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}function a(e){return a=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},a(e)}function i(e,t){return i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},i(e,t)}function l(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}function s(){return s=l()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var o=Function.bind.apply(e,r),a=new o;return n&&i(a,n.prototype),a},s.apply(null,arguments)}function u(e){return Function.toString.call(e).indexOf("[native code]")!==-1}function c(e){var t=typeof Map=="function"?new Map:void 0;return c=function(e){function n(){return s(e,arguments,a(this).constructor)}if(e===null||!u(e))return e;if(typeof e!="function")throw new TypeError("Super expression must either be null or a function");if(typeof t!="undefined"){if(t.has(e))return t.get(e);t.set(e,n)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),i(n,e)},c(e)}function d(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function m(e,t){return t&&(typeof t=="object"||typeof t=="function")?t:d(e)}var p=(function(n){var i=Math.abs,l=Math.max,s=Math.imul,u=Math.clz32;function c(e,n){var r;if(t(this,c),e>c.__kMaxLength)throw new RangeError("Maximum BigInt size exceeded");return r=m(this,a(c).call(this,e)),r.sign=n,r}return o(c,n),r(c,[{key:"toDebugString",value:function(){var e=["BigInt["],t=!0,n=!1,r=void 0;try{for(var o,a,i=this[Symbol.iterator]();!(t=(o=i.next()).done);t=!0)a=o.value,e.push((a&&(a>>>0).toString(16))+", ")}catch(e){n=!0,r=e}finally{try{t||i.return==null||i.return()}finally{if(n)throw r}}return e.push("]"),e.join("")}},{key:"toString",value:function(){var e=0<arguments.length&&arguments[0]!==void 0?arguments[0]:10;if(2>e||36<e)throw new RangeError("toString() radix argument must be between 2 and 36");return this.length===0?"0":(e&e-1)==0?c.__toStringBasePowerOfTwo(this,e):c.__toStringGeneric(this,e,!1)}},{key:"__copy",value:function(){for(var e=new c(this.length,this.sign),t=0;t<this.length;t++)e[t]=this[t];return e}},{key:"__trim",value:function(){for(var e=this.length,t=this[e-1];t===0;)e--,t=this[e-1],this.pop();return e===0&&(this.sign=!1),this}},{key:"__initializeDigits",value:function(){for(var e=0;e<this.length;e++)this[e]=0}},{key:"__clzmsd",value:function(){return u(this[this.length-1])}},{key:"__inplaceMultiplyAdd",value:function(e,t,n){n>this.length&&(n=this.length);for(var r=65535&e,o=e>>>16,a=0,i=65535&t,l=t>>>16,u=0;u<n;u++){var c=this.__digit(u),d=65535&c,m=c>>>16,p=s(d,r),_=s(d,o),f=s(m,r),g=s(m,o),h=i+(65535&p),y=l+a+(h>>>16)+(p>>>16)+(65535&_)+(65535&f);i=(_>>>16)+(f>>>16)+(65535&g)+(y>>>16),a=i>>>16,i&=65535,l=g>>>16,this.__setDigit(u,65535&h|y<<16)}if(a!==0||i!==0||l!==0)throw new Error("implementation bug")}},{key:"__inplaceAdd",value:function(e,t,n){for(var r,o=0,a=0;a<n;a++)r=this.__halfDigit(t+a)+e.__halfDigit(a)+o,o=r>>>16,this.__setHalfDigit(t+a,r);return o}},{key:"__inplaceSub",value:function(e,t,n){var r=0;if(1&t){t>>=1;for(var o=this.__digit(t),a=65535&o,i=0;i<n-1>>>1;i++){var l=e.__digit(i),s=(o>>>16)-(65535&l)-r;r=1&s>>>16,this.__setDigit(t+i,s<<16|65535&a),o=this.__digit(t+i+1),a=(65535&o)-(l>>>16)-r,r=1&a>>>16}var u=e.__digit(i),c=(o>>>16)-(65535&u)-r;if(r=1&c>>>16,this.__setDigit(t+i,c<<16|65535&a),t+i+1>=this.length)throw new RangeError("out of bounds");(1&n)==0&&(o=this.__digit(t+i+1),a=(65535&o)-(u>>>16)-r,r=1&a>>>16,this.__setDigit(t+e.length,4294901760&o|65535&a))}else{t>>=1;for(var d=0;d<e.length-1;d++){var m=this.__digit(t+d),p=e.__digit(d),_=(65535&m)-(65535&p)-r;r=1&_>>>16;var f=(m>>>16)-(p>>>16)-r;r=1&f>>>16,this.__setDigit(t+d,f<<16|65535&_)}var g=this.__digit(t+d),h=e.__digit(d),y=(65535&g)-(65535&h)-r;r=1&y>>>16;var C=0;(1&n)==0&&(C=(g>>>16)-(h>>>16)-r,r=1&C>>>16),this.__setDigit(t+d,C<<16|65535&y)}return r}},{key:"__inplaceRightShift",value:function(e){if(e!==0){for(var t,n=this.__digit(0)>>>e,r=this.length-1,o=0;o<r;o++)t=this.__digit(o+1),this.__setDigit(o,t<<32-e|n),n=t>>>e;this.__setDigit(r,n)}}},{key:"__digit",value:function(e){return this[e]}},{key:"__unsignedDigit",value:function(e){return this[e]>>>0}},{key:"__setDigit",value:function(e,t){this[e]=0|t}},{key:"__setDigitGrow",value:function(e,t){this[e]=0|t}},{key:"__halfDigitLength",value:function(){var e=this.length;return 65535>=this.__unsignedDigit(e-1)?2*e-1:2*e}},{key:"__halfDigit",value:function(e){return 65535&this[e>>>1]>>>((1&e)<<4)}},{key:"__setHalfDigit",value:function(e,t){var n=e>>>1,r=this.__digit(n),o=1&e?65535&r|t<<16:4294901760&r|65535&t;this.__setDigit(n,o)}}],[{key:"BigInt",value:function(t){var n=Math.floor,r=Number.isFinite;if(typeof t=="number"){if(t===0)return c.__zero();if((0|t)===t)return 0>t?c.__oneDigit(-t,!0):c.__oneDigit(t,!1);if(!r(t)||n(t)!==t)throw new RangeError("The number "+t+" cannot be converted to BigInt because it is not an integer");return c.__fromDouble(t)}if(typeof t=="string"){var o=c.__fromString(t);if(o===null)throw new SyntaxError("Cannot convert "+t+" to a BigInt");return o}if(typeof t=="boolean")return t===!0?c.__oneDigit(1,!1):c.__zero();if(e(t)==="object"){if(t.constructor===c)return t;var a=c.__toPrimitive(t);return c.BigInt(a)}throw new TypeError("Cannot convert "+t+" to a BigInt")}},{key:"toNumber",value:function(e){var t=e.length;if(t===0)return 0;if(t===1){var n=e.__unsignedDigit(0);return e.sign?-n:n}var r=e.__digit(t-1),o=u(r),a=32*t-o;if(1024<a)return e.sign?-1/0:1/0;var i=a-1,l=r,s=t-1,d=o+1,m=d===32?0:l<<d;m>>>=12;var p=d-12,_=12<=d?0:l<<20+d,f=20+d;0<p&&0<s&&(s--,l=e.__digit(s),m|=l>>>32-p,_=l<<p,f=p),0<f&&0<s&&(s--,l=e.__digit(s),_|=l>>>32-f,f-=32);var g=c.__decideRounding(e,f,s,l);if((g===1||g===0&&(1&_)==1)&&(_=_+1>>>0,_===0&&(m++,m>>>20!=0&&(m=0,i++,1023<i))))return e.sign?-1/0:1/0;var h=e.sign?-2147483648:0;return i=i+1023<<20,c.__kBitConversionInts[1]=h|i|m,c.__kBitConversionInts[0]=_,c.__kBitConversionDouble[0]}},{key:"unaryMinus",value:function(e){if(e.length===0)return e;var t=e.__copy();return t.sign=!e.sign,t}},{key:"bitwiseNot",value:function(e){return e.sign?c.__absoluteSubOne(e).__trim():c.__absoluteAddOne(e,!0)}},{key:"exponentiate",value:function(e,t){if(t.sign)throw new RangeError("Exponent must be positive");if(t.length===0)return c.__oneDigit(1,!1);if(e.length===0)return e;if(e.length===1&&e.__digit(0)===1)return e.sign&&(1&t.__digit(0))==0?c.unaryMinus(e):e;if(1<t.length)throw new RangeError("BigInt too big");var n=t.__unsignedDigit(0);if(n===1)return e;if(n>=c.__kMaxLengthBits)throw new RangeError("BigInt too big");if(e.length===1&&e.__digit(0)===2){var r=1+(n>>>5),o=e.sign&&(1&n)!=0,a=new c(r,o);a.__initializeDigits();var i=1<<(31&n);return a.__setDigit(r-1,i),a}var l=null,s=e;for((1&n)!=0&&(l=e),n>>=1;n!==0;n>>=1)s=c.multiply(s,s),(1&n)!=0&&(l===null?l=s:l=c.multiply(l,s));return l}},{key:"multiply",value:function(e,t){if(e.length===0)return e;if(t.length===0)return t;var n=e.length+t.length;32<=e.__clzmsd()+t.__clzmsd()&&n--;var r=new c(n,e.sign!==t.sign);r.__initializeDigits();for(var o=0;o<e.length;o++)c.__multiplyAccumulate(t,e.__digit(o),r,o);return r.__trim()}},{key:"divide",value:function(e,t){if(t.length===0)throw new RangeError("Division by zero");if(0>c.__absoluteCompare(e,t))return c.__zero();var n,r=e.sign!==t.sign,o=t.__unsignedDigit(0);if(t.length===1&&65535>=o){if(o===1)return r===e.sign?e:c.unaryMinus(e);n=c.__absoluteDivSmall(e,o,null)}else n=c.__absoluteDivLarge(e,t,!0,!1);return n.sign=r,n.__trim()}},{key:"remainder",value:function(t,n){if(n.length===0)throw new RangeError("Division by zero");if(0>c.__absoluteCompare(t,n))return t;var e=n.__unsignedDigit(0);if(n.length===1&&65535>=e){if(e===1)return c.__zero();var r=c.__absoluteModSmall(t,e);return r===0?c.__zero():c.__oneDigit(r,t.sign)}var o=c.__absoluteDivLarge(t,n,!1,!0);return o.sign=t.sign,o.__trim()}},{key:"add",value:function(e,t){var n=e.sign;return n===t.sign?c.__absoluteAdd(e,t,n):0<=c.__absoluteCompare(e,t)?c.__absoluteSub(e,t,n):c.__absoluteSub(t,e,!n)}},{key:"subtract",value:function(e,t){var n=e.sign;return n===t.sign?0<=c.__absoluteCompare(e,t)?c.__absoluteSub(e,t,n):c.__absoluteSub(t,e,!n):c.__absoluteAdd(e,t,n)}},{key:"leftShift",value:function(e,t){return t.length===0||e.length===0?e:t.sign?c.__rightShiftByAbsolute(e,t):c.__leftShiftByAbsolute(e,t)}},{key:"signedRightShift",value:function(e,t){return t.length===0||e.length===0?e:t.sign?c.__leftShiftByAbsolute(e,t):c.__rightShiftByAbsolute(e,t)}},{key:"unsignedRightShift",value:function(){throw new TypeError("BigInts have no unsigned right shift; use >> instead")}},{key:"lessThan",value:function(e,t){return 0>c.__compareToBigInt(e,t)}},{key:"lessThanOrEqual",value:function(e,t){return 0>=c.__compareToBigInt(e,t)}},{key:"greaterThan",value:function(e,t){return 0<c.__compareToBigInt(e,t)}},{key:"greaterThanOrEqual",value:function(e,t){return 0<=c.__compareToBigInt(e,t)}},{key:"equal",value:function(e,t){if(e.sign!==t.sign||e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e.__digit(n)!==t.__digit(n))return!1;return!0}},{key:"notEqual",value:function(e,t){return!c.equal(e,t)}},{key:"bitwiseAnd",value:function(e,t){if(!e.sign&&!t.sign)return c.__absoluteAnd(e,t).__trim();if(e.sign&&t.sign){var n=l(e.length,t.length)+1,r=c.__absoluteSubOne(e,n),o=c.__absoluteSubOne(t);return r=c.__absoluteOr(r,o,r),c.__absoluteAddOne(r,!0,r).__trim()}if(e.sign){var a=[t,e];e=a[0],t=a[1]}return c.__absoluteAndNot(e,c.__absoluteSubOne(t)).__trim()}},{key:"bitwiseXor",value:function(e,t){if(!e.sign&&!t.sign)return c.__absoluteXor(e,t).__trim();if(e.sign&&t.sign){var n=l(e.length,t.length),r=c.__absoluteSubOne(e,n),o=c.__absoluteSubOne(t);return c.__absoluteXor(r,o,r).__trim()}var a=l(e.length,t.length)+1;if(e.sign){var i=[t,e];e=i[0],t=i[1]}var s=c.__absoluteSubOne(t,a);return s=c.__absoluteXor(s,e,s),c.__absoluteAddOne(s,!0,s).__trim()}},{key:"bitwiseOr",value:function(e,t){var n=l(e.length,t.length);if(!e.sign&&!t.sign)return c.__absoluteOr(e,t).__trim();if(e.sign&&t.sign){var r=c.__absoluteSubOne(e,n),o=c.__absoluteSubOne(t);return r=c.__absoluteAnd(r,o,r),c.__absoluteAddOne(r,!0,r).__trim()}if(e.sign){var a=[t,e];e=a[0],t=a[1]}var i=c.__absoluteSubOne(t,n);return i=c.__absoluteAndNot(i,e,i),c.__absoluteAddOne(i,!0,i).__trim()}},{key:"asIntN",value:function(e,t){if(t.length===0)return t;if(e===0)return c.__zero();if(e>=c.__kMaxLengthBits)return t;var n=e+31>>>5;if(t.length<n)return t;var r=t.__unsignedDigit(n-1),o=1<<(31&e-1);if(t.length===n&&r<o)return t;if((r&o)!==o)return c.__truncateToNBits(e,t);if(!t.sign)return c.__truncateAndSubFromPowerOfTwo(e,t,!0);if((r&o-1)==0){for(var a=n-2;0<=a;a--)if(t.__digit(a)!==0)return c.__truncateAndSubFromPowerOfTwo(e,t,!1);return t.length===n&&r===o?t:c.__truncateToNBits(e,t)}return c.__truncateAndSubFromPowerOfTwo(e,t,!1)}},{key:"asUintN",value:function(e,t){if(t.length===0)return t;if(e===0)return c.__zero();if(t.sign){if(e>c.__kMaxLengthBits)throw new RangeError("BigInt too big");return c.__truncateAndSubFromPowerOfTwo(e,t,!1)}if(e>=c.__kMaxLengthBits)return t;var n=e+31>>>5;if(t.length<n)return t;var r=31&e;if(t.length==n){if(r==0)return t;var o=t.__digit(n-1);if(!(o>>>r))return t}return c.__truncateToNBits(e,t)}},{key:"ADD",value:function(e,t){if(e=c.__toPrimitive(e),t=c.__toPrimitive(t),typeof e=="string")return typeof t!="string"&&(t=t.toString()),e+t;if(typeof t=="string")return e.toString()+t;if(e=c.__toNumeric(e),t=c.__toNumeric(t),c.__isBigInt(e)&&c.__isBigInt(t))return c.add(e,t);if(typeof e=="number"&&typeof t=="number")return e+t;throw new TypeError("Cannot mix BigInt and other types, use explicit conversions")}},{key:"LT",value:function(e,t){return c.__compare(e,t,0)}},{key:"LE",value:function(e,t){return c.__compare(e,t,1)}},{key:"GT",value:function(e,t){return c.__compare(e,t,2)}},{key:"GE",value:function(e,t){return c.__compare(e,t,3)}},{key:"EQ",value:function(t,n){for(;;){if(c.__isBigInt(t))return c.__isBigInt(n)?c.equal(t,n):c.EQ(n,t);if(typeof t=="number"){if(c.__isBigInt(n))return c.__equalToNumber(n,t);if(e(n)!=="object")return t==n;n=c.__toPrimitive(n)}else if(typeof t=="string"){if(c.__isBigInt(n))return t=c.__fromString(t),t!==null&&c.equal(t,n);if(e(n)!=="object")return t==n;n=c.__toPrimitive(n)}else if(typeof t=="boolean"){if(c.__isBigInt(n))return c.__equalToNumber(n,+t);if(e(n)!=="object")return t==n;n=c.__toPrimitive(n)}else if(e(t)==="symbol"){if(c.__isBigInt(n))return!1;if(e(n)!=="object")return t==n;n=c.__toPrimitive(n)}else if(e(t)==="object"){if(e(n)==="object"&&n.constructor!==c)return t==n;t=c.__toPrimitive(t)}else return t==n}}},{key:"NE",value:function(e,t){return!c.EQ(e,t)}},{key:"__zero",value:function(){return new c(0,!1)}},{key:"__oneDigit",value:function(e,t){var n=new c(1,t);return n.__setDigit(0,e),n}},{key:"__decideRounding",value:function(e,t,n,r){if(0<t)return-1;var o;if(0>t)o=-t-1;else{if(n===0)return-1;n--,r=e.__digit(n),o=31}var a=1<<o;if((r&a)==0)return-1;if(a-=1,(r&a)!=0)return 1;for(;0<n;)if(n--,e.__digit(n)!==0)return 1;return 0}},{key:"__fromDouble",value:function(e){c.__kBitConversionDouble[0]=e;var t,n=2047&c.__kBitConversionInts[1]>>>20,r=n-1023,o=(r>>>5)+1,a=new c(o,0>e),i=1048575&c.__kBitConversionInts[1]|1048576,l=c.__kBitConversionInts[0],s=20,u=31&r,d=0;if(u<s){var m=s-u;d=m+32,t=i>>>m,i=i<<32-m|l>>>m,l<<=32-m}else if(u===s)d=32,t=i,i=l;else{var p=u-s;d=32-p,t=i<<p|l>>>32-p,i=l<<p}a.__setDigit(o-1,t);for(var _=o-2;0<=_;_--)0<d?(d-=32,t=i,i=l):t=0,a.__setDigit(_,t);return a.__trim()}},{key:"__isWhitespace",value:function(e){return 13>=e&&9<=e||(159>=e?e==32:131071>=e?e==160||e==5760:196607>=e?(e&=131071,10>=e||e==40||e==41||e==47||e==95||e==4096):e==65279)}},{key:"__fromString",value:function(e){var t=1<arguments.length&&arguments[1]!==void 0?arguments[1]:0,n=0,r=e.length,o=0;if(o===r)return c.__zero();for(var a=e.charCodeAt(o);c.__isWhitespace(a);){if(++o===r)return c.__zero();a=e.charCodeAt(o)}if(a===43){if(++o===r)return null;a=e.charCodeAt(o),n=1}else if(a===45){if(++o===r)return null;a=e.charCodeAt(o),n=-1}if(t===0){if(t=10,a===48){if(++o===r)return c.__zero();if(a=e.charCodeAt(o),a===88||a===120){if(t=16,++o===r)return null;a=e.charCodeAt(o)}else if(a===79||a===111){if(t=8,++o===r)return null;a=e.charCodeAt(o)}else if(a===66||a===98){if(t=2,++o===r)return null;a=e.charCodeAt(o)}}}else if(t===16&&a===48){if(++o===r)return c.__zero();if(a=e.charCodeAt(o),a===88||a===120){if(++o===r)return null;a=e.charCodeAt(o)}}for(;a===48;){if(++o===r)return c.__zero();a=e.charCodeAt(o)}var i=r-o,l=c.__kMaxBitsPerChar[t],s=c.__kBitsPerCharTableMultiplier-1;if(i>1073741824/l)return null;var u=l*i+s>>>c.__kBitsPerCharTableShift,d=new c(u+31>>>5,!1),m=10>t?t:10,p=10<t?t-10:0;if((t&t-1)==0){l>>=c.__kBitsPerCharTableShift;var _=[],f=[],g=!1;do{for(var h,y=0,C=0;;){if(h=void 0,a-48>>>0<m)h=a-48;else if((32|a)-97>>>0<p)h=(32|a)-87;else{g=!0;break}if(C+=l,y=y<<l|h,++o===r){g=!0;break}if(a=e.charCodeAt(o),32<C+l)break}_.push(y),f.push(C)}while(!g);c.__fillFromParts(d,_,f)}else{d.__initializeDigits();var b=!1,v=0;do{for(var S,R=0,L=1;;){if(S=void 0,a-48>>>0<m)S=a-48;else if((32|a)-97>>>0<p)S=(32|a)-87;else{b=!0;break}var E=L*t;if(4294967295<E)break;if(L=E,R=R*t+S,v++,++o===r){b=!0;break}a=e.charCodeAt(o)}s=32*c.__kBitsPerCharTableMultiplier-1;var k=l*v+s>>>c.__kBitsPerCharTableShift+5;d.__inplaceMultiplyAdd(L,R,k)}while(!b)}if(o!==r){if(!c.__isWhitespace(a))return null;for(o++;o<r;o++)if(a=e.charCodeAt(o),!c.__isWhitespace(a))return null}return n!==0&&t!==10?null:(d.sign=n===-1,d.__trim())}},{key:"__fillFromParts",value:function(e,t,n){for(var r=0,o=0,a=0,i=t.length-1;0<=i;i--){var l=t[i],s=n[i];o|=l<<a,a+=s,a===32?(e.__setDigit(r++,o),a=0,o=0):32<a&&(e.__setDigit(r++,o),a-=32,o=l>>>s-a)}if(o!==0){if(r>=e.length)throw new Error("implementation bug");e.__setDigit(r++,o)}for(;r<e.length;r++)e.__setDigit(r,0)}},{key:"__toStringBasePowerOfTwo",value:function(e,t){var n=e.length,r=t-1;r=(85&r>>>1)+(85&r),r=(51&r>>>2)+(51&r),r=(15&r>>>4)+(15&r);var o=r,a=t-1,i=e.__digit(n-1),l=u(i),s=0|(32*n-l+o-1)/o;if(e.sign&&s++,268435456<s)throw new Error("string too long");for(var d=Array(s),m=s-1,p=0,_=0,f=0;f<n-1;f++){var g=e.__digit(f),h=(p|g<<_)&a;d[m--]=c.__kConversionChars[h];var y=o-_;for(p=g>>>y,_=32-y;_>=o;)d[m--]=c.__kConversionChars[p&a],p>>>=o,_-=o}var C=(p|i<<_)&a;for(d[m--]=c.__kConversionChars[C],p=i>>>o-_;p!==0;)d[m--]=c.__kConversionChars[p&a],p>>>=o;if(e.sign&&(d[m--]="-"),m!==-1)throw new Error("implementation bug");return d.join("")}},{key:"__toStringGeneric",value:function(e,t,n){var r=e.length;if(r===0)return"";if(r===1){var o=e.__unsignedDigit(0).toString(t);return n===!1&&e.sign&&(o="-"+o),o}var a=32*r-u(e.__digit(r-1)),i=c.__kMaxBitsPerChar[t],l=i-1,s=a*c.__kBitsPerCharTableMultiplier;s+=l-1,s=0|s/l;var d,m,p=s+1>>1,_=c.exponentiate(c.__oneDigit(t,!1),c.__oneDigit(p,!1)),f=_.__unsignedDigit(0);if(_.length===1&&65535>=f){d=new c(e.length,!1),d.__initializeDigits();for(var g,h=0,y=2*e.length-1;0<=y;y--)g=h<<16|e.__halfDigit(y),d.__setHalfDigit(y,0|g/f),h=0|g%f;m=h.toString(t)}else{var C=c.__absoluteDivLarge(e,_,!0,!0);d=C.quotient;var b=C.remainder.__trim();m=c.__toStringGeneric(b,t,!0)}d.__trim();for(var v=c.__toStringGeneric(d,t,!0);m.length<p;)m="0"+m;return n===!1&&e.sign&&(v="-"+v),v+m}},{key:"__unequalSign",value:function(e){return e?-1:1}},{key:"__absoluteGreater",value:function(e){return e?-1:1}},{key:"__absoluteLess",value:function(e){return e?1:-1}},{key:"__compareToBigInt",value:function(e,t){var n=e.sign;if(n!==t.sign)return c.__unequalSign(n);var r=c.__absoluteCompare(e,t);return 0<r?c.__absoluteGreater(n):0>r?c.__absoluteLess(n):0}},{key:"__compareToNumber",value:function(e,t){if(!0|t){var n=e.sign,r=0>t;if(n!==r)return c.__unequalSign(n);if(e.length===0){if(r)throw new Error("implementation bug");return t===0?0:-1}if(1<e.length)return c.__absoluteGreater(n);var o=i(t),a=e.__unsignedDigit(0);return a>o?c.__absoluteGreater(n):a<o?c.__absoluteLess(n):0}return c.__compareToDouble(e,t)}},{key:"__compareToDouble",value:function(e,t){if(t!==t)return t;if(t===1/0)return-1;if(t===-1/0)return 1;var n=e.sign;if(n!==0>t)return c.__unequalSign(n);if(t===0)throw new Error("implementation bug: should be handled elsewhere");if(e.length===0)return-1;c.__kBitConversionDouble[0]=t;var r=2047&c.__kBitConversionInts[1]>>>20;if(r==2047)throw new Error("implementation bug: handled elsewhere");var o=r-1023;if(0>o)return c.__absoluteGreater(n);var a=e.length,i=e.__digit(a-1),l=u(i),s=32*a-l,d=o+1;if(s<d)return c.__absoluteLess(n);if(s>d)return c.__absoluteGreater(n);var m=1048576|1048575&c.__kBitConversionInts[1],p=c.__kBitConversionInts[0],_=20,f=31-l;if(f!==(s-1)%31)throw new Error("implementation bug");var g,h=0;if(f<_){var y=_-f;h=y+32,g=m>>>y,m=m<<32-y|p>>>y,p<<=32-y}else if(f===_)h=32,g=m,m=p;else{var C=f-_;h=32-C,g=m<<C|p>>>32-C,m=p<<C}if(i>>>=0,g>>>=0,i>g)return c.__absoluteGreater(n);if(i<g)return c.__absoluteLess(n);for(var b=a-2;0<=b;b--){0<h?(h-=32,g=m>>>0,m=p,p=0):g=0;var v=e.__unsignedDigit(b);if(v>g)return c.__absoluteGreater(n);if(v<g)return c.__absoluteLess(n)}if(m!==0||p!==0){if(h===0)throw new Error("implementation bug");return c.__absoluteLess(n)}return 0}},{key:"__equalToNumber",value:function(e,t){return t|t===0?t===0?e.length===0:e.length===1&&e.sign===0>t&&e.__unsignedDigit(0)===i(t):c.__compareToDouble(e,t)===0}},{key:"__comparisonResultToBool",value:function(e,t){switch(t){case 0:return 0>e;case 1:return 0>=e;case 2:return 0<e;case 3:return 0<=e}throw new Error("unreachable")}},{key:"__compare",value:function(e,t,n){if(e=c.__toPrimitive(e),t=c.__toPrimitive(t),typeof e=="string"&&typeof t=="string")switch(n){case 0:return e<t;case 1:return e<=t;case 2:return e>t;case 3:return e>=t}if(c.__isBigInt(e)&&typeof t=="string")return t=c.__fromString(t),t!==null&&c.__comparisonResultToBool(c.__compareToBigInt(e,t),n);if(typeof e=="string"&&c.__isBigInt(t))return e=c.__fromString(e),e!==null&&c.__comparisonResultToBool(c.__compareToBigInt(e,t),n);if(e=c.__toNumeric(e),t=c.__toNumeric(t),c.__isBigInt(e)){if(c.__isBigInt(t))return c.__comparisonResultToBool(c.__compareToBigInt(e,t),n);if(typeof t!="number")throw new Error("implementation bug");return c.__comparisonResultToBool(c.__compareToNumber(e,t),n)}if(typeof e!="number")throw new Error("implementation bug");if(c.__isBigInt(t))return c.__comparisonResultToBool(c.__compareToNumber(t,e),2^n);if(typeof t!="number")throw new Error("implementation bug");return n===0?e<t:n===1?e<=t:n===2?e>t:n===3?e>=t:void 0}},{key:"__absoluteAdd",value:function(e,t,n){if(e.length<t.length)return c.__absoluteAdd(t,e,n);if(e.length===0)return e;if(t.length===0)return e.sign===n?e:c.unaryMinus(e);var r=e.length;(e.__clzmsd()===0||t.length===e.length&&t.__clzmsd()===0)&&r++;for(var o=new c(r,n),a=0,i=0;i<t.length;i++){var l=t.__digit(i),s=e.__digit(i),u=(65535&s)+(65535&l)+a,d=(s>>>16)+(l>>>16)+(u>>>16);a=d>>>16,o.__setDigit(i,65535&u|d<<16)}for(;i<e.length;i++){var m=e.__digit(i),p=(65535&m)+a,_=(m>>>16)+(p>>>16);a=_>>>16,o.__setDigit(i,65535&p|_<<16)}return i<o.length&&o.__setDigit(i,a),o.__trim()}},{key:"__absoluteSub",value:function(e,t,n){if(e.length===0)return e;if(t.length===0)return e.sign===n?e:c.unaryMinus(e);for(var r=new c(e.length,n),o=0,a=0;a<t.length;a++){var i=e.__digit(a),l=t.__digit(a),s=(65535&i)-(65535&l)-o;o=1&s>>>16;var u=(i>>>16)-(l>>>16)-o;o=1&u>>>16,r.__setDigit(a,65535&s|u<<16)}for(;a<e.length;a++){var d=e.__digit(a),m=(65535&d)-o;o=1&m>>>16;var p=(d>>>16)-o;o=1&p>>>16,r.__setDigit(a,65535&m|p<<16)}return r.__trim()}},{key:"__absoluteAddOne",value:function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null,r=e.length;n===null?n=new c(r,t):n.sign=t;for(var o=!0,a=0;a<r;a++){var i=e.__digit(a),l=i===-1;o&&(i=0|i+1),o=l,n.__setDigit(a,i)}return o&&n.__setDigitGrow(r,1),n}},{key:"__absoluteSubOne",value:function(e,t){var n=e.length;t=t||n;for(var r=new c(t,!1),o=!0,a=0;a<n;a++){var i=e.__digit(a),l=i===0;o&&(i=0|i-1),o=l,r.__setDigit(a,i)}for(var s=n;s<t;s++)r.__setDigit(s,0);return r}},{key:"__absoluteAnd",value:function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null,r=e.length,o=t.length,a=o;if(r<o){a=r;var i=e,l=r;e=t,r=o,t=i,o=l}var s=a;n===null?n=new c(s,!1):s=n.length;for(var u=0;u<a;u++)n.__setDigit(u,e.__digit(u)&t.__digit(u));for(;u<s;u++)n.__setDigit(u,0);return n}},{key:"__absoluteAndNot",value:function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null,r=e.length,o=t.length,a=o;r<o&&(a=r);var i=r;n===null?n=new c(i,!1):i=n.length;for(var l=0;l<a;l++)n.__setDigit(l,e.__digit(l)&~t.__digit(l));for(;l<r;l++)n.__setDigit(l,e.__digit(l));for(;l<i;l++)n.__setDigit(l,0);return n}},{key:"__absoluteOr",value:function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null,r=e.length,o=t.length,a=o;if(r<o){a=r;var i=e,l=r;e=t,r=o,t=i,o=l}var s=r;n===null?n=new c(s,!1):s=n.length;for(var u=0;u<a;u++)n.__setDigit(u,e.__digit(u)|t.__digit(u));for(;u<r;u++)n.__setDigit(u,e.__digit(u));for(;u<s;u++)n.__setDigit(u,0);return n}},{key:"__absoluteXor",value:function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null,r=e.length,o=t.length,a=o;if(r<o){a=r;var i=e,l=r;e=t,r=o,t=i,o=l}var s=r;n===null?n=new c(s,!1):s=n.length;for(var u=0;u<a;u++)n.__setDigit(u,e.__digit(u)^t.__digit(u));for(;u<r;u++)n.__setDigit(u,e.__digit(u));for(;u<s;u++)n.__setDigit(u,0);return n}},{key:"__absoluteCompare",value:function(e,t){var n=e.length-t.length;if(n!=0)return n;for(var r=e.length-1;0<=r&&e.__digit(r)===t.__digit(r);)r--;return 0>r?0:e.__unsignedDigit(r)>t.__unsignedDigit(r)?1:-1}},{key:"__multiplyAccumulate",value:function(e,t,n,r){if(t!==0){for(var o=65535&t,a=t>>>16,i=0,l=0,u=0,c=0;c<e.length;c++,r++){var d=n.__digit(r),m=65535&d,p=d>>>16,_=e.__digit(c),f=65535&_,g=_>>>16,h=s(f,o),y=s(f,a),C=s(g,o),b=s(g,a);m+=l+(65535&h),p+=u+i+(m>>>16)+(h>>>16)+(65535&y)+(65535&C),i=p>>>16,l=(y>>>16)+(C>>>16)+(65535&b)+i,i=l>>>16,l&=65535,u=b>>>16,d=65535&m|p<<16,n.__setDigit(r,d)}for(;i!==0||l!==0||u!==0;r++){var v=n.__digit(r),S=(65535&v)+l,R=(v>>>16)+(S>>>16)+u+i;l=0,u=0,i=R>>>16,v=65535&S|R<<16,n.__setDigit(r,v)}}}},{key:"__internalMultiplyAdd",value:function(e,t,n,r,o){for(var a=n,i=0,l=0;l<r;l++){var u=e.__digit(l),c=s(65535&u,t),d=(65535&c)+i+a;a=d>>>16;var m=s(u>>>16,t),p=(65535&m)+(c>>>16)+a;a=p>>>16,i=m>>>16,o.__setDigit(l,p<<16|65535&d)}if(o.length>r)for(o.__setDigit(r++,a+i);r<o.length;)o.__setDigit(r++,0);else if(a+i!==0)throw new Error("implementation bug")}},{key:"__absoluteDivSmall",value:function(e,t,n){n===null&&(n=new c(e.length,!1));for(var r=0,o=2*e.length-1;0<=o;o-=2){var a=(r<<16|e.__halfDigit(o))>>>0,i=0|a/t;r=0|a%t,a=(r<<16|e.__halfDigit(o-1))>>>0;var l=0|a/t;r=0|a%t,n.__setDigit(o>>>1,i<<16|l)}return n}},{key:"__absoluteModSmall",value:function(e,t){for(var n,r=0,o=2*e.length-1;0<=o;o--)n=(r<<16|e.__halfDigit(o))>>>0,r=0|n%t;return r}},{key:"__absoluteDivLarge",value:function(e,t,n,r){var o=t.__halfDigitLength(),a=t.length,i=e.__halfDigitLength()-o,l=null;n&&(l=new c(i+2>>>1,!1),l.__initializeDigits());var u=new c(o+2>>>1,!1);u.__initializeDigits();var d=c.__clz16(t.__halfDigit(o-1));0<d&&(t=c.__specialLeftShift(t,d,0));for(var m=c.__specialLeftShift(e,d,1),p=t.__halfDigit(o-1),_=0,f=i;0<=f;f--){var g=65535,h=m.__halfDigit(f+o);if(h!==p){var y=(h<<16|m.__halfDigit(f+o-1))>>>0;g=0|y/p;for(var C=0|y%p,b=t.__halfDigit(o-2),v=m.__halfDigit(f+o-2);s(g,b)>>>0>(C<<16|v)>>>0&&(g--,C+=p,!(65535<C)););}c.__internalMultiplyAdd(t,g,0,a,u);var S=m.__inplaceSub(u,f,o+1);S!==0&&(S=m.__inplaceAdd(t,f,o),m.__setHalfDigit(f+o,m.__halfDigit(f+o)+S),g--),n&&(1&f?_=g<<16:l.__setDigit(f>>>1,_|g))}return r?(m.__inplaceRightShift(d),n?{quotient:l,remainder:m}:m):n?l:void 0}},{key:"__clz16",value:function(e){return u(e)-16}},{key:"__specialLeftShift",value:function(e,t,n){var r=e.length,o=new c(r+n,!1);if(t===0){for(var a=0;a<r;a++)o.__setDigit(a,e.__digit(a));return 0<n&&o.__setDigit(r,0),o}for(var i,l=0,s=0;s<r;s++)i=e.__digit(s),o.__setDigit(s,i<<t|l),l=i>>>32-t;return 0<n&&o.__setDigit(r,l),o}},{key:"__leftShiftByAbsolute",value:function(e,t){var n=c.__toShiftAmount(t);if(0>n)throw new RangeError("BigInt too big");var r=n>>>5,o=31&n,a=e.length,i=o!==0&&e.__digit(a-1)>>>32-o!=0,l=a+r+(i?1:0),s=new c(l,e.sign);if(o===0){for(var u=0;u<r;u++)s.__setDigit(u,0);for(;u<l;u++)s.__setDigit(u,e.__digit(u-r))}else{for(var d=0,m=0;m<r;m++)s.__setDigit(m,0);for(var p,_=0;_<a;_++)p=e.__digit(_),s.__setDigit(_+r,p<<o|d),d=p>>>32-o;if(i)s.__setDigit(a+r,d);else if(d!==0)throw new Error("implementation bug")}return s.__trim()}},{key:"__rightShiftByAbsolute",value:function(e,t){var n=e.length,r=e.sign,o=c.__toShiftAmount(t);if(0>o)return c.__rightShiftByMaximum(r);var a=o>>>5,i=31&o,l=n-a;if(0>=l)return c.__rightShiftByMaximum(r);var s=!1;if(r){if((e.__digit(a)&(1<<i)-1)!=0)s=!0;else for(var u=0;u<a;u++)if(e.__digit(u)!==0){s=!0;break}}if(s&&i===0){var d=e.__digit(n-1);~d==0&&l++}var m=new c(l,r);if(i===0)for(var p=a;p<n;p++)m.__setDigit(p-a,e.__digit(p));else{for(var _,f=e.__digit(a)>>>i,g=n-a-1,h=0;h<g;h++)_=e.__digit(h+a+1),m.__setDigit(h,_<<32-i|f),f=_>>>i;m.__setDigit(g,f)}return s&&(m=c.__absoluteAddOne(m,!0,m)),m.__trim()}},{key:"__rightShiftByMaximum",value:function(e){return e?c.__oneDigit(1,!0):c.__zero()}},{key:"__toShiftAmount",value:function(e){if(1<e.length)return-1;var t=e.__unsignedDigit(0);return t>c.__kMaxLengthBits?-1:t}},{key:"__toPrimitive",value:function(t){var n=1<arguments.length&&arguments[1]!==void 0?arguments[1]:"default";if(e(t)!=="object"||t.constructor===c)return t;var r=t[Symbol.toPrimitive];if(r){var o=r(n);if(e(o)!=="object")return o;throw new TypeError("Cannot convert object to primitive value")}var a=t.valueOf;if(a){var i=a.call(t);if(e(i)!=="object")return i}var l=t.toString;if(l){var s=l.call(t);if(e(s)!=="object")return s}throw new TypeError("Cannot convert object to primitive value")}},{key:"__toNumeric",value:function(e){return c.__isBigInt(e)?e:+e}},{key:"__isBigInt",value:function(t){return e(t)==="object"&&t.constructor===c}},{key:"__truncateToNBits",value:function(e,t){for(var n=e+31>>>5,r=new c(n,t.sign),o=n-1,a=0;a<o;a++)r.__setDigit(a,t.__digit(a));var i=t.__digit(o);if((31&e)!=0){var l=32-(31&e);i=i<<l>>>l}return r.__setDigit(o,i),r.__trim()}},{key:"__truncateAndSubFromPowerOfTwo",value:function(e,t,n){for(var r=Math.min,o=e+31>>>5,a=new c(o,n),i=0,l=o-1,s=0,u=r(l,t.length);i<u;i++){var d=t.__digit(i),m=0-(65535&d)-s;s=1&m>>>16;var p=0-(d>>>16)-s;s=1&p>>>16,a.__setDigit(i,65535&m|p<<16)}for(;i<l;i++)a.__setDigit(i,0|-s);var _,f=l<t.length?t.__digit(l):0,g=31&e;if(g===0){var h=0-(65535&f)-s;s=1&h>>>16;var y=0-(f>>>16)-s;_=65535&h|y<<16}else{var C=32-g;f=f<<C>>>C;var b=1<<32-C,v=(65535&b)-(65535&f)-s;s=1&v>>>16;var S=(b>>>16)-(f>>>16)-s;_=65535&v|S<<16,_&=b-1}return a.__setDigit(l,_),a.__trim()}},{key:"__digitPow",value:function(e,t){for(var n=1;0<t;)1&t&&(n*=e),t>>>=1,e*=e;return n}}]),c})(c(Array));return p.__kMaxLength=33554432,p.__kMaxLengthBits=p.__kMaxLength<<5,p.__kMaxBitsPerChar=[0,0,32,51,64,75,83,90,96,102,107,111,115,119,122,126,128,131,134,136,139,141,143,145,147,149,151,153,154,156,158,159,160,162,163,165,166],p.__kBitsPerCharTableShift=5,p.__kBitsPerCharTableMultiplier=1<<p.__kBitsPerCharTableShift,p.__kConversionChars=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],p.__kBitConversionBuffer=new ArrayBuffer(8),p.__kBitConversionDouble=new Float64Array(p.__kBitConversionBuffer),p.__kBitConversionInts=new Int32Array(p.__kBitConversionBuffer),p})}),null);
__d("TCompactProtocolPolyfill",["StringToUtf8","ThriftTypes","Utf8ToString","jsbi"],(function(t,n,r,o,a,i,l){var e,s,u=Object.freeze({CT_STOP:0,CT_BOOLEAN_TRUE:1,CT_BOOLEAN_FALSE:2,CT_BYTE:3,CT_I16:4,CT_I32:5,CT_I64:6,CT_DOUBLE:7,CT_BINARY:8,CT_LIST:9,CT_SET:10,CT_MAP:11,CT_STRUCT:12,CT_FLOAT:13}),c=Object.freeze({NONE:-1,CT_BOOLEAN_TRUE:u.CT_BOOLEAN_TRUE,CT_BOOLEAN_FALSE:u.CT_BOOLEAN_FALSE}),d=[u.CT_STOP,0,u.CT_BOOLEAN_TRUE,u.CT_BYTE,u.CT_DOUBLE,0,u.CT_I16,0,u.CT_I32,0,u.CT_I64,u.CT_BINARY,u.CT_STRUCT,u.CT_MAP,u.CT_SET,u.CT_LIST,0,0,0,u.CT_FLOAT],m=Math.pow(2,7)-1,p=-1*Math.pow(2,7),_=Math.pow(2,15)-1,f=-1*Math.pow(2,15),g=Math.pow(2,31)-1,h=-1*Math.pow(2,31),y=Math.pow(2,32)-1,C=(s=r("jsbi")).BigInt("9223372036854775807"),b=s.BigInt("-9223372036854775808"),v=s.BigInt("18446744073709551615"),S=s.BigInt(63),R=s.BigInt(1),L=s.BigInt(0),E=s.BigInt(7),k=s.BigInt(70),I=s.BigInt(127),T=s.BigInt(128),D=Math.pow(2,4),x=(function(){function t(e){this.$4=null,this.$5=null,this.$1=e,this.$2=[],this.$3=0,this.$6=new DataView(new ArrayBuffer(1))}var n=t.prototype;return n.readStructBegin=function(){this.$2.push(this.$3),this.$3=0},n.readStructEnd=function(){return this.$3=this.$2.pop(),0},n.writeStructBegin=function(t){return this.$2.push(this.$3),this.$3=0,0},n.writeStructEnd=function(){return this.$3=this.$2.pop(),0},n.writeFieldBegin=function(n){return n.ftype===(e||(e=r("ThriftTypes"))).BOOL?(this.$4={fid:n.fid,fname:n.fname,ftype:n.ftype},0):this.$7(n,c.NONE)},n.writeListBegin=function(t){return this.$8(t)},n.writeListEnd=function(){return 0},n.writeSetBegin=function(t){return this.$8(t)},n.writeSetEnd=function(){return 0},n.writeMapBegin=function(t){var e=0;if(t.size===0)e+=this.$1.writeByte(0);else if(e+=this.writeVarint32(t.size),t.ktype!=null&&t.vtype!=null)e+=this.$1.writeByte(this.$9(t.ktype)<<4|this.$9(t.vtype));else throw new Error("received invalid map info: "+JSON.stringify(t));return e},n.writeMapEnd=function(){return 0},n.$7=function(t,n){var e=0,r=n===c.NONE?this.$9(t.ftype):n;return t.fid>this.$3&&t.fid-this.$3<=D-1?e+=this.$1.writeByte(t.fid-this.$3<<4|r):(e+=this.$1.writeByte(r),e+=this.writeI16(t.fid)),this.$3=t.fid,e},n.$8=function(t){var e=0,n=this.$9(t.etype);return t.size<=D-2?e+=this.$1.writeByte(t.size<<4|n):(e+=this.$1.writeByte(240|n),e+=this.writeVarint32(t.size)),e},n.readFieldBegin=function(){var t=this.$1.readByte(),n=t&15;if(n===(e||(e=r("ThriftTypes"))).STOP)return{ftype:(e||(e=r("ThriftTypes"))).STOP,fid:0};var o=(t&240)>>>4,a;o===0?a=this.readI16():a=this.$3+o;var i=this.$10(n);return(n===u.CT_BOOLEAN_TRUE||n===u.CT_BOOLEAN_FALSE)&&(this.$5=n===u.CT_BOOLEAN_TRUE),this.$3=a,{ftype:i,fid:a}},n.readListBegin=function(){return this.$11()},n.readListEnd=function(){return 0},n.readSetBegin=function(){return this.$11()},n.readSetEnd=function(){return 0},n.readMapBegin=function(){var e=this.readVarint32();if(e>0){var t=this.$1.readByte(),n=this.$12(t>>4,"readMapBegin:key"),r=this.$12(t&15,"readMapBegin:value");return{ktype:this.$10(n),vtype:this.$10(r),size:e}}return{size:e}},n.readMapEnd=function(){return 0},n.$12=function(t,n){if(t<0||t>13)throw new Error(n+" read invalid compact type: "+t);return t},n.$11=function(){var e=this.$1.readByte(),t=this.$12(e&15,"_readListOrSetBegin"),n=this.$10(t),r=e>>4&15;return r===15&&(r=this.readVarint32()),{etype:n,size:r}},n.readFieldEnd=function(){return 0},n.readByte=function(){return this.$6.setUint8(0,this.$1.readByte()),this.$6.getInt8(0)},n.writeByte=function(t){if(t<p||t>m)throw new Error("byte to write is out of range: "+t);return this.$6.setInt8(0,t),this.$1.writeByte(this.$6.getUint8(0))},n.readFloat=function(){return this.$1.readFloatBE()},n.writeFloat=function(t){return this.$1.writeFloatBE(t)},n.readDouble=function(){return this.$1.readDoubleBE()},n.writeDouble=function(t){return this.$1.writeDoubleBE(t)},n.writeString=function(t){return this.writeBinary(o("StringToUtf8").StringToUtf8(t))},n.skip=function(n){switch(n){case(e||(e=r("ThriftTypes"))).STOP:return;case(e||(e=r("ThriftTypes"))).BOOL:this.readBool();break;case(e||(e=r("ThriftTypes"))).BYTE:this.readByte();break;case(e||(e=r("ThriftTypes"))).DOUBLE:this.readDouble();break;case(e||(e=r("ThriftTypes"))).I16:this.readI16();break;case(e||(e=r("ThriftTypes"))).I32:this.readI32();break;case(e||(e=r("ThriftTypes"))).I64:this.readI64();break;case(e||(e=r("ThriftTypes"))).STRING:this.readString();break;case(e||(e=r("ThriftTypes"))).STRUCT:{this.readStructBegin();for(var t;t=this.readFieldBegin(),t.ftype!==(e||(e=r("ThriftTypes"))).STOP;)this.skip(t.ftype);this.readStructEnd();break}case(e||(e=r("ThriftTypes"))).MAP:{var o=this.readMapBegin();if(o.size>0&&o.ktype!=null&&o.vtype!=null)for(var a=o.ktype,i=o.vtype,l=0;l<o.size;l++)this.skip(a),this.skip(i);break}case(e||(e=r("ThriftTypes"))).SET:case(e||(e=r("ThriftTypes"))).LIST:{for(var s=this.$11(),u=0;u<s.size;u++)this.skip(s.etype);break}case(e||(e=r("ThriftTypes"))).FLOAT:this.readFloat();break;default:throw new Error("encoutered unknow thrift type: "+n+" in skip")}},n.toByteArray=function(){return this.$1.toByteArray()},n.writeFieldEnd=function(){return 0},n.writeFieldStop=function(){return this.$1.writeByte((e||(e=r("ThriftTypes"))).STOP)},n.writeI16=function(t){if(t<f||t>_)throw new Error("trying to write i16 out of range: "+t);return this.writeVarint32(this.i32ToZigzag(t))},n.readI16=function(){var e=this.zigzagToI32(this.readVarint32());if(e<f||e>_)throw new Error("read invalid i16: "+e);return e},n.writeI32=function(t){if(t<h||t>g)throw new Error("i32 out of range: "+t);return this.writeVarint32(this.i32ToZigzag(t))},n.readI32=function(){return this.zigzagToI32(this.readVarint32())},n.writeI64=function(t){return this.writeVarint64(this.i64ToZigzag(t))},n.readI64=function(){return this.zigzagToI64(this.readVarint64())},n.readBool=function(){var e;return this.$5!=null?(e=this.$5,this.$5=null):e=this.$1.readByte()===u.CT_BOOLEAN_TRUE,e},n.writeBool=function(t){var e=0;return this.$4!=null?(e+=this.$7(this.$4,t?c.CT_BOOLEAN_TRUE:c.CT_BOOLEAN_FALSE),this.$4=null):e+=this.$1.writeByte(t?u.CT_BOOLEAN_TRUE:u.CT_BOOLEAN_FALSE),e},n.readBinary=function(){var e=this.readVarint32();return e===0?new Uint8Array(0):this.$1.readBytes(e)},n.writeBinary=function(t){var e=0;return e+=this.writeVarint32(t.length),e+=this.$1.write(t),e},n.i32ToZigzag=function(t){if(t<h||t>g)throw new Error("number: "+t+" is out of range of i32");return(t<<1^(t<0?4294967295:0))>>>0},n.zigzagToI32=function(t){if(t<0||t>y)throw new Error("number: "+t+" is out of range of uint32");return t>>>1^-1*(t&1)},n.i64ToZigzag=function(t){if(r("jsbi").greaterThan(t,C)||r("jsbi").lessThan(t,b))throw new Error("i64 out of range: "+t.toString());return r("jsbi").bitwiseXor(r("jsbi").signedRightShift(t,S),r("jsbi").leftShift(t,R))},n.zigzagToI64=function(t){if(r("jsbi").lessThan(t,0)||r("jsbi").greaterThan(t,v))throw new Error("invalid uint64: "+t.toString());return r("jsbi").equal(r("jsbi").bitwiseAnd(t,R),R)?r("jsbi").bitwiseNot(r("jsbi").signedRightShift(t,R)):r("jsbi").signedRightShift(t,R)},n.writeVarint32=function(t){if(t<0||t>y)throw new Error("writeVarint32 received out of range uint32: "+t);for(var e=t,n=0;;)if(e>>>7)this.$1.writeByte(e&127|128),n++,e>>>=7;else{this.$1.writeByte(e),n++;break}return n},n.readVarint32=function(){for(var e=0,t=0,n;;){if(n=this.$1.readByte(),e=(e|(n&127)<<t)>>>0,t+=7,(n&128)==0){if(t===35&&(n&240)!=0)throw new Error("result exceeded 32 bit limit");break}if(t>28)throw new Error("result exceeded 32 bit limit")}return e},n.writeVarint64=function(t){if(r("jsbi").lessThan(t,L)||r("jsbi").greaterThan(t,v))throw new Error("invalid uint64: "+t.toString());for(var e=t,n=0;;)if(r("jsbi").equal(r("jsbi").signedRightShift(e,E),L)){this.$1.writeByte(r("jsbi").toNumber(e)),n++;break}else{var o,a=(o=r("jsbi")).toNumber(o.bitwiseOr(o.bitwiseAnd(e,I),T));this.$1.writeByte(a),n++,e=o.signedRightShift(e,E)}return n},n.readVarint64=function(){for(var e=L,t=L,n;;){var o;if(n=(o=r("jsbi")).BigInt(this.$1.readByte()),e=o.bitwiseOr(e,o.leftShift(o.bitwiseAnd(n,I),t)),t=o.add(t,E),r("jsbi").equal(r("jsbi").bitwiseAnd(n,T),L)){if(r("jsbi").equal(t,k)&&r("jsbi").notEqual(n,R))throw new Error("result exceeded 64 bit limit");break}if(r("jsbi").greaterThan(t,S))throw new Error("result exceeded 64 bit limit")}return e},n.readString=function(){return o("Utf8ToString").Utf8ToString(this.readBinary())},n.getLastFieldId=function(){return this.$3},n.getLastField=function(){return this.$2},n.getBooleanFieldInfo=function(){return this.$4},n.getBooleanValue=function(){return this.$5},n.$9=function(t){return d[t]},n.$10=function(n){switch(n){case u.CT_STOP:return(e||(e=r("ThriftTypes"))).STOP;case u.CT_BOOLEAN_FALSE:case u.CT_BOOLEAN_TRUE:return(e||(e=r("ThriftTypes"))).BOOL;case u.CT_BYTE:return(e||(e=r("ThriftTypes"))).BYTE;case u.CT_I16:return(e||(e=r("ThriftTypes"))).I16;case u.CT_I32:return(e||(e=r("ThriftTypes"))).I32;case u.CT_I64:return(e||(e=r("ThriftTypes"))).I64;case u.CT_DOUBLE:return(e||(e=r("ThriftTypes"))).DOUBLE;case u.CT_FLOAT:return(e||(e=r("ThriftTypes"))).FLOAT;case u.CT_BINARY:return(e||(e=r("ThriftTypes"))).STRING;case u.CT_LIST:return(e||(e=r("ThriftTypes"))).LIST;case u.CT_SET:return(e||(e=r("ThriftTypes"))).SET;case u.CT_MAP:return(e||(e=r("ThriftTypes"))).MAP;case u.CT_STRUCT:return(e||(e=r("ThriftTypes"))).STRUCT;default:throw new Error("don't know what type")}},t})();l.default=x}),98);
__d("TNoOpWriteBuffer",[],(function(t,n,r,o,a,i){var e=(function(){function e(){this.$1=0}var t=e.prototype;return t.write=function(t){return this.$1+=t.length,t.length},t.writeByte=function(t){return this.$1++,1},t.writeFloatBE=function(t){return this.$1+=Float32Array.BYTES_PER_ELEMENT,Float32Array.BYTES_PER_ELEMENT},t.writeDoubleBE=function(t){return this.$1+=Float64Array.BYTES_PER_ELEMENT,Float64Array.BYTES_PER_ELEMENT},t.toByteArray=function(){throw new Error("operation not supported")},t.currentSize=function(){return this.$1},t.readByte=function(){throw new Error("operation not supported")},t.readBytes=function(t){throw new Error("operation not supported")},t.readFloatBE=function(){throw new Error("operation not supported")},t.readDoubleBE=function(){throw new Error("operation not supported")},e})();i.default=e}),66);
__d("TReadBuffer",[],(function(t,n,r,o,a,i){var e=(function(){function e(e){this.$1=e,this.$2=0}var t=e.prototype;return t.readByte=function(){if(this.$2<this.$1.length)return this.$1[this.$2++];throw new Error("no available byte to read")},t.readBytes=function(t){if(t<0)throw new Error("cannot readBytes of negative length: "+t);if(t+this.$2>this.$1.length)throw new Error("not enough bytes to read");var e=new Uint8Array(this.$1.buffer,this.$3(),t);return this.$2+=t,e},t.readFloatBE=function(){if(Float32Array.BYTES_PER_ELEMENT+this.$2>this.$1.length)throw new Error("not enough bytes to read");var e=new DataView(this.$1.buffer).getFloat32(this.$3());return this.$2+=Float32Array.BYTES_PER_ELEMENT,e},t.readDoubleBE=function(){if(Float64Array.BYTES_PER_ELEMENT+this.$2>this.$1.length)throw new Error("not enough bytes to read");var e=new DataView(this.$1.buffer).getFloat64(this.$3());return this.$2+=Float64Array.BYTES_PER_ELEMENT,e},t.$3=function(){return this.$2+this.$1.byteOffset},t.getCurrentCursor=function(){return this.$2},t.writeByte=function(t){throw new Error("operation not supported")},t.write=function(t){throw new Error("operation not supported")},t.toByteArray=function(){throw new Error("operation not supported")},t.writeFloatBE=function(t){throw new Error("operation not supported")},t.writeDoubleBE=function(t){throw new Error("operation not supported")},e})();i.default=e}),66);
__d("CompactSerializerPolyfill",["TCompactProtocolPolyfill","TNoOpWriteBuffer","TReadBuffer","TWriteBuffer"],(function(t,n,r,o,a,i,l){"use strict";function e(e,t){var n=new(r("TReadBuffer"))(e),o=new(r("TCompactProtocolPolyfill"))(n);return t(o)}function s(t,n,r){try{return e(t,n)}catch(e){r!=null&&r(e)}return null}function u(e,t,n){n===void 0&&(n=!1);var o;if(n){var a=new(r("TNoOpWriteBuffer")),i=new(r("TCompactProtocolPolyfill"))(a);t(e,i),o=new(r("TWriteBuffer"))(a.currentSize())}else o=new(r("TWriteBuffer"));var l=new(r("TCompactProtocolPolyfill"))(o);return t(e,l),l.toByteArray()}function c(e,t,n,r){n===void 0&&(n=!1);try{return u(e,t,n)}catch(e){r!=null&&r(e)}return null}l.deserialize=e,l.deserializeNoThrow=s,l.serialize=u,l.serializeNoThrow=c}),98);
__d("ContextualConfigConstants",[],(function(t,n,r,o,a,i){"use strict";var e=1e3,l=", ",s={SAME:"same",NULL:"null",NNULL:"nnull",CATCH_ALL:"catch_all",EQ:"eq",NEQ:"neq",LT:"lt",LTE:"lte",GT:"gt",GTE:"gte",COR:"cor",CONTAINS:"contains",REGEX:"regex",IN:"in",NIN:"nin"},u={DENSE:"dense",MULTI_OUTPUT_RESOLVED:"multi-output-resolved",TABLE:"table"},c=[],d=[],m=[],p={BAD_BOOLEAN_FORMAT:"Bad boolean format",BAD_CONFIG:"Bad config",BAD_CONTEXT_IDENTIFIER:"Bad context identifier",BAD_CONTEXT_VALUE:"Bad context value",BAD_MONITORED_CONTEXTS:"Bad monitored contexts",BAD_NUMBER_FORMAT:"Bad number format",BAD_OUTPUT_NAME:"Bad output name",BAD_OUTPUT_TYPE:"Bad output type",BAD_VALUE_ORDER:"Bad values order",DUPLICATE_OUTPUT_NAME:"Duplicate output name",ILLEGAL_BOOLEAN_STRATEGY:"Illegal boolean strategy",ILLEGAL_BUCKET_VALUES:"Illegal bucket values",ILLEGAL_NUMERIC_STRATEGY:"Illegal numeric strategy",ILLEGAL_STRING_STRATEGY:"Illegal string strategy",INVALID_BOOLEAN:"Invalid boolean",INVALID_FLOAT:"Invalid float",INVALID_INTEGER:"Invalid integer",INVALID_STRING:"Invalid string",INVALID_VALUE_TYPE:"Invalid value type",MISMATCH_NUMBER_OF_VALUES:"Mismatching number of values",MISSING_BUCKETS:"Missing buckets",MISSING_BUCKET_MATCH:"Missing bucket match",MISSING_BUCKET_NAME:"Missing bucket name",MISSING_BUCKET_STRATEGY:"Missing bucket strategy",MISSING_CONTEXT_IN_CONFIG:"Missing context in config",MISSING_DEFAULT_VALUE:"Missing default value",MISSING_OUTPUTS_DEFINITION:"Missing outputs field definition",MISSING_RESULTS:"Missing results",MISSING_TABLE:"Missing table",MISSING_TABLE_ITEM_BUCKET:"Missing table item bucket",MISSING_TABLE_ITEM_VALUES:"Missing table item values",MISSING_VECTOR:"Missing vector",REGEX_SYNTAX_ERROR:"Regex syntax error",REQUESTED_PARAM_NOT_FOUND:"Requested param not found",RESULTS_VECTOR_SIZE_MISMATCH:"Results vector size mismatch",UNDECLARED_OUTPUT_PARAM:"Undeclared output param",UNKNOWN_BUCKET_DEFINITION:"Unknown bucket definition",UNKNOWN_CONFIG_TYPE:"Unknown config type",UNSUPPORTED_CONFIG_VERSION:"Unsupported config version"},_=10,f=", ",g={BOOL:"BOOL",FLOAT:"FLOAT",INT:"INT",STRING:"STRING"};i.ANALYTICS_SAMPLE_RATE=e,i.BUCKET_DELIMITER=l,i.CONTEXT_BUCKET_STRATEGY=s,i.CONFIG_TYPE=u,i.EMPTY_RESOLVED_CONTEXTS=c,i.EMPTY_RESOLVED_MONITORS=d,i.EMPTY_RESULT_PARAMS=m,i.ERROR=p,i.JSON_SUB_SAMPLE_RATE=_,i.LIST_DELIMITER=f,i.TYPE=g}),66);
__d("ContextualConfigResolvedContextsUtils",[],(function(t,n,r,o,a,i){"use strict";var e=function(t){var e=[];for(var n of t){var r=n.bucketIndex;if(r==null)break;e.push(r)}return e},l=function(t){var e=[];for(var n of t){var r=n.bucketName;if(r===void 0)break;e.push(r)}return e},s=function(t){return t.name},u=function(t){return t.map(s)},c=function(t){var e=[];for(var n of t){var r=n.value;if(r===void 0)break;e.push(r)}return e};i.getBucketIndices=e,i.getBucketNames=l,i.getContextNames=u,i.getContextValues=c}),66);
__d("ContextualConfigCollateExposureData",["ContextualConfigConstants","ContextualConfigResolvedContextsUtils"],(function(t,n,r,o,a,i,l){"use strict";var e=["cfg_ver_timestamp","policy_id","version","sample_rate"],s=function(t){return t.join(o("ContextualConfigConstants").LIST_DELIMITER)},u=function(n,r){for(var t of e)r[t]!=null&&(n[t]=r[t]);r.name&&(n.config_name=r.name)},c=function(t,n){var e=n[0],r=n[1],a=n[2],i=n[3];e!=null&&(t.exception=e.message),t.result=s(r.map(function(e){return e.value}))||"INVALID",t.context=s(o("ContextualConfigResolvedContextsUtils").getContextNames(a)),t.context_value=s(o("ContextualConfigResolvedContextsUtils").getContextValues(a)),t.bucket_name=s(o("ContextualConfigResolvedContextsUtils").getBucketNames(a)),t.monitor=s(o("ContextualConfigResolvedContextsUtils").getContextNames(i)),t.monitor_value=s(o("ContextualConfigResolvedContextsUtils").getContextValues(i))};function d(e,t,n){var r={sample_rate:o("ContextualConfigConstants").ANALYTICS_SAMPLE_RATE};return u(r,e),c(r,t),n&&(r.config_contents=JSON.stringify(e)),r}l.default=d}),98);
__d("ContextualConfigExposureEvent",["Random"],(function(t,n,r,o,a,i,l){"use strict";var e=(function(){function e(e,t,n){this.$2=e,this.$4=o("Random").random()<1/e.sample_rate,this.$3=t,this.$1=n}var t=e.prototype;return t.getData=function(){return this.$2},t.log=function(t){var e=this.$2,n=this.$3,r=this.$4;return t&&n(e),r&&this.$1(e),this},t.isSampled=function(){return this.$4},e})();l.default=e}),98);
__d("ContextualConfigExposureLoggerFactory",["ContextualConfigExposureEvent"],(function(t,n,r,o,a,i,l){"use strict";var e=(function(){function e(e,t){this.$2=e,this.$1=t}var t=e.prototype;return t.createEvent=function(t){var e=new(r("ContextualConfigExposureEvent"))(t,this.$2,this.$1);return e},e})();function s(t,n){return new e(t,n)}l.default=s}),98);
__d("MarauderLogger",["Banzai","CacheStorage","MarauderConfig"],(function(t,n,r,o,a,i){var e="client_event",l="navigation",s=18e4,u="marauder",c="marauder_last_event_time",d="marauder_last_session_id",m={},p=[],_=!1,f=null,g=null,h=null,y=0,C,b,v=!1,S=null;function R(){P().set(c,L())}n("Banzai").subscribe(n("Banzai").SHUTDOWN,R);function L(){return C=C||P().get(c)||0,C}function E(){v||(b=P().get(d),v=!0);var e=Date.now();return(!b||e-s>L())&&(b=e.toString(16)+"-"+(~~(Math.random()*16777215)).toString(16),P().set(d,b)),b}function k(){return{user_agent:window.navigator.userAgent,screen_height:window.screen.availHeight,screen_width:window.screen.availWidth,density:window.screen.devicePixelRatio||null,platform:window.navigator.platform||null,locale:window.navigator.language||null}}function I(){return{locale:navigator.language}}function T(e,t,n,r,o,a,i){var l=i!=null&&i!=0?i:Date.now();C=i!=null&&i!=0?Date.now():l;var s=t!=null&&t!=""?t:f;return{name:e,time:l/1e3,module:s,obj_type:r,obj_id:o,uuid:a,extra:n}}function D(e,t,n){return T("content",null,{flags:t},null,null,e,n)}function x(e){var t=window.__mrdr;if(t)for(var n in t){var r=t[n];if(r[3]!==0){if(delete t[n],n==="1")if(h!==null)n=h;else continue;e.push(D(n,1,r[1])),e.push(D(n,2,r[2])),e.push(D(n,3,r[3]))}}}function $(t,r){if(x(t),t.length!==0){_&&t.push(T("counters",null,m));var o=n("Banzai").BASIC;r==="vital"&&(o=n("Banzai").VITAL);var a=n("MarauderConfig").gk_enabled;if(y===0&&a&&(t.push(T("device_status",null,I())),o={delay:5e3}),r==="signal"&&(o={signal:!0}),a&&Math.random()<.01&&t.push(T("device_info",null,k())),h!==null)for(var i=0;i<t.length;i++){var l=t[i];(l.uuid===null||l.uuid===void 0)&&(l.uuid=h)}var s={app_ver:n("MarauderConfig").app_version,data:t,device_id:void 0,log_type:e,seq:y++,session_id:E()},c=P().get("device_id");c&&(s.device_id=c),m={},_=!1,n("Banzai").post(u,s,o)}}function P(){return S||(S=new(n("CacheStorage"))("localstorage","")),S}function N(e){m[e]||(m[e]=0),m[e]++,_=!0}function M(e,t,n,r,o,a,i,l){$([T(e,t,n,r,o,a,i)],l)}function w(e,t){f!==t&&(p.push(T(l,f,{dest_module:t,source_url:g,destination_url:e})),f=t,g=e)}function A(e,t){f!==t&&(h=null,w(e,t))}function F(e,t,n){M(t?"show_module":"hide_module",e,n)}function O(e){f=e}function B(){return f}function W(e){h===null&&(h=e,e!==null&&($(p),p=[]))}a.exports={count:N,log:M,navigateTo:A,navigateWithinSession:w,toggleModule:F,setUUID:W,setNavigationModule:O,getNavigationModule:B}}),null);
__d("ContextualConfigExposureLogger",["ContextualConfigExposureLoggerFactory","MarauderLogger"],(function(t,n,r,o,a,i,l){"use strict";var e=function(t){},s=function(t){o("MarauderLogger").log("contextual_config_exposure","",t)},u=r("ContextualConfigExposureLoggerFactory")(e,s);l.default=u}),98);
__d("ContextualConfigAssert",[],(function(t,n,r,o,a,i){"use strict";function e(e,t){if(e===!1)throw new Error(t)}i.default=e}),66);
__d("ContextualConfigValidators",["ContextualConfigConstants"],(function(t,n,r,o,a,i,l){"use strict";var e=function(t){return Array.isArray(t)},s=function(t){return typeof t=="boolean"},u=function(t){return t!=null},c=function(t){return(function(e){return Object.prototype.hasOwnProperty.call(t,e)})},d=function(t){return p(t)&&t%1===0},m=function(t){return _(t)&&t.length>0},p=function(t){return typeof t=="number"&&!isNaN(t)&&t!==1/0&&t!==-1/0},_=function(t){return typeof t=="string"},f=function(t){switch(t){case o("ContextualConfigConstants").TYPE.BOOL:case o("ContextualConfigConstants").TYPE.FLOAT:case o("ContextualConfigConstants").TYPE.INT:case o("ContextualConfigConstants").TYPE.STRING:return!0;default:return!1}};l.isArray=e,l.isBoolean=s,l.isDefined=u,l.isKey=c,l.isInteger=d,l.isNonEmptyString=m,l.isNumber=p,l.isString=_,l.isType=f}),98);
__d("ContextualConfigParseBoolean",["ContextualConfigConstants"],(function(t,n,r,o,a,i,l){"use strict";function e(e){switch(e.toUpperCase()){case"TRUE":return!0;case"FALSE":return!1;default:throw new Error(o("ContextualConfigConstants").ERROR.BAD_BOOLEAN_FORMAT)}}l.default=e}),98);
__d("ContextualConfigParsePredBoolean",["ContextualConfigConstants","ContextualConfigParseBoolean"],(function(t,n,r,o,a,i,l){"use strict";function e(e,t){var n;switch(t){case o("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.SAME:var a=r("ContextualConfigParseBoolean")(e);n=function(t){return t===a};break;case o("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.NULL:n=function(t){return t==null};break;case o("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.NNULL:n=function(t){return t!=null};break;case o("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.CATCH_ALL:n=function(t){return!0};break;default:throw new Error(o("ContextualConfigConstants").ERROR.ILLEGAL_BOOLEAN_STRATEGY)}return function(e){return n(e)}}l.default=e}),98);
__d("ContextualConfigParseFloat",["ContextualConfigAssert","ContextualConfigConstants","ContextualConfigValidators"],(function(t,n,r,o,a,i,l){"use strict";var e,s=/^[-\+]?([1-9]\d*|0)(\.\d+)?$/,u=function(t){return s.test(t)};function c(t){(e||(e=r("ContextualConfigAssert")))(u(t),o("ContextualConfigConstants").ERROR.BAD_NUMBER_FORMAT);var n=parseFloat(t);return e(o("ContextualConfigValidators").isNumber(n),o("ContextualConfigConstants").ERROR.BAD_NUMBER_FORMAT),n}l.default=c}),98);
__d("ContextualConfigParseInteger",["ContextualConfigAssert","ContextualConfigConstants","ContextualConfigValidators"],(function(t,n,r,o,a,i,l){"use strict";var e,s=/^[-\+]?([1-9]\d*|0)$/,u=function(t){return s.test(t)};function c(t){(e||(e=r("ContextualConfigAssert")))(u(t),o("ContextualConfigConstants").ERROR.BAD_NUMBER_FORMAT);var n=parseInt(t,10);return e(o("ContextualConfigValidators").isNumber(n),o("ContextualConfigConstants").ERROR.BAD_NUMBER_FORMAT),n}l.default=c}),98);
__d("ContextualConfigPredAssertions",["ContextualConfigAssert","ContextualConfigConstants"],(function(t,n,r,o,a,i,l){"use strict";var e,s=function(n){return(e||(e=r("ContextualConfigAssert")))(n>0,o("ContextualConfigConstants").ERROR.MISMATCH_NUMBER_OF_VALUES)},u=function(n,a){return(e||(e=r("ContextualConfigAssert")))(n===a,o("ContextualConfigConstants").ERROR.MISMATCH_NUMBER_OF_VALUES)},c=function(n,a){return(e||(e=r("ContextualConfigAssert")))(n<a,o("ContextualConfigConstants").ERROR.BAD_VALUE_ORDER)};l.assertHasValues=s,l.assertNumberOfValues=u,l.assertValueOrder=c}),98);
__d("ContextualConfigParsePredNumeric",["ContextualConfigConstants","ContextualConfigParseFloat","ContextualConfigParseInteger","ContextualConfigPredAssertions","ContextualConfigValidators"],(function(t,n,r,o,a,i,l){"use strict";var e;function s(t,n,a,i){var l=a.map(i?r("ContextualConfigParseInteger"):e||(e=r("ContextualConfigParseFloat"))),s;switch(n){case o("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.SAME:var u=i?r("ContextualConfigParseInteger")(t):(e||(e=r("ContextualConfigParseFloat")))(t);s=function(t){return i&&!o("ContextualConfigValidators").isInteger(t)?!1:t===u};break;case o("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.NULL:s=function(t){return t==null};break;case o("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.NNULL:s=function(t){return t!=null};break;case o("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.CATCH_ALL:s=function(t){return!0};break;case o("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.COR:o("ContextualConfigPredAssertions").assertNumberOfValues(l.length,2),o("ContextualConfigPredAssertions").assertValueOrder(l[0],l[1]),s=function(t){return typeof t!="number"||i&&!o("ContextualConfigValidators").isInteger(t)?!1:t>=l[0]&&t<l[1]};break;case o("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.LT:o("ContextualConfigPredAssertions").assertNumberOfValues(l.length,1),s=function(t){return typeof t!="number"||i&&!o("ContextualConfigValidators").isInteger(t)?!1:t<l[0]};break;case o("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.LTE:o("ContextualConfigPredAssertions").assertNumberOfValues(l.length,1),s=function(t){return typeof t!="number"||i&&!o("ContextualConfigValidators").isInteger(t)?!1:t<=l[0]};break;case o("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.EQ:o("ContextualConfigPredAssertions").assertNumberOfValues(l.length,1),s=function(t){return typeof t!="number"||i&&!o("ContextualConfigValidators").isInteger(t)?!1:t===l[0]};break;case o("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.NEQ:o("ContextualConfigPredAssertions").assertNumberOfValues(l.length,1),s=function(t){return typeof t!="number"||i&&!o("ContextualConfigValidators").isInteger(t)?!1:t!==l[0]};break;case o("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.GT:o("ContextualConfigPredAssertions").assertNumberOfValues(l.length,1),s=function(t){return typeof t!="number"||i&&!o("ContextualConfigValidators").isInteger(t)?!1:t>l[0]};break;case o("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.GTE:o("ContextualConfigPredAssertions").assertNumberOfValues(l.length,1),s=function(t){return typeof t!="number"||i&&!o("ContextualConfigValidators").isInteger(t)?!1:t>=l[0]};break;default:throw new Error(o("ContextualConfigConstants").ERROR.ILLEGAL_NUMERIC_STRATEGY)}return function(e){return s(e)}}l.default=s}),98);
__d("ContextualConfigParseRegExp",["ContextualConfigConstants"],(function(t,n,r,o,a,i,l){"use strict";var e=/^\/(.+)\/(.*)$/;function s(t){try{var n=t.match(e);return n!=null?new RegExp(n[1],n[2]):new RegExp(t)}catch(e){throw new Error(o("ContextualConfigConstants").ERROR.REGEX_SYNTAX_ERROR)}}l.default=s}),98);
__d("ContextualConfigParsePredString",["ContextualConfigConstants","ContextualConfigParseRegExp","ContextualConfigPredAssertions"],(function(t,n,r,o,a,i,l){"use strict";var e=function(t){if(typeof t!="string")throw new Error(o("ContextualConfigConstants").ERROR.INVALID_VALUE_TYPE);return t},s=function(n){var t=[];for(var r of n)t.push(e(r));return t};function u(e,t,n){var a=s(n),i;switch(t){case o("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.SAME:i=function(n){return typeof n!="string"?!1:n===e};break;case o("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.NULL:i=function(t){return t==null};break;case o("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.NNULL:i=function(t){return t!=null};break;case o("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.CATCH_ALL:i=function(t){return!0};break;case o("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.IN:o("ContextualConfigPredAssertions").assertHasValues(a.length),i=function(t){return typeof t!="string"?!1:a.indexOf(t)!==-1};break;case o("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.NIN:o("ContextualConfigPredAssertions").assertHasValues(a.length),i=function(t){return typeof t!="string"?!1:a.indexOf(t)===-1};break;case o("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.CONTAINS:o("ContextualConfigPredAssertions").assertNumberOfValues(a.length,1),i=function(t){return typeof t!="string"?!1:t.indexOf(a[0])!==-1};break;case o("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.REGEX:o("ContextualConfigPredAssertions").assertNumberOfValues(a.length,1);var l=r("ContextualConfigParseRegExp")(a[0]);i=function(t){return typeof t!="string"?!1:l.test(t)};break;default:throw new Error(o("ContextualConfigConstants").ERROR.ILLEGAL_STRING_STRATEGY)}return function(e){return i(e)}}l.default=u}),98);
__d("ContextualConfigParseContextBuckets",["ContextualConfigAssert","ContextualConfigConstants","ContextualConfigParsePredBoolean","ContextualConfigParsePredNumeric","ContextualConfigParsePredString","ContextualConfigValidators"],(function(t,n,r,o,a,i,l){"use strict";var e,s=function(n){return(e||(e=r("ContextualConfigAssert")))(o("ContextualConfigValidators").isDefined(n),o("ContextualConfigConstants").ERROR.MISSING_BUCKETS)},u=function(n){return(e||(e=r("ContextualConfigAssert")))(o("ContextualConfigValidators").isArray(n),o("ContextualConfigConstants").ERROR.MISSING_BUCKETS)},c=o("ContextualConfigValidators").isKey(o("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY),d=function(n){return(e||(e=r("ContextualConfigAssert")))(o("ContextualConfigValidators").isString(n)&&c(n.toUpperCase()),o("ContextualConfigConstants").ERROR.MISSING_BUCKET_STRATEGY)},m=function(n){return(e||(e=r("ContextualConfigAssert")))(o("ContextualConfigValidators").isArray(n),o("ContextualConfigConstants").ERROR.ILLEGAL_BUCKET_VALUES)},p=function(n){return(e||(e=r("ContextualConfigAssert")))(o("ContextualConfigValidators").isNonEmptyString(n),o("ContextualConfigConstants").ERROR.MISSING_BUCKET_NAME)},_=function(t,n){var e=n.name;p(e);var a=n.strategy;d(a);var i=n.values||[];switch(m(i),t){case o("ContextualConfigConstants").TYPE.BOOL:return r("ContextualConfigParsePredBoolean")(e,a);case o("ContextualConfigConstants").TYPE.FLOAT:return r("ContextualConfigParsePredNumeric")(e,a,i,!1);case o("ContextualConfigConstants").TYPE.INT:return r("ContextualConfigParsePredNumeric")(e,a,i,!0);case o("ContextualConfigConstants").TYPE.STRING:return r("ContextualConfigParsePredString")(e,a,i);default:throw new Error(o("ContextualConfigConstants").ERROR.UNKNOWN_BUCKET_DEFINITION)}},f=function(t,n){s(n);var e=n.name;return p(e),{name:e,pred:_(t,n)}};function g(e,t){return u(t),t.map(function(t){return f(e,t)})}l.default=g}),98);
__d("ContextualConfigParseContexts",["ContextualConfigAssert","ContextualConfigConstants","ContextualConfigParseContextBuckets","ContextualConfigValidators"],(function(t,n,r,o,a,i,l){"use strict";var e,s=function(n){return(e||(e=r("ContextualConfigAssert")))(o("ContextualConfigValidators").isDefined(n),o("ContextualConfigConstants").ERROR.BAD_CONTEXT_IDENTIFIER)},u=function(n){return(e||(e=r("ContextualConfigAssert")))(o("ContextualConfigValidators").isArray(n)&&n.length>0,o("ContextualConfigConstants").ERROR.MISSING_CONTEXT_IN_CONFIG)},c=function(n){return(e||(e=r("ContextualConfigAssert")))(o("ContextualConfigValidators").isNonEmptyString(n),o("ContextualConfigConstants").ERROR.BAD_CONTEXT_IDENTIFIER)},d=function(n){return(e||(e=r("ContextualConfigAssert")))(o("ContextualConfigValidators").isType(n),o("ContextualConfigConstants").ERROR.BAD_CONTEXT_IDENTIFIER)},m=function(t){s(t);var e=t.name,n=t.type,o=t.buckets;return c(e),d(n),{name:e,type:n,buckets:r("ContextualConfigParseContextBuckets")(n,o)}};function p(e){return u(e),e.map(m)}l.default=p}),98);
__d("ContextualConfigIsEqualParams",[],(function(t,n,r,o,a,i){"use strict";function e(e,t){if(e.length!=t.length)return!1;for(var n=0;n<e.length;n+=1){var r=e[n],o=t[n];if(r.name!==o.name||r.type!==o.type)return!1}return!0}i.default=e}),66);
__d("ContextualConfigParseResultParamValue",["ContextualConfigAssert","ContextualConfigConstants","ContextualConfigParseBoolean","ContextualConfigParseFloat","ContextualConfigParseInteger","ContextualConfigValidators"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u=function(n){return(e||(e=r("ContextualConfigAssert")))(o("ContextualConfigValidators").isString(n),o("ContextualConfigConstants").ERROR.INVALID_STRING)};function c(e,t){switch(u(t),e){case o("ContextualConfigConstants").TYPE.BOOL:return r("ContextualConfigParseBoolean")(t);case o("ContextualConfigConstants").TYPE.FLOAT:return(s||(s=r("ContextualConfigParseFloat")))(t);case o("ContextualConfigConstants").TYPE.INT:return r("ContextualConfigParseInteger")(t);case o("ContextualConfigConstants").TYPE.STRING:return t;default:throw new Error(o("ContextualConfigConstants").ERROR.INVALID_VALUE_TYPE)}}l.default=c}),98);
__d("ContextualConfigParseResultParams",["ContextualConfigAssert","ContextualConfigConstants","ContextualConfigParseResultParamValue","ContextualConfigValidators"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u=function(n){return(e||(e=r("ContextualConfigAssert")))(o("ContextualConfigValidators").isArray(n),o("ContextualConfigConstants").ERROR.MISSING_RESULTS)},c=function(n){return(e||(e=r("ContextualConfigAssert")))(o("ContextualConfigValidators").isDefined(n),o("ContextualConfigConstants").ERROR.BAD_CONTEXT_VALUE)},d=function(n){return(e||(e=r("ContextualConfigAssert")))(o("ContextualConfigValidators").isNonEmptyString(n),o("ContextualConfigConstants").ERROR.BAD_CONTEXT_VALUE)},m=function(n){return(e||(e=r("ContextualConfigAssert")))(o("ContextualConfigValidators").isType(n),o("ContextualConfigConstants").ERROR.BAD_CONTEXT_VALUE)},p=function(t,n){for(var e of t)if(e.name===n)return e.type;throw new Error(o("ContextualConfigConstants").ERROR.UNDECLARED_OUTPUT_PARAM)},_=function(t){return(function(e){c(e);var n=e.name;d(n);var o=p(t,n);m(o);var a=(s||(s=r("ContextualConfigParseResultParamValue")))(o,e.value);return{name:n,type:o,value:a}})};function f(e,t){return u(t),t.map(_(e))}l.default=f}),98);
__d("ContextualConfigParseDenseResultParams",["ContextualConfigAssert","ContextualConfigConstants","ContextualConfigIsEqualParams","ContextualConfigParseResultParams"],(function(t,n,r,o,a,i,l){"use strict";var e,s=function(n,a){return(e||(e=r("ContextualConfigAssert")))(r("ContextualConfigIsEqualParams")(n,a),o("ContextualConfigConstants").ERROR.RESULTS_VECTOR_SIZE_MISMATCH)};function u(e,t){var n=r("ContextualConfigParseResultParams")(e,t.map(function(t,n){return{name:e[n].name,value:t}}));return s(e,n),n}l.default=u}),98);
__d("ContextualConfigParseDenseDefaults",["ContextualConfigConstants","ContextualConfigParseDenseResultParams"],(function(t,n,r,o,a,i,l){"use strict";function e(e,t){try{return r("ContextualConfigParseDenseResultParams")(e,t)}catch(e){throw new Error(o("ContextualConfigConstants").ERROR.MISSING_DEFAULT_VALUE)}}l.default=e}),98);
__d("ContextualConfigParseMonitors",["ContextualConfigAssert","ContextualConfigConstants","ContextualConfigValidators"],(function(t,n,r,o,a,i,l){"use strict";var e,s=function(n){return(e||(e=r("ContextualConfigAssert")))(o("ContextualConfigValidators").isDefined(n),o("ContextualConfigConstants").ERROR.BAD_CONTEXT_IDENTIFIER)},u=function(n){return(e||(e=r("ContextualConfigAssert")))(o("ContextualConfigValidators").isArray(n),o("ContextualConfigConstants").ERROR.BAD_MONITORED_CONTEXTS)},c=function(n){return(e||(e=r("ContextualConfigAssert")))(o("ContextualConfigValidators").isNonEmptyString(n),o("ContextualConfigConstants").ERROR.BAD_CONTEXT_IDENTIFIER)},d=function(n){return(e||(e=r("ContextualConfigAssert")))(o("ContextualConfigValidators").isType(n),o("ContextualConfigConstants").ERROR.BAD_CONTEXT_IDENTIFIER)},m=function(t){s(t);var e=t.name,n=t.type;return c(e),d(n),{name:e,type:n}};function p(e){return u(e),e.map(m)}l.default=p}),98);
__d("ContextualConfigParseOutputParams",["ContextualConfigAssert","ContextualConfigConstants","ContextualConfigValidators"],(function(t,n,r,o,a,i,l){var e,s=function(n){return(e||(e=r("ContextualConfigAssert")))(o("ContextualConfigValidators").isArray(n),o("ContextualConfigConstants").ERROR.MISSING_OUTPUTS_DEFINITION)},u=function(n){return(e||(e=r("ContextualConfigAssert")))(o("ContextualConfigValidators").isType(n),o("ContextualConfigConstants").ERROR.BAD_OUTPUT_TYPE)},c=function(n){return(e||(e=r("ContextualConfigAssert")))(o("ContextualConfigValidators").isNonEmptyString(n),o("ContextualConfigConstants").ERROR.BAD_OUTPUT_NAME)},d=function(n){return(e||(e=r("ContextualConfigAssert")))(m(n),o("ContextualConfigConstants").ERROR.DUPLICATE_OUTPUT_NAME)},m=function(t){var e={};for(var n of t){if(e[n.name])return!1;e[n.name]=!0}return!0},p=function(t){return c(t.name),u(t.type),t};function _(e){s(e);var t=e.map(p);return d(t),t}l.default=_}),98);
__d("ContextualConfigParseVector",["ContextualConfigAssert","ContextualConfigConstants","ContextualConfigParseResultParamValue","ContextualConfigValidators"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u=function(n){return(e||(e=r("ContextualConfigAssert")))(o("ContextualConfigValidators").isArray(n),o("ContextualConfigConstants").ERROR.MISSING_VECTOR)},c=function(n,a){return(e||(e=r("ContextualConfigAssert")))(n===a,o("ContextualConfigConstants").ERROR.RESULTS_VECTOR_SIZE_MISMATCH)},d=function(t,n){c(t.length,n.length);for(var e=0;e<t.length;e+=1){var o=t[e].type,a=n[e];(s||(s=r("ContextualConfigParseResultParamValue")))(o,a)}},m=function(t){return t.reduce(function(e,t){var n=t.buckets;return e*n.length},1)};function p(e,t,n){u(n);var r=m(t),o=e.length;c(r*o,n.length);for(var a=0;a<r;a+=1){var i=a*o;d(e,n.slice(i,i+o))}return n}l.default=p}),98);
__d("ContextualConfigResolveContexts",["ContextualConfigConstants"],(function(t,n,r,o,a,i,l){"use strict";var e=function(t,n){for(var e=0;e<t.length;e+=1){var r=t[e];try{if(r.pred(n))return[r.name,e]}catch(e){return null}}return null};function s(t,n,r){var a=null,i=t.map(function(t){var i=t.name,l={name:i};if(a!=null)return l;var s;if(r[i]!=null?s=r[i]:n[i]!=null?s=n[i]():s=null,l.value=s,t.buckets!=null){var u=e(t.buckets,s);if(u==null)return a=new Error(o("ContextualConfigConstants").ERROR.MISSING_BUCKET_MATCH),l;var c=u[0],d=u[1];l.bucketName=c,l.bucketIndex=d}return l});return[a,i]}l.default=s}),98);
__d("DenseContextualConfig",["ContextualConfigAssert","ContextualConfigConstants","ContextualConfigParseContexts","ContextualConfigParseDenseDefaults","ContextualConfigParseDenseResultParams","ContextualConfigParseMonitors","ContextualConfigParseOutputParams","ContextualConfigParseVector","ContextualConfigResolveContexts","ContextualConfigResolvedContextsUtils","ContextualConfigValidators","getErrorSafe"],(function(t,n,r,o,a,i,l){"use strict";var e,s=function(n){return(e||(e=r("ContextualConfigAssert")))(o("ContextualConfigValidators").isDefined(n),o("ContextualConfigConstants").ERROR.BAD_CONFIG)},u=function(t){for(var e=[],n=1,r=t.length-1;r>=0;r-=1)e.push(n),n*=t[r].buckets.length;return e.reverse()},c=function(t,n,o,a){try{var e=n.slice(o,o+t.length);return[null,r("ContextualConfigParseDenseResultParams")(t,e)]}catch(e){return[r("getErrorSafe")(e),a]}},d=function(n,o,a){try{var t=a.reduce(function(t,o,a){return(e||(e=r("ContextualConfigAssert")))(a<n.length,"Auxillery index out of range."),t+n[a]*o},0);return[null,t*o]}catch(e){return[r("getErrorSafe")(e),-1]}},m=(function(){function e(e,t){s(e),this.globalContextProviders=babelHelpers.extends({},t);var n=r("ContextualConfigParseOutputParams")(e.outputs),o=r("ContextualConfigParseContexts")(e.contexts);this.aux=u(o),this.contexts=o,this.defaults=r("ContextualConfigParseDenseDefaults")(n,e.vectorDefaults),this.monitors=e.monitors!=null?r("ContextualConfigParseMonitors")(e.monitors):[],this.outputs=n,this.vector=r("ContextualConfigParseVector")(n,o,e.vector)}var t=e.prototype;return t.resolve=function(t){try{return this.unsafeResolve(t)}catch(e){return[r("getErrorSafe")(e),this.defaults,o("ContextualConfigConstants").EMPTY_RESOLVED_CONTEXTS,o("ContextualConfigConstants").EMPTY_RESOLVED_MONITORS]}},t.unsafeResolve=function(t){var e=this.aux,n=this.globalContextProviders,a=this.contexts,i=this.defaults,l=this.monitors,s=this.outputs,u=this.vector,m=r("ContextualConfigResolveContexts")(a,n,t),p=m[0],_=m[1];if(p!=null)return[p,i,_,o("ContextualConfigConstants").EMPTY_RESOLVED_MONITORS];var f=d(e,s.length,o("ContextualConfigResolvedContextsUtils").getBucketIndices(_)),g=f[0],h=f[1];if(g!=null)return[g,i,_,o("ContextualConfigConstants").EMPTY_RESOLVED_MONITORS];var y=c(s,u,h,i),C=y[0],b=y[1];if(C!=null)return[C,b,_,o("ContextualConfigConstants").EMPTY_RESOLVED_MONITORS];var v=r("ContextualConfigResolveContexts")(l,n,t),S=v[0],R=v[1];return S!=null?[S,b,_,o("ContextualConfigConstants").EMPTY_RESOLVED_MONITORS]:[null,b,_,R]},e})();l.default=m}),98);
__d("MultiOutputResolvedContextualConfig",["ContextualConfigAssert","ContextualConfigConstants","ContextualConfigParseMonitors","ContextualConfigParseOutputParams","ContextualConfigParseResultParams","ContextualConfigResolveContexts","ContextualConfigValidators"],(function(t,n,r,o,a,i,l){"use strict";var e,s=function(n){return(e||(e=r("ContextualConfigAssert")))(o("ContextualConfigValidators").isDefined(n),o("ContextualConfigConstants").ERROR.BAD_CONFIG)},u=(function(){function e(e,t){s(e),this.globalContextProviders=babelHelpers.extends({},t);var n=r("ContextualConfigParseOutputParams")(e.outputs);this.monitors=e.monitors!=null?r("ContextualConfigParseMonitors")(e.monitors):[],this.values=r("ContextualConfigParseResultParams")(n,e.values)}var t=e.prototype;return t.resolve=function(t){try{return this.unsafeResolve(t)}catch(e){return[e,this.values,o("ContextualConfigConstants").EMPTY_RESOLVED_CONTEXTS,o("ContextualConfigConstants").EMPTY_RESOLVED_MONITORS]}},t.unsafeResolve=function(t){var e=this.globalContextProviders,n=this.monitors,a=this.values,i=r("ContextualConfigResolveContexts")(n,e,t),l=i[0],s=i[1];return l!=null?[l,a,o("ContextualConfigConstants").EMPTY_RESOLVED_CONTEXTS,o("ContextualConfigConstants").EMPTY_RESOLVED_MONITORS]:[null,a,o("ContextualConfigConstants").EMPTY_RESOLVED_CONTEXTS,s]},e})();l.default=u}),98);
__d("ContextualConfigMergePartialResultParams",[],(function(t,n,r,o,a,i){"use strict";function e(e,t){var n={};for(var r of t)n[r.name]=r;var o=[];for(var a of e){var i=n[a.name];o.push(i!=null&&i.name===a.name&&i.type===a.type?i:a)}return o}i.default=e}),66);
__d("ContextualConfigParseDefaults",["ContextualConfigAssert","ContextualConfigConstants","ContextualConfigIsEqualParams","ContextualConfigParseResultParams"],(function(t,n,r,o,a,i,l){"use strict";var e,s=function(n,a){return(e||(e=r("ContextualConfigAssert")))(r("ContextualConfigIsEqualParams")(n,a),o("ContextualConfigConstants").ERROR.MISSING_DEFAULT_VALUE)};function u(e,t){var n=r("ContextualConfigParseResultParams")(e,t);return s(e,n),n}l.default=u}),98);
__d("ContextualConfigParseTable",["ContextualConfigAssert","ContextualConfigConstants","ContextualConfigParseResultParams","ContextualConfigValidators"],(function(t,n,r,o,a,i,l){"use strict";var e,s=function(n){return(e||(e=r("ContextualConfigAssert")))(o("ContextualConfigValidators").isArray(n),o("ContextualConfigConstants").ERROR.MISSING_TABLE)},u=function(n){return(e||(e=r("ContextualConfigAssert")))(o("ContextualConfigValidators").isDefined(n),o("ContextualConfigConstants").ERROR.MISSING_TABLE)},c=function(n){return(e||(e=r("ContextualConfigAssert")))(o("ContextualConfigValidators").isNonEmptyString(n),o("ContextualConfigConstants").ERROR.MISSING_TABLE_ITEM_BUCKET)},d=function(n){return(e||(e=r("ContextualConfigAssert")))(o("ContextualConfigValidators").isArray(n),o("ContextualConfigConstants").ERROR.MISSING_TABLE_ITEM_VALUES)},m=function(t,n){u(n);var e=n.bucket,o=n.values;return c(e),d(o),{bucket:e,values:r("ContextualConfigParseResultParams")(t,o)}};function p(e,t){return s(t),t.reduce(function(t,n){var r=m(e,n);return t[r.bucket]=r.values,t},{})}l.default=p}),98);
__d("TableContextualConfig",["ContextualConfigAssert","ContextualConfigConstants","ContextualConfigMergePartialResultParams","ContextualConfigParseContexts","ContextualConfigParseDefaults","ContextualConfigParseMonitors","ContextualConfigParseOutputParams","ContextualConfigParseTable","ContextualConfigResolveContexts","ContextualConfigResolvedContextsUtils","ContextualConfigValidators"],(function(t,n,r,o,a,i,l){"use strict";var e,s=[],u=function(n){return(e||(e=r("ContextualConfigAssert")))(o("ContextualConfigValidators").isDefined(n),o("ContextualConfigConstants").ERROR.BAD_CONFIG)},c=(function(){function e(e,t){u(e),this.globalContextProviders=babelHelpers.extends({},t);var n=r("ContextualConfigParseOutputParams")(e.outputs);this.contexts=r("ContextualConfigParseContexts")(e.contexts),this.defaults=r("ContextualConfigParseDefaults")(n,e.defaults),this.monitors=e.monitors!=null?r("ContextualConfigParseMonitors")(e.monitors):[],this.table=r("ContextualConfigParseTable")(n,e.table)}var t=e.prototype;return t.resolve=function(t){try{return this.unsafeResolve(t)}catch(e){return[e,this.defaults,o("ContextualConfigConstants").EMPTY_RESOLVED_CONTEXTS,o("ContextualConfigConstants").EMPTY_RESOLVED_MONITORS]}},t.unsafeResolve=function(t){var e=this.globalContextProviders,n=this.contexts,a=this.defaults,i=this.monitors,l=this.table,u=r("ContextualConfigResolveContexts")(n,e,t),c=u[0],d=u[1];if(c!=null)return[c,a,d,[]];var m=o("ContextualConfigResolvedContextsUtils").getBucketNames(d).join(o("ContextualConfigConstants").BUCKET_DELIMITER),p=l[m]||s,_=r("ContextualConfigMergePartialResultParams")(a,p),f=r("ContextualConfigResolveContexts")(i,e,t),g=f[0],h=f[1];return g!=null?[g,_,d,[]]:[null,_,d,h]},e})();l.default=c}),98);
__d("ContextualConfigParseConfig",["ContextualConfigAssert","ContextualConfigConstants","ContextualConfigValidators","DenseContextualConfig","MultiOutputResolvedContextualConfig","TableContextualConfig"],(function(t,n,r,o,a,i,l){"use strict";var e,s=[1],u=function(n){return(e||(e=r("ContextualConfigAssert")))(o("ContextualConfigValidators").isDefined(n)&&o("ContextualConfigValidators").isDefined(n.version),o("ContextualConfigConstants").ERROR.BAD_CONFIG)},c=function(n){return(e||(e=r("ContextualConfigAssert")))(s.indexOf(n)!==-1,o("ContextualConfigConstants").ERROR.UNSUPPORTED_CONFIG_VERSION)};function d(e,t){switch(u(e),c(e.version),e.cctype){case o("ContextualConfigConstants").CONFIG_TYPE.DENSE:return new(r("DenseContextualConfig"))(e,t);case o("ContextualConfigConstants").CONFIG_TYPE.MULTI_OUTPUT_RESOLVED:return new(r("MultiOutputResolvedContextualConfig"))(e,t);case o("ContextualConfigConstants").CONFIG_TYPE.TABLE:return new(r("TableContextualConfig"))(e,t);default:throw new Error(o("ContextualConfigConstants").ERROR.UNKNOWN_CONFIG_TYPE)}}l.default=d}),98);
__d("ContextualConfigWarn",[],(function(t,n,r,o,a,i){"use strict";function e(e){}i.default=e}),66);
__d("ContextualConfigResult",["ContextualConfigConstants","ContextualConfigWarn","getErrorSafe"],(function(t,n,r,o,a,i,l){"use strict";var e=(function(){function e(e){this.$1=e.reduce(function(e,t){var n=t.name,r=t.value;return e[n]=r,e},{}),this.$2=e}var t=e.prototype;return t.get=function(t,n){try{var e=this.$1[t];return typeof e!=typeof n?(r("ContextualConfigWarn")(o("ContextualConfigConstants").ERROR.REQUESTED_PARAM_NOT_FOUND),n):e}catch(e){return r("ContextualConfigWarn")(r("getErrorSafe")(e).message),n}},t.getParams=function(){return this.$2},e})();l.default=e}),98);
__d("ErrorContextualConfig",["ContextualConfigConstants"],(function(t,n,r,o,a,i,l){"use strict";var e=(function(){function e(e){this.error=e}var t=e.prototype;return t.resolve=function(t){return[this.error,o("ContextualConfigConstants").EMPTY_RESULT_PARAMS,o("ContextualConfigConstants").EMPTY_RESOLVED_CONTEXTS,o("ContextualConfigConstants").EMPTY_RESOLVED_MONITORS]},e})();l.default=e}),98);
__d("ContextualConfig",["ContextualConfigCollateExposureData","ContextualConfigConstants","ContextualConfigExposureLogger","ContextualConfigParseConfig","ContextualConfigResult","ErrorContextualConfig","Random","getErrorSafe"],(function(t,n,r,o,a,i,l){"use strict";var e=1/o("ContextualConfigConstants").JSON_SUB_SAMPLE_RATE,s=1,u=(function(){function t(e,t){t===void 0&&(t={}),this.isDebugLoggingEnabled=!1,this.$3=!1,this.$4=e,this.$2=t}var n=t.prototype;return n.$5=function(){if(this.$1)return this.$1;var e=this.$2,t=this.$4,n;try{n=r("ContextualConfigParseConfig")(t,e)}catch(e){n=new(r("ErrorContextualConfig"))(r("getErrorSafe")(e))}return this.$1=n,n},n.$6=function(n){var t=this.isDebugLoggingEnabled,a=this.$3,i=!a&&o("Random").random()<e;i&&(this.$3=!0);var l=r("ContextualConfigCollateExposureData")(this.$4,n,i),s=r("ContextualConfigExposureLogger").createEvent(l);s.log(t)},n.resolve=function(t){t===void 0&&(t={});var e=this.$1||this.$5(),n=e.resolve(t);return this.$6(n),new(r("ContextualConfigResult"))(n[s])},t})();l.default=u}),98);
__d("CurrentLocale",["IntlCurrentLocale"],(function(t,n,r,o,a,i,l){"use strict";var e={get:function(){return r("IntlCurrentLocale").code}},s=e;l.default=s}),98);
__d("DgwClientFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(t,n,r,o,a,i,l){"use strict";var e=r("getFalcoLogPolicy_DO_NOT_USE")("1755537"),s=o("FalcoLoggerInternal").create("dgw_client",e),u=s;l.default=u}),98);
__d("DGWLoggingContext",["$InternalEnum","DgwClientFalcoEvent","ODS","Random"],(function(t,n,r,o,a,i,l){"use strict";var e,s="dgw_client",u=n("$InternalEnum")({STREAM_GROUP_COMPONENT:"WebStreamGroup",GROUPED_STREAM_COMPONENT:"GroupedWebStream",WEBSOCKET_TRANSPORT_COMPONENT:"WebSocketTransport",ACK_MANAGER_COMPONENT:"WebStreamAckManager",CODEC_COMPONENT:"WebCodec",RAW_CLIENT:"RAWDGWClient",PINGER:"DGWPinger"}),c={VERBOSE:-1,INFO:0,WARNING:1,ERROR:2,FATAL:3};function d(e){switch(e){case u.GROUPED_STREAM_COMPONENT:case u.ACK_MANAGER_COMPONENT:return!0;default:return!1}}var m=(function(){function t(e,t,n,r,o,a,i){a===void 0&&(a=!1),i===void 0&&(i=!1),this.$5=""+e,this.$1=t,this.$4=n,this.$3=r,this.sgTransportId=o,this.$2=a,this.$6=i}t.bumpODSKey=function(n,r,a){if(a===void 0&&(a=1),!!o("Random").coinflip(a)){var t=n+"."+r;(e||(e=o("ODS"))).bumpEntityKey(3589,"dgw_web_client",t,a)}};var n=t.prototype;return n.bumpODSKey=function(n,r,a){if(a===void 0&&(a=1),!!o("Random").coinflip(a)){var t=this.$4+"."+n+"."+r;(e||(e=o("ODS"))).bumpEntityKey(3589,"dgw_web_client",t,a)}},n.logEvent=function(t,n,r,o,a){o===void 0&&(o=!1),this.$2||this.$7(t,n,null,c.INFO,r,o,a)},n.$7=function(t,n,o,a,i,l,s){var e=this;l===void 0&&(l=!1),!(l&&!this.$6)&&(d(t)&&this.$1!=null||!d(t)&&this.sgTransportId!=null)&&r("DgwClientFalcoEvent").log(function(){return{event:n,logging_id:s!=null?s:e.$1,dgw_version:e.$5,message:o,severity:a,uuid:e.$3,dgw_component:t,extra_info:i,destination_tier:e.$4,sg_transport_id:e.sgTransportId,source:2}})},n.logError=function(t,n,r,o,a,i){a===void 0&&(a=!1),this.$2||this.$7(t,n,r,c.ERROR,o,a,i)},n.logWarn=function(t,n,r,o,a){a===void 0&&(a=!1),this.$2||this.$7(t,n,r,c.WARNING,o,a)},t})();l.DGW_MODULE=s,l.DGWLoggingComponent=u,l.DGWLoggingContext=m}),98);
__d("DGWAckManager",["DGWLoggingContext","Promise","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){"use strict";var e,s=(function(){function e(e,t,n){var r=this;this.$3=n,this.sendId=e,this.$2=t,this.handleAckReceived=function(){r.stopTracking(!0)},this.$1=window.setTimeout(function(){r.stopTracking(!1)},t)}var t=e.prototype;return t.stopTracking=function(t){window.clearTimeout(this.$1),this.$3(t)},e})(),u=(function(){function t(e){this.$1=new Map,this.$2=e}var r=t.prototype;return r.waitForAck=(function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,r){this.$2.bumpODSKey(o("DGWLoggingContext").DGWLoggingComponent.ACK_MANAGER_COMPONENT,"ack_expected");var a=this.$1;try{var i=yield new(e||(e=n("Promise")))(function(e,n){a.set(t,new s(t,r,e))});return i===!0?this.$2.logEvent(o("DGWLoggingContext").DGWLoggingComponent.ACK_MANAGER_COMPONENT,"Received ACK","sendId:"+t,!0):(this.$2.bumpODSKey(o("DGWLoggingContext").DGWLoggingComponent.ACK_MANAGER_COMPONENT,"ack_timeout"),this.$2.logWarn(o("DGWLoggingContext").DGWLoggingComponent.ACK_MANAGER_COMPONENT,"ACK timeout","Request "+t+" timed out after "+r+"ms")),a.delete(t),i}catch(e){throw this.$2.bumpODSKey(o("DGWLoggingContext").DGWLoggingComponent.ACK_MANAGER_COMPONENT,"ack_error"),a.delete(t),e}});function r(e,n){return t.apply(this,arguments)}return r})(),r.handleAckReceived=function(t){this.$2.bumpODSKey(o("DGWLoggingContext").DGWLoggingComponent.ACK_MANAGER_COMPONENT,"ack_received");var e=this.$1.get(t);if(e===void 0){this.$2.bumpODSKey(o("DGWLoggingContext").DGWLoggingComponent.ACK_MANAGER_COMPONENT,"ack_received.not_tracked"),this.$2.logWarn(o("DGWLoggingContext").DGWLoggingComponent.ACK_MANAGER_COMPONENT,"untracked ACK","Received ACK for ackId "+t+" which was not being tracked");return}e.handleAckReceived()},r.clearPendingAcks=function(){var e=this;this.$2.logEvent(o("DGWLoggingContext").DGWLoggingComponent.ACK_MANAGER_COMPONENT,"Clearing pending acks","ACKs cleared size: "+this.$1.size),this.$1.forEach(function(t,n,r){e.$2.logEvent(o("DGWLoggingContext").DGWLoggingComponent.ACK_MANAGER_COMPONENT,"Clearing pending ACK with ackId "+t.sendId,null,!0),t.stopTracking(!1),r.delete(n)})},t})();l.DGWAckManager=u}),98);
__d("DGWAuth",["$InternalEnum","err"],(function(t,n,r,o,a,i,l){"use strict";var e=n("$InternalEnum")({TEST:"0:0",FACEBOOK:"1:0",INTERNALFB:"2:0",OCULUS:"3:0",ENTERPRISEFB:"7:0",RECRUITINGFB:"8:0",INSTAGRAM:"6:0",HORIZON_WEB:"12:0",SPARK_WEB:"13:0",ABRA:"15:0",GUEST:"19:0"});function s(t){if(t==="TEST")return e.TEST;if(t==="FACEBOOK")return e.FACEBOOK;if(t==="INTERNALFB")return e.INTERNALFB;if(t==="OCULUS")return e.OCULUS;if(t==="ENTERPRISEFB")return e.ENTERPRISEFB;if(t==="RECRUITINGFB")return e.RECRUITINGFB;if(t==="INSTAGRAM")return e.INSTAGRAM;if(t==="HORIZON_WEB")return e.HORIZON_WEB;if(t==="SPARK_WEB")return e.SPARK_WEB;if(t==="ABRA")return e.ABRA;if(t==="GUEST")return e.GUEST;throw r("err")("failed to convert string ("+t+") to DGWAuth Type")}function u(t){return t===e.FACEBOOK?"FACEBOOK":t===e.INTERNALFB?"INTERNALFB":t===e.OCULUS?"OCULUS":t===e.ENTERPRISEFB?"ENTERPRISEFB":t===e.RECRUITINGFB?"RECRUITINGFB":t===e.INSTAGRAM?"INSTAGRAM":t===e.HORIZON_WEB?"HORIZON_WEB":t===e.SPARK_WEB?"SPARK_WEB":t===e.ABRA?"ABRA":t===e.GUEST?"GUEST":"TEST"}l.DGWAuth=e,l.fromStringToDGWAuth=s,l.fromDGWAuthToString=u}),98);
__d("DGWConstants",["$InternalEnum"],(function(t,n,r,o,a,i){"use strict";var e,l=3e4,s="prod",u=128,c=(e=n("$InternalEnum"))({NORMAL_CLOSURE:1e3,GOING_AWAY:1001,ABNORMAL_CLOSURE:1006,SERVER_INTERNAL_ERROR:1011,GRACEFUL_CLOSE:4e3,KEEPALIVE_TIMEOUT:4001,DGW_SERVER_ERROR:4002,UNAUTHORIZED:4003,REJECTED:4004,BAD_REQUEST:4005}),d=e({DrainReason_ELB:0,DrainReason_SLB:1,DrainReason_AppServerPush:2,DrainReason_GracePeriodExpired:3,DrainReason_Unknown:4});function m(e){switch(e){case d.DrainReason_ELB:return"DrainReason_ELB";case d.DrainReason_SLB:return"DrainReason_SLB";case d.DrainReason_AppServerPush:return"DrainReason_AppServerPush";case d.DrainReason_GracePeriodExpired:return"DrainReason_GracePeriodExpired";case d.DrainReason_Unknown:return"DrainReason_Unknown"}}var p=e({DGWVER_GENESIS:0,DGWVER_PREFIXED_APP_HEADERS:1,DGWVER_HANDLES_DGW_DRAIN_FRAME:2,DGWVER_HANDLES_DGW_DEAUTH_FRAME:3,DGWVER_HANDLES_STREAMGROUPS:4,DGWVER_BIG_IDS:5});function _(e){switch(e){case p.DGWVER_GENESIS:return"DGWVER_GENESIS";case p.DGWVER_PREFIXED_APP_HEADERS:return"DGWVER_PREFIXED_APP_HEADERS";case p.DGWVER_HANDLES_DGW_DRAIN_FRAME:return"DGWVER_HANDLES_DGW_DRAIN_FRAME";case p.DGWVER_HANDLES_DGW_DEAUTH_FRAME:return"DGWVER_HANDLES_DGW_DEAUTH_FRAME";case p.DGWVER_HANDLES_STREAMGROUPS:return"DGWVER_HANDLES_STREAMGROUPS";case p.DGWVER_BIG_IDS:return"DGWVER_BIG_IDS"}}var f=e({DgwCodecReturnCode_Success:0,DgwCodecReturnCode_Failure:1,DgwCodecReturnCode_NotEnoughData:2,DgwCodecReturnCode_OutOfMemory:3,DgwCodecReturnCode_AckIdOutOfBounds:4,DgwCodecReturnCode_InvalidParameter:5,DgwCodecReturnCode_InvalidFrameType:6,DgwCodecReturnCode_InvalidAckFrameLength:7,DgwCodecReturnCode_InvalidDrainReason:8,DgwCodecReturnCode_InvalidDataFrameLength:9,DgwCodecReturnCode_InvalidDrainFrameLength:10});function g(e){switch(e){case f.DgwCodecReturnCode_Success:return"DgwCodecReturnCode_Success";case f.DgwCodecReturnCode_Failure:return"DgwCodecReturnCode_Failure";case f.DgwCodecReturnCode_NotEnoughData:return"DgwCodecReturnCode_NotEnoughData";case f.DgwCodecReturnCode_OutOfMemory:return"DgwCodecReturnCode_OutOfMemory";case f.DgwCodecReturnCode_AckIdOutOfBounds:return"DgwCodecReturnCode_AckIdOutOfBounds";case f.DgwCodecReturnCode_InvalidParameter:return"DgwCodecReturnCode_InvalidParameter";case f.DgwCodecReturnCode_InvalidFrameType:return"DgwCodecReturnCode_InvalidFrameType";case f.DgwCodecReturnCode_InvalidAckFrameLength:return"DgwCodecReturnCode_InvalidAckFrameLength";case f.DgwCodecReturnCode_InvalidDrainReason:return"DgwCodecReturnCode_InvalidDrainReason";case f.DgwCodecReturnCode_InvalidDataFrameLength:return"DgwCodecReturnCode_InvalidDataFrameLength";case f.DgwCodecReturnCode_InvalidDrainFrameLength:return"DgwCodecReturnCode_InvalidDrainFrameLength"}}var h=e({DgwFrameType_Empty:2,DgwFrameType_Drain:3,DgwFrameType_Deauth:4,DgwFrameType_StreamGroup_DeprecatedEstabStream:5,DgwFrameType_StreamGroup_DeprecatedData:6,DgwFrameType_StreamGroup_SmallAck:7,DgwFrameType_StreamGroup_DeprecatedEndOfData:8,DgwFrameType_Ping:9,DgwFrameType_Pong:10,DgwFrameType_StreamGroup_Ack:12,DgwFrameType_StreamGroup_Data:13,DgwFrameType_StreamGroup_EndOfData:14,DgwFrameType_StreamGroup_EstabStream:15});function y(e){switch(e){case h.DgwFrameType_Empty:return"DgwFrameType_Empty";case h.DgwFrameType_Drain:return"DgwFrameType_Drain";case h.DgwFrameType_Deauth:return"DgwFrameType_Deauth";case h.DgwFrameType_StreamGroup_DeprecatedEstabStream:return"DgwFrameType_StreamGroup_DeprecatedEstabStream";case h.DgwFrameType_StreamGroup_DeprecatedData:return"DgwFrameType_StreamGroup_DeprecatedData";case h.DgwFrameType_StreamGroup_SmallAck:return"DgwFrameType_StreamGroup_SmallAck";case h.DgwFrameType_StreamGroup_DeprecatedEndOfData:return"DgwFrameType_StreamGroup_DeprecatedEndOfData";case h.DgwFrameType_Ping:return"DgwFrameType_Ping";case h.DgwFrameType_Pong:return"DgwFrameType_Pong";case h.DgwFrameType_StreamGroup_Ack:return"DgwFrameType_StreamGroup_Ack";case h.DgwFrameType_StreamGroup_Data:return"DgwFrameType_StreamGroup_Data";case h.DgwFrameType_StreamGroup_EndOfData:return"DgwFrameType_StreamGroup_EndOfData";case h.DgwFrameType_StreamGroup_EstabStream:return"DgwFrameType_StreamGroup_EstabStream"}}var C={HEADER_APPID:"x-dgw-appid",HEADER_APPVERSION:"x-dgw-appversion",HEADER_AUTHTYPE:"x-dgw-authtype",HEADER_AUTHTOKEN:"Authorization",HEADER_DEVICE_ID:"x-dgw-deviceid",HEADER_DGW_VERSION:"x-dgw-version",HEADER_LOGGING_ID:"x-dgw-loggingid",HEADER_REGIONHINT:"x-dgw-regionhint",HEADER_TARGET_TIER:"x-dgw-tier",HEADER_UUID:"x-dgw-uuid",HEADER_ESTABLISH_STREAM_FRAME_BASE64:"x-dgw-establish-stream-frame-base64",HEADER_STREAM_TRACE_ID:"x-dgw-streamtraceid",kShadowHeader:"x-dgw-shadow",APPHEADER_PREFIX:"x-dgw-app-",TRAFFIC_TRACING:"_nc_e2e"};i.DEFAULT_ACK_TIMEOUT_MS=l,i.DEFAULT_SERVICE_TIER=s,i.MAX_ACK_ID=u,i.WebsocketCloseCodes=c,i.DrainReason=d,i.drainReasonToDrainReasonString=m,i.DgwVersion=p,i.dgwVersionToString=_,i.DgwCodecReturnCode=f,i.DgwCodecReturnCodeToString=g,i.DgwFrameType=h,i.frameTypeToString=y,i.HEADER_CONSTANTS=C}),66);
__d("DGWEnvUtil",["DGWConstants","URI","WebStorage","cr:975"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u=(function(){function t(){if((e||(e=r("URI"))).isValidURI(window.location.href)){var t=new(e||(e=r("URI")))(window.location.href),n=t.getDomain(),o=c(n,t.getPath()),a=o.endpoint,i=o.authType,l=o.authToken,s=new e().setDomain(a).setProtocol("wss").setPath("/ws");this.$2=i,this.$1=s.toString(),this.$3=l}else this.$1="",this.$2=""}var n=t.prototype;return n.isDGWEnvCompatible=function(){return this.$1.length!==0&&this.$2.length!==0},n.getDGWEndpoint=function(){return this.$1},n.getDGWAuthType=function(){return this.$2},n.getDGWVersion=function(){return o("DGWConstants").DgwVersion.DGWVER_BIG_IDS},n.getDGWAuthToken=function(){return this.$3},t})();function c(e,t){if(e.includes("internalfb.com"))return{endpoint:"gateway.internalfb.com",authType:"INTERNALFB"};if(e.includes("workplace.com"))return{endpoint:"gateway.workplace.com",authType:"FACEBOOK"};if(e.includes("facebookenterprise.com"))return{endpoint:"gateway.facebookenterprise.com",authType:"ENTERPRISEFB"};if(e.includes("metaenterprise.com"))return{endpoint:"gateway.metaenterprise.com",authType:"ENTERPRISEFB"};if(e.includes("facebookrecruiting.com"))return{endpoint:"gateway.facebookrecruiting.com",authType:"RECRUITINGFB"};if(e.includes("metacareers.com"))return{endpoint:"gateway.metacareers.com",authType:"RECRUITINGFB"};if(e.includes("instagram.com"))return{endpoint:"gateway.instagram.com",authType:"INSTAGRAM"};if(e.includes("threads.com"))return{endpoint:"gateway.threads.com",authType:"INSTAGRAM"};if(e.includes("threads.net"))return{endpoint:"gateway.threads.net",authType:"INSTAGRAM"};if(e.includes("facebook.com")){if(t==="/comet_ai/hts_chat"){var o,a=(o=(s||(s=r("WebStorage"))).getSessionStorage())==null?void 0:o.getItem("dgw_auth_token");if(a!=null)return{endpoint:"gateway.facebook.com",authType:"GUEST",authToken:a}}return{endpoint:"gateway.facebook.com",authType:"FACEBOOK"}}if(e.includes("messenger.com"))return{endpoint:"gateway.messenger.com",authType:"FACEBOOK"};if(e.includes("work.meta.com"))return{endpoint:"gateway.work.meta.com",authType:"FACEBOOK"};if(e.includes("horizon.meta.com"))return{endpoint:"gateway.horizon.meta.com",authType:"HORIZON_WEB"};if(e.includes("spark.meta.com"))return{endpoint:"gateway.spark.meta.com",authType:"SPARK_WEB"};if(/^.*developer.*oculus.com.*$/.test(e))return{endpoint:"gateway.oculus.com",authType:"OCULUS"};if(e.includes("developers.meta.com"))return{endpoint:"gateway.developers.meta.com",authType:"OCULUS"};if(e.includes("meta.ai")){var i=n("cr:975")==null?void 0:n("cr:975").accessToken,l=i!=null&&i.length>0;return{authType:l?"GUEST":"ABRA",endpoint:"gateway.meta.ai",authToken:l?i:void 0}}return e.includes("facebook.net")?{endpoint:"gateway.facebook.com",authType:"GUEST"}:{endpoint:"",authType:""}}var d=new u;l.default=d}),98);
__d("DGWStream",["$InternalEnum"],(function(t,n,r,o,a,i){"use strict";var e=n("$InternalEnum").Mirrored(["ABNORMAL_CLOSURE","GOING_AWAY","SERVER_INTERNAL_ERROR","PREMATURE_CLOSE","UNKNOWN_ERROR","KEEPALIVE_TIMEOUT","TRANSPORT_CLOSED_BEFORE_STREAM_INIT","TRANSPORT_ESTABLISHMENT_ERROR","TRANSPORT_ESTABLISHMENT_TIMEOUT","ESTABLISHMENT_TIMEOUT","UNAUTHENTICATED","UNAUTHORIZED","REJECTED","BAD_REQUEST","DGW_SERVER_ERROR","ESTABLISHMENT_ERROR","ACK_TIMEOUT"]);function l(t){switch(t){case e.UNAUTHENTICATED:case e.UNAUTHORIZED:case e.REJECTED:case e.BAD_REQUEST:case e.UNKNOWN_ERROR:case e.SERVER_INTERNAL_ERROR:return!1;default:return!0}}i.StreamError=e,i.isRetryableError=l}),66);
__d("DGWCppBridge",[],(function(t,n,r,o,a,i){var e=(function(){var e=typeof document!="undefined"&&document.currentScript?document.currentScript.src:void 0;return(function(t){t=t||{};var t=typeof t!="undefined"?t:{},n=(function(){function e(){}function t(e,t){return function(){e.apply(t,arguments)}}function n(e){if(!(this instanceof n))throw new TypeError("Promises must be constructed via new");if(typeof e!="function")throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],s(e,this)}function r(e,t){for(;e._state===3;)e=e._value;if(e._state===0){e._deferreds.push(t);return}e._handled=!0,n._immediateFn(function(){var n=e._state===1?t.onFulfilled:t.onRejected;if(n===null){(e._state===1?o:a)(t.promise,e._value);return}var r;try{r=n(e._value)}catch(e){a(t.promise,e);return}o(t.promise,r)})}function o(e,r){try{if(r===e)throw new TypeError("A promise cannot be resolved with itself.");if(r&&(typeof r=="object"||typeof r=="function")){var o=r.then;if(r instanceof n){e._state=3,e._value=r,i(e);return}else if(typeof o=="function"){s(t(o,r),e);return}}e._state=1,e._value=r,i(e)}catch(t){a(e,t)}}function a(e,t){e._state=2,e._value=t,i(e)}function i(e){e._state===2&&e._deferreds.length===0&&n._immediateFn(function(){e._handled||n._unhandledRejectionFn(e._value)});for(var t=0,o=e._deferreds.length;t<o;t++)r(e,e._deferreds[t]);e._deferreds=null}function l(e,t,n){this.onFulfilled=typeof e=="function"?e:null,this.onRejected=typeof t=="function"?t:null,this.promise=n}function s(e,t){var n=!1;try{e(function(e){n||(n=!0,o(t,e))},function(e){n||(n=!0,a(t,e))})}catch(e){if(n)return;n=!0,a(t,e)}}return n.prototype.catch=function(e){return this.then(null,e)},n.prototype.then=function(t,n){var o=new this.constructor(e);return r(this,new l(t,n,o)),o},n.all=function(e){return new n(function(t,n){if(!Array.isArray(e))return n(new TypeError("Promise.all accepts an array"));var r=Array.prototype.slice.call(e);if(r.length===0)return t([]);var o=r.length;function a(e,i){try{if(i&&(typeof i=="object"||typeof i=="function")){var l=i.then;if(typeof l=="function"){l.call(i,function(t){a(e,t)},n);return}}r[e]=i,--o===0&&t(r)}catch(e){n(e)}}for(var i=0;i<r.length;i++)a(i,r[i])})},n.resolve=function(e){return e&&typeof e=="object"&&e.constructor===n?e:new n(function(t){t(e)})},n.reject=function(e){return new n(function(t,n){n(e)})},n.race=function(e){return new n(function(t,r){if(!Array.isArray(e))return r(new TypeError("Promise.race accepts an array"));for(var o=0,a=e.length;o<a;o++)n.resolve(e[o]).then(t,r)})},n._immediateFn=typeof setImmediate=="function"&&function(e){setImmediate(e)}||function(e){setTimeout(e,0)},n._unhandledRejectionFn=function(t){},n})(),r,o;t.ready=new n(function(e,t){r=e,o=t});var a={},i;for(i in t)Object.prototype.hasOwnProperty.call(t,i)&&(a[i]=t[i]);var l=[],s="./this.program",u=function(t,n){throw n},c=!0,d=!1,m="";function p(e){return t.locateFile?t.locateFile(e,m):m+e}var _,f,g,h;typeof document!="undefined"&&document.currentScript&&(m=document.currentScript.src),e&&(m=e),m.indexOf("blob:")!==0?m=m.substr(0,m.lastIndexOf("/")+1):m="",_=function(t){try{var e=new XMLHttpRequest;return e.open("GET",t,!1),e.send(null),e.responseText}catch(e){var n=ge(t);if(n)return pe(n);throw e}},f=function(t,n,r){var e=new XMLHttpRequest;e.open("GET",t,!0),e.responseType="arraybuffer",e.onload=function(){if(e.status==200||e.status==0&&e.response){n(e.response);return}var o=ge(t);if(o){n(o.buffer);return}r()},e.onerror=r,e.send(null)},h=function(t){document.title=t};var y=t.print||console.log.bind(console),C=t.printErr||console.warn.bind(console);for(i in a)Object.prototype.hasOwnProperty.call(a,i)&&(t[i]=a[i]);a=null,t.arguments&&(l=t.arguments),t.thisProgram&&(s=t.thisProgram),t.quit&&(u=t.quit);var b;t.wasmBinary&&(b=t.wasmBinary);var v=t.noExitRuntime||!0,S={Memory:function(t){this.buffer=new ArrayBuffer(t.initial*65536)},Module:function(t){},Instance:function(t,n){this.exports=(function(t){function e(e){return e.set=function(e,t){this[e]=t},e.get=function(e){return this[e]},e}for(var n,r=new Uint8Array(123),o=25;o>=0;--o)r[48+o]=52+o,r[65+o]=o,r[97+o]=26+o;r[43]=62,r[47]=63;function a(e,t,n){for(var o,a,i=0,l=t,s=n.length,u=t+(s*3>>2)-(n[s-2]=="=")-(n[s-1]=="=");i<s;i+=4)o=r[n.charCodeAt(i+1)],a=r[n.charCodeAt(i+2)],e[l++]=r[n.charCodeAt(i)]<<2|o>>4,l<u&&(e[l++]=o<<4|a>>2),l<u&&(e[l++]=a<<6|r[n.charCodeAt(i+3)])}function i(e){a(n,1024,"U3Q5dHlwZV9pbmZvAAAAAOAEAAAABAAATjEwX19jeHhhYml2MTE2X19zaGltX3R5cGVfaW5mb0UAAAAACAUAABgEAAAQBAAATjEwX19jeHhhYml2MTE3X19jbGFzc190eXBlX2luZm9FAAAACAUAAEgEAAA8BAAATjEwX19jeHhhYml2MTE3X19wYmFzZV90eXBlX2luZm9FAAAACAUAAHgEAAA8BAAATjEwX19jeHhhYml2MTE5X19wb2ludGVyX3R5cGVfaW5mb0UACAUAAKgEAACcBAAAAAAAAGwEAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAAHAAAACAAAAAAAAABQBQAAAQAAAAkAAAADAAAABAAAAAUAAAAKAAAACwAAAAwAAABOMTBfX2N4eGFiaXYxMjBfX3NpX2NsYXNzX3R5cGVfaW5mb0UAAAAACAUAACgFAABsBA=="),a(n,1372,"gAkQ")}function l(t){var r=t.a,o=r.buffer;r.grow=Le;var a=new Int8Array(o),l=new Int16Array(o),s=new Int32Array(o),u=new Uint8Array(o),c=new Uint16Array(o),d=new Uint32Array(o),m=new Float32Array(o),p=new Float64Array(o),_=Math.imul,f=Math.fround,g=Math.abs,h=Math.clz32,y=Math.min,C=Math.max,b=Math.floor,v=Math.ceil,S=Math.trunc,R=Math.sqrt,L=t.abort,E=NaN,k=1/0,I=t.b,T=1051008,D=0;function x(e,t,n,r,o,i){e=e|0,t=t|0,n=n|0,r=r|0,o=o|0,i=i|0;var m=0,p=0,f=0;m=T-80|0,T=m,s[m+72>>2]=e,s[m+68>>2]=t,s[m+64>>2]=n,s[m+60>>2]=r,s[m+56>>2]=o,s[m+52>>2]=i;e:{if(!s[m+52>>2]||!s[m+56>>2]|(!s[m+72>>2]|!s[m+68>>2]|(!s[m+64>>2]|!s[m+60>>2]))){s[m+76>>2]=5;break e}s[s[m+64>>2]>>2]=0,s[s[m+60>>2]>>2]=0,t=s[m+68>>2],n=s[m+56>>2],r=s[m+52>>2],e=T+-64|0,T=e,s[e+56>>2]=s[m+72>>2],s[e+52>>2]=t,s[e+48>>2]=n,s[e+44>>2]=r,s[e+40>>2]=0,s[e+36>>2]=s[e+56>>2];t:{n:{r:{for(;;){if(!s[e+52>>2])break n;if(s[e+32>>2]=s[e+36>>2],a[e+31|0]=u[s[e+36>>2]],s[e+52>>2]=s[e+52>>2]-1,s[e+36>>2]=s[e+36>>2]+1,u[e+31|0]==10||u[e+31|0]==2|u[e+31|0]==4|u[e+31|0]==9){s[e+40>>2]=s[e+40>>2]+1;continue}if(s[e+24>>2]=1,J(u[e+31|0])&1){if(p=e,f=ee(u[e+31|0])&1,a[p+23|0]=f,s[e+16>>2]=a[e+23|0]&1?1:2,d[e+52>>2]<d[e+16>>2]){s[s[e+48>>2]>>2]=s[e+32>>2],s[s[e+44>>2]>>2]=s[e+52>>2]+s[e+24>>2];break t}if(s[e+52>>2]=s[e+52>>2]-s[e+16>>2],s[e+24>>2]=s[e+16>>2]+s[e+24>>2],s[e+36>>2]=s[e+16>>2]+s[e+36>>2],!(u[e+31|0]!=14&&u[e+31|0]!=8)){s[e+40>>2]=s[e+40>>2]+1;continue}}if(d[e+52>>2]<3)break r;if(s[e+12>>2]=0,t=s[e+36>>2],n=u[t|0]|u[t+1|0]<<8,a[e+12|0]=n,a[e+13|0]=n>>>8,a[e+14|0]=u[t+2|0],s[e+52>>2]=s[e+52>>2]-3,s[e+24>>2]=s[e+24>>2]+3,s[e+36>>2]=s[e+36>>2]+3,d[e+12>>2]<=d[e+52>>2]){s[e+40>>2]=s[e+40>>2]+1,s[e+36>>2]=s[e+12>>2]+s[e+36>>2],s[e+52>>2]=s[e+52>>2]-s[e+12>>2];continue}break}s[s[e+48>>2]>>2]=s[e+32>>2],s[s[e+44>>2]>>2]=s[e+52>>2]+s[e+24>>2];break t}s[s[e+48>>2]>>2]=s[e+32>>2],s[s[e+44>>2]>>2]=s[e+52>>2]+s[e+24>>2];break t}s[s[e+44>>2]>>2]=s[e+52>>2]}if(s[e+60>>2]=s[e+40>>2],T=e- -64|0,s[m+48>>2]=s[e+60>>2],!s[m+48>>2]){s[m+76>>2]=0;break e}if(p=m,f=$(_(s[m+48>>2],20)),s[p+44>>2]=f,!s[m+44>>2]){s[m+76>>2]=3;break e}for(s[m+40>>2]=s[m+44>>2],s[m+36>>2]=s[m+72>>2],s[m+32>>2]=s[m+68>>2]-s[s[m+52>>2]>>2],s[m+28>>2]=0;;){if(d[m+28>>2]<d[m+48>>2]){if(d[m+32>>2]<1){V(s[m+44>>2],s[m+28>>2]),s[m+76>>2]=1;break e}a[m+27|0]=u[s[m+36>>2]],s[m+36>>2]=s[m+36>>2]+1,s[m+32>>2]=s[m+32>>2]-1;t:{if(!u[m+27|0]|u[m+27|0]==1|(u[m+27|0]==2|u[m+27|0]==3)|(u[m+27|0]==4|u[m+27|0]==9|u[m+27|0]==10)||J(u[m+27|0])&1)break t;V(s[m+44>>2],s[m+28>>2]),s[m+76>>2]=6;break e}e=s[m+40>>2],s[e>>2]=u[m+27|0]&15|s[e>>2]&-16;t:{if(u[m+27|0]==10||u[m+27|0]==2|u[m+27|0]==4|u[m+27|0]==9){e=s[m+40>>2],s[e>>2]=s[e>>2]&-268435441,s[m+40>>2]=s[m+40>>2]+20;break t}if(J(u[m+27|0])&1){e=T-48|0,T=e,s[e+40>>2]=s[m+40>>2],s[e+36>>2]=m+36,s[e+32>>2]=m+32;n:{if(!(J(s[s[e+40>>2]>>2]&15)&1)){s[e+44>>2]=1;break n}if(p=e,f=ee(s[s[e+40>>2]>>2]&15)&1,a[p+31|0]=f,s[e+24>>2]=a[e+31|0]&1?1:2,d[s[e+32>>2]>>2]<d[e+24>>2]){s[e+44>>2]=1;break n}if(ae(s[e+40>>2]+4|0,s[s[e+36>>2]>>2],s[e+24>>2]),t=s[e+36>>2],s[t>>2]=s[e+24>>2]+s[t>>2],t=s[e+32>>2],s[t>>2]=s[t>>2]-s[e+24>>2],(s[s[e+40>>2]>>2]&15)==8){t=s[e+40>>2],s[t>>2]=s[t>>2]&-268435441,s[e+44>>2]=0;break n}if((s[s[e+40>>2]>>2]&15)==14){t=s[e+40>>2],s[t>>2]=s[t>>2]&-268435441,s[e+44>>2]=0;break n}if(d[s[e+32>>2]>>2]<3){s[e+44>>2]=11;break n}if(s[e+20>>2]=0,t=s[s[e+36>>2]>>2],n=u[t|0]|u[t+1|0]<<8,a[e+20|0]=n,a[e+21|0]=n>>>8,a[e+22|0]=u[t+2|0],t=s[e+36>>2],s[t>>2]=s[t>>2]+3,t=s[e+32>>2],s[t>>2]=s[t>>2]-3,t=s[e+40>>2],s[t>>2]=s[t>>2]&-268435441|(s[e+20>>2]&16777215)<<4,d[s[e+32>>2]>>2]<d[e+20>>2]){s[e+44>>2]=11;break n}if((s[s[e+40>>2]>>2]&15)==15){if(s[s[e+40>>2]+12>>2]=s[e+20>>2],t=$(s[e+20>>2]),s[s[e+40>>2]+8>>2]=t,!s[s[e+40>>2]+8>>2]){s[e+44>>2]=3;break n}ae(s[s[e+40>>2]+8>>2],s[s[e+36>>2]>>2],s[e+20>>2]),t=s[e+36>>2],s[t>>2]=s[e+20>>2]+s[t>>2],t=s[e+32>>2],s[t>>2]=s[t>>2]-s[e+20>>2],s[e+44>>2]=0;break n}if((s[s[e+40>>2]>>2]&15)==5){if(s[s[e+40>>2]+12>>2]=s[e+20>>2],t=$(s[e+20>>2]),s[s[e+40>>2]+8>>2]=t,!s[s[e+40>>2]+8>>2]){s[e+44>>2]=3;break n}ae(s[s[e+40>>2]+8>>2],s[s[e+36>>2]>>2],s[e+20>>2]),t=s[e+36>>2],s[t>>2]=s[e+20>>2]+s[t>>2],t=s[e+32>>2],s[t>>2]=s[t>>2]-s[e+20>>2],s[e+44>>2]=0;break n}r:{if(!((s[s[e+40>>2]>>2]&15)!=6&&(s[s[e+40>>2]>>2]&15)!=7)){if(p=e,f=G(s[e+36>>2],s[e+32>>2],e+19|0,e+18|0),s[p+12>>2]=f,s[e+12>>2]){s[e+44>>2]=s[e+12>>2];break n}break r}if(!((s[s[e+40>>2]>>2]&15)!=13&&(s[s[e+40>>2]>>2]&15)!=12)){n=s[e+32>>2],t=T-32|0,s[t+24>>2]=s[e+36>>2],s[t+20>>2]=n,s[t+16>>2]=e+19,s[t+12>>2]=e+16,l[t+10>>1]=0;o:{if(d[s[t+20>>2]>>2]<2){s[t+28>>2]=1;break o}n=s[s[t+24>>2]>>2],n=u[n|0]|u[n+1|0]<<8,a[t+10|0]=n,a[t+11|0]=n>>>8,n=s[t+24>>2],s[n>>2]=s[n>>2]+2,n=s[t+20>>2],s[n>>2]=s[n>>2]-2,a[s[t+16>>2]]=(c[t+10>>1]&32768)==32768,l[s[t+12>>2]>>1]=c[t+10>>1]&32767,s[t+28>>2]=0}if(s[e+12>>2]=s[t+28>>2],s[e+12>>2]){s[e+44>>2]=s[e+12>>2];break n}}}if((s[s[e+40>>2]>>2]&15)==12){t=s[e+40>>2],l[t+8>>1]=l[t+8>>1]&1|c[e+16>>1]<<1,s[e+44>>2]=0;break n}if((s[s[e+40>>2]>>2]&15)==7){t=s[e+40>>2],a[t+8|0]=a[t+8|0]&1|u[e+18|0]<<1,s[e+44>>2]=0;break n}if((s[s[e+40>>2]>>2]&15)==13){n=s[e+32>>2],r=s[e+20>>2],o=s[e+40>>2]+12|0,i=s[e+40>>2],t=T-32|0,T=t,s[t+24>>2]=s[e+36>>2],s[t+20>>2]=n,s[t+16>>2]=r,s[t+12>>2]=o,s[t+8>>2]=i+16;r:{if(d[t+16>>2]<2){s[t+28>>2]=9;break r}if(s[s[t+8>>2]>>2]=s[t+16>>2]-2,d[s[t+20>>2]>>2]<d[s[t+8>>2]>>2]){s[t+28>>2]=1;break r}if(n=$(s[s[t+8>>2]>>2]),s[s[t+12>>2]>>2]=n,!s[s[t+12>>2]>>2]){s[t+28>>2]=3;break r}ae(s[s[t+12>>2]>>2],s[s[t+24>>2]>>2],s[s[t+8>>2]>>2]),n=s[t+24>>2],s[n>>2]=s[s[t+8>>2]>>2]+s[n>>2],n=s[t+20>>2],s[n>>2]=s[n>>2]-s[s[t+8>>2]>>2],s[t+28>>2]=0}if(T=t+32|0,s[e+8>>2]=s[t+28>>2],s[e+8>>2]){s[e+44>>2]=s[e+8>>2];break n}t=s[e+40>>2],l[t+8>>1]=a[e+19|0]&1|c[t+8>>1]&65534,t=s[e+40>>2],l[t+8>>1]=l[t+8>>1]&1|c[e+16>>1]<<1,s[e+44>>2]=0;break n}if((s[s[e+40>>2]>>2]&15)==6){if(p=e,f=q(s[e+36>>2],s[e+32>>2],s[e+20>>2],s[e+40>>2]+12|0,s[e+40>>2]+16|0),s[p+4>>2]=f,s[e+4>>2]){s[e+44>>2]=s[e+4>>2];break n}t=s[e+40>>2],a[t+8|0]=a[e+19|0]&1|u[t+8|0]&254,t=s[e+40>>2],a[t+8|0]=a[t+8|0]&1|u[e+18|0]<<1,s[e+44>>2]=0;break n}s[e+44>>2]=1}if(T=e+48|0,s[m+20>>2]=s[e+44>>2],!s[m+20>>2]){s[m+40>>2]=s[m+40>>2]+20;break t}V(s[m+44>>2],s[m+28>>2]),s[m+76>>2]=s[m+20>>2];break e}if(s[m+16>>2]=0,d[m+32>>2]<3){V(s[m+44>>2],s[m+28>>2]),s[m+76>>2]=1;break e}if(e=s[m+36>>2],t=u[e|0]|u[e+1|0]<<8,a[m+16|0]=t,a[m+17|0]=t>>>8,a[m+18|0]=u[e+2|0],s[m+36>>2]=s[m+36>>2]+3,s[m+32>>2]=s[m+32>>2]-3,!(s[m+16>>2]==1|u[m+27|0]!=1)){V(s[m+44>>2],s[m+28>>2]),s[m+76>>2]=7;break e}if(e=s[m+40>>2],s[e>>2]=s[e>>2]&-268435441|(s[m+16>>2]&16777215)<<4,u[m+27|0]==3){if(s[m+16>>2]!=1){V(s[m+44>>2],s[m+28>>2]),s[m+76>>2]=10;break e}if(a[m+15|0]=0,d[m+32>>2]<1){O(s[m+44>>2]),s[m+76>>2]=1;break e}a[m+15|0]=u[s[m+36>>2]],s[m+36>>2]=s[m+36>>2]+1,s[m+32>>2]=s[m+32>>2]-1;n:{if(u[m+15|0]<=4){a[s[m+40>>2]+4|0]=u[m+15|0];break n}a[s[m+40>>2]+4|0]=4}s[m+40>>2]=s[m+40>>2]+20;break t}if(p=m,f=G(m+36|0,m+32|0,m+14|0,m+13|0),s[p+8>>2]=f,s[m+8>>2]){V(s[m+44>>2],s[m+28>>2]),s[m+76>>2]=s[m+8>>2];break e}if(u[m+27|0]==1){e=s[m+40>>2],a[e+4|0]=a[e+4|0]&1|u[m+13|0]<<1,s[m+40>>2]=s[m+40>>2]+20;break t}if(!u[m+27|0]){if(p=m,f=q(m+36|0,m+32|0,s[m+16>>2],s[m+40>>2]+8|0,s[m+40>>2]+12|0),s[p+4>>2]=f,s[m+4>>2]){V(s[m+44>>2],s[m+28>>2]),s[m+76>>2]=s[m+4>>2];break e}e=s[m+40>>2],a[e+4|0]=a[m+14|0]&1|u[e+4|0]&254,e=s[m+40>>2],a[e+4|0]=a[e+4|0]&1|u[m+13|0]<<1,s[m+40>>2]=s[m+40>>2]+20}}s[m+28>>2]=s[m+28>>2]+1;continue}break}if(s[m+32>>2]){V(s[m+44>>2],s[m+48>>2]),s[m+76>>2]=1;break e}s[s[m+64>>2]>>2]=s[m+44>>2],s[s[m+60>>2]>>2]=s[m+48>>2],s[m+76>>2]=0}return T=m+80|0,s[m+76>>2]}function $(e){var t=0,n=0,r=0,o=0,a=0,i=0,l=0,u=0,c=0,d=0,m=0;c=8;e:{t:{if(e>>>0>4294967239)break t;for(;;){c=c>>>0>8?c:8,n=s[603],a=n,o=s[602],l=o,e=e>>>0>8?e+3&-4:8;n:{if(e>>>0<=127){i=(e>>>3|0)-1|0;break n}if(r=h(e),i=((e>>>29-r^4)-(r<<2)|0)+110|0,e>>>0<=4095)break n;r=((e>>>30-r^2)-(r<<1)|0)+71|0,i=r>>>0<63?r:63}if(t=i,r=t&31,(t&63)>>>0>=32?(t=0,n=n>>>r|0):(t=n>>>r|0,n=((1<<r)-1&n)<<32-r|l>>>r),r=t,n|t){for(;;){a=n,t=r;n:{if(t|n){o=t-1|0,u=o+1|0,l=o,o=n-1|0,l=(o|0)!=-1?u:l,o=h(n^o)+32|0,n=h(t^l),n=(n|0)==32?o:n,t=63-n|0,D=0-(n>>>0>63)|0;break n}D=0,t=64}o=t,t=o,n=t&31,(t&63)>>>0>=32?(t=0,l=r>>>n|0):(t=r>>>n|0,l=((1<<n)-1&r)<<32-n|a>>>n),r=t,i=o+i|0,a=i<<4,t=s[a+1384>>2],o=a+1376|0;n:{if((t|0)!=(o|0)){if(n=F(t,c,e),n)break t;n=s[t+4>>2],s[n+8>>2]=s[t+8>>2],s[s[t+8>>2]+4>>2]=n,s[t+8>>2]=o,n=a+1380|0,s[t+4>>2]=s[n>>2],s[n>>2]=t,s[s[t+4>>2]+8>>2]=t,i=i+1|0,n=(r&1)<<31|l>>>1,r=r>>>1|0;break n}d=s[603],t=i,u=t&63,n=u,a=n&31,n>>>0>=32?(n=0,o=-1>>>a|0):(n=-1>>>a|0,o=(1<<a)-1<<32-a|-1>>>a),o=o&-2,a=u&31,u>>>0>=32?(n=o<<a,u=0):(n=(1<<a)-1&o>>>32-a|n<<a,u=o<<a),a=n,o=0-t&63,n=o,t=n&31,n>>>0>=32?(n=-1<<t,t=0):(n=(1<<t)-1&-1>>>32-t|-1<<t,t=-1<<t),m=t&-2,t=o&31,o>>>0>=32?(o=0,t=n>>>t|0):(o=n>>>t|0,t=((1<<t)-1&n)<<32-t|m>>>t),n=t|u,D=a|o,s[602]=s[602]&n,s[603]=D&d,n=l^1}if(!(n|r))break}o=s[602],a=s[603]}n:{if(a|o){r=h(a),r=63-((r|0)==32?h(o)+32|0:r)<<4,t=r+1376|0,r=s[r+1384>>2];r:{if(!a&o>>>0<1073741824||(i=98,(t|0)==(r|0)))break r;for(;;){if(n=F(r,c,e),n)break t;if(r=s[r+8>>2],!i)break r;if(i=i-1|0,(t|0)==(r|0))break}}if(M(e+48|0))break n;if(!r|(t|0)==(r|0))break e;for(;;){if(n=F(r,c,e),n)break t;if(r=s[r+8>>2],(t|0)==(r|0))break}break e}if(!M(e+48|0))break e}if(n=0,e>>>0>4294967239)break t;for(r=c,t=0;;){if(i=t,r){r=r-1&r,t=t+1|0;continue}break}if(!(i>>>0<=1))break}}return n}return 0}function P(e,t,n,r,o,i,m){e=e|0,t=t|0,n=n|0,r=r|0,o=o|0,i=i|0,m=m|0;var p=0,_=0,f=0;p=T-32|0,T=p,l[p+26>>1]=e,s[p+20>>2]=t,s[p+16>>2]=n,a[p+15|0]=r,l[p+12>>1]=o,s[p+8>>2]=i,s[p+4>>2]=m;e:{if(!(!(a[p+15|0]&1)|c[p+12>>1]<=32767)){s[p+28>>2]=4;break e}t=s[p+20>>2],n=s[p+16>>2],r=s[p+8>>2],o=s[p+4>>2],i=a[p+15|0]&1,e=T+-64|0,T=e,s[e+56>>2]=p+26,s[e+52>>2]=t,s[e+48>>2]=n,s[e+44>>2]=r,s[e+40>>2]=o,a[e+39|0]=2,a[e+38|0]=13,s[e+32>>2]=p+12,a[e+31|0]=i,a[e+30|0]=2;t:{n:{if(!(!s[e+52>>2]|(!s[e+44>>2]|!s[e+40>>2]))&&d[e+48>>2]<=16777215)break n;s[e+60>>2]=5;break t}if(s[e+24>>2]=s[e+48>>2]+(u[e+39|0]+(u[e+30|0]+4|0)|0),_=e,f=$(s[e+24>>2]),s[_+20>>2]=f,!s[e+20>>2]){s[e+60>>2]=3;break t}if(s[e+16>>2]=s[e+20>>2],a[s[e+16>>2]]=u[e+38|0],s[e+16>>2]=s[e+16>>2]+1,ae(s[e+16>>2],s[e+56>>2],u[e+30|0]),s[e+16>>2]=u[e+30|0]+s[e+16>>2],s[e+12>>2]=u[e+39|0]+s[e+48>>2],d[e+12>>2]<d[e+48>>2]){O(s[e+20>>2]),s[e+60>>2]=9;break t}if(t=s[e+16>>2],n=u[e+12|0]|u[e+13|0]<<8,a[t|0]=n,a[t+1|0]=n>>>8,a[t+2|0]=u[e+14|0],s[e+16>>2]=s[e+16>>2]+3,a[e+31|0]&1)n:{if(u[e+38|0]==6){t=s[e+32>>2],a[t|0]=u[t|0]|128;break n}r:{if(u[e+38|0]==13){t=s[e+32>>2],l[t>>1]=c[t>>1]|32768;break r}O(s[e+20>>2]),s[e+60>>2]=1;break t}}ae(s[e+16>>2],s[e+32>>2],u[e+39|0]),s[e+16>>2]=u[e+39|0]+s[e+16>>2],ae(s[e+16>>2],s[e+52>>2],s[e+48>>2]),s[s[e+44>>2]>>2]=s[e+20>>2],s[s[e+40>>2]>>2]=s[e+24>>2],s[e+60>>2]=0}T=e- -64|0,s[p+28>>2]=s[e+60>>2]}return T=p+32|0,s[p+28>>2]}function N(e,t,n,r,o){e=e|0,t=t|0,n=n|0,r=r|0,o=o|0;var i=0,c=0,m=0;i=T-32|0,T=i,l[i+30>>1]=e,s[i+24>>2]=t,s[i+20>>2]=n,s[i+16>>2]=r,s[i+12>>2]=o,t=s[i+24>>2],n=s[i+20>>2],r=s[i+16>>2],o=s[i+12>>2],e=T-48|0,T=e,s[e+40>>2]=i+30,s[e+36>>2]=t,s[e+32>>2]=n,s[e+28>>2]=r,s[e+24>>2]=o,a[e+23|0]=2,a[e+22|0]=15;e:{if(!(s[e+24>>2]&&s[e+28>>2])){s[e+44>>2]=5;break e}if(s[s[e+28>>2]>>2]=0,s[s[e+24>>2]>>2]=0,!(d[e+32>>2]<=16777215&&s[e+36>>2])){s[e+44>>2]=5;break e}if(s[e+16>>2]=s[e+32>>2]+(u[e+23|0]+4|0),c=e,m=$(s[e+16>>2]),s[c+12>>2]=m,!s[e+12>>2]){s[e+44>>2]=3;break e}s[e+8>>2]=s[e+12>>2],a[s[e+8>>2]]=u[e+22|0],s[e+8>>2]=s[e+8>>2]+1,ae(s[e+8>>2],s[e+40>>2],u[e+23|0]),s[e+8>>2]=u[e+23|0]+s[e+8>>2],t=s[e+8>>2],n=u[e+32|0]|u[e+33|0]<<8,a[t|0]=n,a[t+1|0]=n>>>8,a[t+2|0]=u[e+34|0],s[e+8>>2]=s[e+8>>2]+3,ae(s[e+8>>2],s[e+36>>2],s[e+32>>2]),s[e+8>>2]=s[e+32>>2]+s[e+8>>2],s[s[e+28>>2]>>2]=s[e+12>>2],s[s[e+24>>2]>>2]=s[e+16>>2],s[e+44>>2]=0}return T=e+48|0,T=i+32|0,s[e+44>>2]}function M(e){var t=0,n=0,r=0,o=0,i=0,l=0;r=s[343],n=e+3&-4,t=r+n|0;e:{t:{if(t>>>0<=r>>>0&&n||t>>>0>Re()<<16>>>0&&!(I(t|0)|0))break t;s[343]=t;break e}s[604]=48,r=-1}if((r|0)!=-1){n=e+r|0,t=n-16|0,s[t+12>>2]=16,s[t>>2]=16,e=s[600],e?l=s[e+8>>2]:l=0;e:{t:{if((l|0)==(r|0)){if(o=r-(s[r-4>>2]&-2)|0,i=s[o-4>>2],s[e+8>>2]=n,e=o-(i&-2)|0,n=-16,!(a[(e+s[e>>2]|0)-4|0]&1))break t;n=s[e+4>>2],s[n+8>>2]=s[e+8>>2],s[s[e+8>>2]+4>>2]=n,t=t-e|0,s[e>>2]=t;break e}s[r+12>>2]=16,s[r>>2]=16,s[r+8>>2]=n,s[r+4>>2]=e,s[600]=r,n=16}e=r+n|0,t=t-e|0,s[e>>2]=t}s[((t&-4)+e|0)-4>>2]=t|1,l=e,o=s[e>>2]-8|0;e:{if(o>>>0<=127){t=(o>>>3|0)-1|0;break e}if(i=h(o),t=((o>>>29-i^4)-(i<<2)|0)+110|0,o>>>0<=4095)break e;t=((o>>>30-i^2)-(i<<1)|0)+71|0,t=t>>>0<63?t:63}n=t<<4,s[l+4>>2]=n+1376,n=n+1384|0,s[e+8>>2]=s[n>>2],s[n>>2]=e,s[s[e+8>>2]+4>>2]=e,n=s[603],e=t&31,(t&63)>>>0>=32?(t=1<<e,e=0):(t=(1<<e)-1&1>>>32-e,e=1<<e),s[602]=e|s[602],s[603]=t|n}return(r|0)!=-1}function w(e,t,n,r){e=e|0,t=t|0,n=n|0,r=r|0;var o=0,i=0,d=0;o=T-16|0,T=o,l[o+10>>1]=e,l[o+8>>1]=t,s[o+4>>2]=n,s[o>>2]=r;e:{if(c[o+8>>1]>32767){s[o+12>>2]=4;break e}t=s[o+4>>2],n=s[o>>2],e=T-48|0,T=e,s[e+40>>2]=o+10,s[e+36>>2]=t,s[e+32>>2]=n,a[e+31|0]=2,a[e+30|0]=12,s[e+24>>2]=o+8,a[e+23|0]=2;t:{if(!(s[e+32>>2]&&s[e+36>>2])){s[e+44>>2]=5;break t}if(s[e+16>>2]=u[e+31|0]+(u[e+23|0]+4|0),i=e,d=$(s[e+16>>2]),s[i+12>>2]=d,!s[e+12>>2]){s[e+44>>2]=3;break t}s[e+8>>2]=s[e+12>>2],a[s[e+8>>2]]=u[e+30|0],s[e+8>>2]=s[e+8>>2]+1,ae(s[e+8>>2],s[e+40>>2],u[e+23|0]),s[e+8>>2]=u[e+23|0]+s[e+8>>2],s[e+4>>2]=u[e+31|0],t=s[e+8>>2],n=u[e+4|0]|u[e+5|0]<<8,a[t|0]=n,a[t+1|0]=n>>>8,a[t+2|0]=u[e+6|0],s[e+8>>2]=s[e+8>>2]+3,ae(s[e+8>>2],s[e+24>>2],u[e+31|0]),s[s[e+32>>2]>>2]=s[e+16>>2],s[s[e+36>>2]>>2]=s[e+12>>2],s[e+44>>2]=0}T=e+48|0,s[o+12>>2]=s[e+44>>2]}return T=o+16|0,s[o+12>>2]}function A(e,t,n){e=e|0,t=t|0,n=n|0;var r=0,o=0,a=0,i=0,l=0;a=T+-64|0,T=a,o=1;e:{if(j(e,t,0)||(o=0,!t))break e;r=T+-64|0,T=r,o=s[t>>2],i=s[o-4>>2],l=s[o-8>>2],s[r+20>>2]=0,s[r+16>>2]=1084,s[r+12>>2]=t,s[r+8>>2]=1132,o=0,ie(r+24|0,39),t=t+l|0;t:{if(j(i,1132,0)){s[r+56>>2]=1,Se[s[s[i>>2]+20>>2]](i,r+8|0,t,t,1,0),o=s[r+32>>2]==1?t:0;break t}Se[s[s[i>>2]+24>>2]](i,r+8|0,t,1,0);n:switch(s[r+44>>2]){case 0:o=s[r+48>>2]==1&&s[r+36>>2]==1&&s[r+40>>2]==1?s[r+28>>2]:0;break t;case 1:break n;default:break t}if(s[r+48>>2]|s[r+36>>2]!=1|s[r+40>>2]!=1&&s[r+32>>2]!=1)break t;o=s[r+24>>2]}if(T=r- -64|0,t=o,o=0,!t)break e;ie(a+8|4,52),s[a+56>>2]=1,s[a+20>>2]=-1,s[a+16>>2]=e,s[a+8>>2]=t,Se[s[s[t>>2]+28>>2]](t,a+8|0,s[n>>2],1),e=s[a+32>>2],(e|0)==1&&(s[n>>2]=s[a+24>>2]),o=(e|0)==1}return e=o,T=a- -64|0,e|0}function F(e,t,n){var r=0,o=0,a=0,i=0;if(r=e+4|0,o=(r+t|0)-1&0-t,t=s[e>>2],o+n>>>0<=(t+e|0)-4>>>0){a=s[e+4>>2],s[a+8>>2]=s[e+8>>2],s[s[e+8>>2]+4>>2]=a,(r|0)!=(o|0)&&(o=o-r|0,a=e-(s[e-4>>2]&-2)|0,r=o+s[a>>2]|0,s[a>>2]=r,s[(a+(r&-4)|0)-4>>2]=r,e=e+o|0,t=t-o|0,s[e>>2]=t);e:{if(n+24>>>0<=t>>>0){r=(e+n|0)+8|0,t=(t-n|0)-8|0,s[r>>2]=t,s[(r+(t&-4)|0)-4>>2]=t|1,i=r,a=s[r>>2]-8|0;t:{if(a>>>0<=127){o=(a>>>3|0)-1|0;break t}if(t=h(a),o=((a>>>29-t^4)-(t<<2)|0)+110|0,a>>>0<=4095)break t;t=((a>>>30-t^2)-(t<<1)|0)+71|0,o=t>>>0<63?t:63}t=o,o=t<<4,s[i+4>>2]=o+1376,o=o+1384|0,s[r+8>>2]=s[o>>2],s[o>>2]=r,s[s[r+8>>2]+4>>2]=r,o=s[603],r=t&31,(t&63)>>>0>=32?(t=1<<r,i=0):(t=(1<<r)-1&1>>>32-r,i=1<<r),s[602]=i|s[602],s[603]=t|o,t=n+8|0,s[e>>2]=t,s[((t&-4)+e|0)-4>>2]=t;break e}s[(e+t|0)-4>>2]=t}e=e+4|0}else e=0;return e}function O(e){var t=0,n=0,r=0,o=0,a=0;if(e){n=e-4|0,o=s[n>>2],r=o,t=n,a=s[e-8>>2],e=a&-2,(e|0)!=(a|0)&&(t=n-e|0,r=s[t+4>>2],s[r+8>>2]=s[t+8>>2],s[s[t+8>>2]+4>>2]=r,r=e+o|0),e=n+o|0,n=s[e>>2],(n|0)!=s[(e+n|0)-4>>2]&&(o=s[e+4>>2],s[o+8>>2]=s[e+8>>2],s[s[e+8>>2]+4>>2]=o,r=r+n|0),s[t>>2]=r,s[((r&-4)+t|0)-4>>2]=r|1,a=t,r=s[t>>2]-8|0;e:{if(r>>>0<=127){e=(r>>>3|0)-1|0;break e}if(o=h(r),e=((r>>>29-o^4)-(o<<2)|0)+110|0,r>>>0<=4095)break e;e=((r>>>30-o^2)-(o<<1)|0)+71|0,e=e>>>0<63?e:63}n=e<<4,s[a+4>>2]=n+1376,n=n+1384|0,s[t+8>>2]=s[n>>2],s[n>>2]=t,s[s[t+8>>2]+4>>2]=t,n=s[603],t=e&31,(e&63)>>>0>=32?(e=1<<t,t=0):(e=(1<<t)-1&1>>>32-t,t=1<<t),s[602]=t|s[602],s[603]=e|n}}function B(e,t,n){e=e|0,t=t|0,n=n|0;var r=0,o=0,i=0;r=T-48|0,T=r,s[r+40>>2]=e,s[r+36>>2]=t,s[r+32>>2]=n;e:{if(!(s[r+32>>2]&&s[r+36>>2])){s[r+44>>2]=5;break e}if(d[r+40>>2]>4){s[r+44>>2]=8;break e}if(s[r+28>>2]=5,o=r,i=$(s[r+28>>2]),s[o+24>>2]=i,!s[r+24>>2]){s[r+44>>2]=3;break e}s[r+20>>2]=s[r+24>>2],a[r+19|0]=3,a[s[r+20>>2]]=u[r+19|0],s[r+20>>2]=s[r+20>>2]+1,s[r+12>>2]=1,e=s[r+20>>2],t=u[r+12|0]|u[r+13|0]<<8,a[e|0]=t,a[e+1|0]=t>>>8,a[e+2|0]=u[r+14|0],s[r+20>>2]=s[r+20>>2]+3,a[r+11|0]=s[r+40>>2],a[s[r+20>>2]]=u[r+11|0],s[s[r+36>>2]>>2]=s[r+24>>2],s[s[r+32>>2]>>2]=s[r+28>>2],s[r+44>>2]=0}return T=r+48|0,s[r+44>>2]}function W(e,t,n,r,o){if(e=e|0,t=t|0,n=n|0,r=r|0,o=o|0,j(e,s[t+8>>2],o)){se(t,n,r);return}e:{if(j(e,s[t>>2],o)){if(!(s[t+20>>2]!=(n|0)&&s[t+16>>2]!=(n|0))){if((r|0)!=1)break e;s[t+32>>2]=1;return}s[t+32>>2]=r;t:{if(s[t+44>>2]==4)break t;if(l[t+52>>1]=0,e=s[e+8>>2],Se[s[s[e>>2]+20>>2]](e,t,n,n,1,o),u[t+53|0]){if(s[t+44>>2]=3,!u[t+52|0])break t;break e}s[t+44>>2]=4}if(s[t+20>>2]=n,s[t+40>>2]=s[t+40>>2]+1,s[t+36>>2]!=1|s[t+24>>2]!=2)break e;a[t+54|0]=1;return}e=s[e+8>>2],Se[s[s[e>>2]+24>>2]](e,t,n,r,o)}}function q(e,t,n,r,o){var a=0;a=T-32|0,T=a,s[a+24>>2]=e,s[a+20>>2]=t,s[a+16>>2]=n,s[a+12>>2]=r,s[a+8>>2]=o;e:{if(d[a+16>>2]<1){s[a+28>>2]=9;break e}if(s[s[a+8>>2]>>2]=s[a+16>>2]-1,d[s[a+20>>2]>>2]<d[s[a+8>>2]>>2]){s[a+28>>2]=1;break e}if(e=$(s[s[a+8>>2]>>2]),s[s[a+12>>2]>>2]=e,!s[s[a+12>>2]>>2]){s[a+28>>2]=3;break e}ae(s[s[a+12>>2]>>2],s[s[a+24>>2]>>2],s[s[a+8>>2]>>2]),e=s[a+24>>2],s[e>>2]=s[s[a+8>>2]>>2]+s[e>>2],e=s[a+20>>2],s[e>>2]=s[e>>2]-s[s[a+8>>2]>>2],s[a+28>>2]=0}return T=a+32|0,s[a+28>>2]}function U(e,t,n){e=e|0,t=t|0,n=n|0;var r=0,o=0,i=0;r=T-32|0,T=r,l[r+26>>1]=e,s[r+20>>2]=t,s[r+16>>2]=n,s[s[r+16>>2]>>2]=3,o=r,i=$(s[s[r+16>>2]>>2]),s[o+12>>2]=i;e:{if(!s[r+12>>2]){s[r+28>>2]=3;break e}s[s[r+20>>2]>>2]=s[r+12>>2],a[r+11|0]=14,a[s[r+12>>2]]=u[r+11|0],s[r+12>>2]=s[r+12>>2]+1,e=s[r+12>>2],t=u[r+26|0]|u[r+27|0]<<8,a[e|0]=t,a[e+1|0]=t>>>8,s[r+28>>2]=0}return T=r+32|0,s[r+28>>2]}function V(e,t){var n=0;for(n=T-16|0,T=n,s[n+12>>2]=e,s[n+8>>2]=t,s[n+4>>2]=0;;){if(d[n+4>>2]<d[n+8>>2]){s[n>>2]=s[n+12>>2]+_(s[n+4>>2],20);e:{if(!(s[s[n>>2]>>2]&15)){O(s[s[n>>2]+8>>2]);break e}t:{if((s[s[n>>2]>>2]&15)==5){O(s[s[n>>2]+8>>2]);break t}(s[s[n>>2]>>2]&15)==6&&O(s[s[n>>2]+12>>2])}}s[n+4>>2]=s[n+4>>2]+1;continue}break}O(s[n+12>>2]),T=n+16|0}function H(e,t,n,r){a[e+53|0]=1;e:{if(s[e+4>>2]!=(n|0))break e;if(a[e+52|0]=1,n=s[e+16>>2],!n){if(s[e+36>>2]=1,s[e+24>>2]=r,s[e+16>>2]=t,(r|0)!=1|s[e+48>>2]!=1)break e;a[e+54|0]=1;return}if((t|0)==(n|0)){if(n=s[e+24>>2],(n|0)==2&&(s[e+24>>2]=r,n=r),s[e+48>>2]!=1|(n|0)!=1)break e;a[e+54|0]=1;return}a[e+54|0]=1,s[e+36>>2]=s[e+36>>2]+1}}function G(e,t,n,r){var o=0;o=T-32|0,s[o+24>>2]=e,s[o+20>>2]=t,s[o+16>>2]=n,s[o+12>>2]=r,a[o+11|0]=0;e:{if(d[s[o+20>>2]>>2]<1){s[o+28>>2]=1;break e}a[o+11|0]=u[s[s[o+24>>2]>>2]],e=s[o+24>>2],s[e>>2]=s[e>>2]+1,e=s[o+20>>2],s[e>>2]=s[e>>2]-1,a[s[o+16>>2]]=(u[o+11|0]&128)==128,a[s[o+12>>2]]=u[o+11|0]&127,s[o+28>>2]=0}return s[o+28>>2]}function z(e,t,n,r,o){if(e=e|0,t=t|0,n=n|0,r=r|0,o=o|0,j(e,s[t+8>>2],o)){se(t,n,r);return}e:{if(!j(e,s[t>>2],o))break e;if(!(s[t+20>>2]!=(n|0)&&s[t+16>>2]!=(n|0))){if((r|0)!=1)break e;s[t+32>>2]=1;return}s[t+20>>2]=n,s[t+32>>2]=r,s[t+40>>2]=s[t+40>>2]+1,s[t+36>>2]!=1|s[t+24>>2]!=2||(a[t+54|0]=1),s[t+44>>2]=4}}function j(e,t,n){var r=0;if(!n)return s[e+4>>2]==s[t+4>>2];if((e|0)==(t|0))return 1;n=s[e+4>>2],e=u[n|0],t=s[t+4>>2],r=u[t|0];e:{if(!e|(r|0)!=(e|0))break e;for(;;){if(r=u[t+1|0],e=u[n+1|0],!e)break e;if(t=t+1|0,n=n+1|0,(e|0)!=(r|0))break}}return(e|0)==(r|0)}function K(e,t){e=e|0,t=t|0;var n=0,r=0,o=0;n=T-32|0,T=n,s[n+24>>2]=e,s[n+20>>2]=t,r=n,o=$(1),s[r+16>>2]=o;e:{if(!s[n+16>>2]){s[n+28>>2]=3;break e}a[n+15|0]=9,a[s[n+16>>2]]=u[n+15|0],s[s[n+24>>2]>>2]=s[n+16>>2],s[s[n+20>>2]>>2]=1,s[n+28>>2]=0}return T=n+32|0,s[n+28>>2]}function Q(e,t){e=e|0,t=t|0;var n=0,r=0,o=0;n=T-32|0,T=n,s[n+24>>2]=e,s[n+20>>2]=t,r=n,o=$(1),s[r+16>>2]=o;e:{if(!s[n+16>>2]){s[n+28>>2]=3;break e}a[n+15|0]=10,a[s[n+16>>2]]=u[n+15|0],s[s[n+24>>2]>>2]=s[n+16>>2],s[s[n+20>>2]>>2]=1,s[n+28>>2]=0}return T=n+32|0,s[n+28>>2]}function X(e,t){e=e|0,t=t|0;var n=0,r=0,o=0;n=T-32|0,T=n,s[n+24>>2]=e,s[n+20>>2]=t,r=n,o=$(1),s[r+16>>2]=o;e:{if(!s[n+16>>2]){s[n+28>>2]=3;break e}a[n+15|0]=2,a[s[n+16>>2]]=u[n+15|0],s[s[n+24>>2]>>2]=s[n+16>>2],s[s[n+20>>2]>>2]=1,s[n+28>>2]=0}return T=n+32|0,s[n+28>>2]}function Y(e,t){e=e|0,t=t|0;var n=0,r=0,o=0;n=T-32|0,T=n,s[n+24>>2]=e,s[n+20>>2]=t,r=n,o=$(1),s[r+16>>2]=o;e:{if(!s[n+16>>2]){s[n+28>>2]=3;break e}a[n+15|0]=4,a[s[n+16>>2]]=u[n+15|0],s[s[n+24>>2]>>2]=s[n+16>>2],s[s[n+20>>2]>>2]=1,s[n+28>>2]=0}return T=n+32|0,s[n+28>>2]}function J(e){var t=0;t=T-16|0,T=t,s[t+12>>2]=e,e=1;e:{if(ee(s[t+12>>2])&1||(e=1,s[t+12>>2]==15)||(e=1,s[t+12>>2]==13)||(e=1,s[t+12>>2]==12))break e;e=s[t+12>>2]==14}return T=t+16|0,e}function Z(e,t,n){var r=0;if(r=s[e+16>>2],!r){s[e+36>>2]=1,s[e+24>>2]=n,s[e+16>>2]=t;return}e:{if((t|0)==(r|0)){if(s[e+24>>2]!=2)break e;s[e+24>>2]=n;return}a[e+54|0]=1,s[e+24>>2]=2,s[e+36>>2]=s[e+36>>2]+1}}function ee(e){var t=0;t=T-16|0,s[t+12>>2]=e,e=1;e:{if(s[t+12>>2]==5||(e=1,s[t+12>>2]==6)||(e=1,s[t+12>>2]==7))break e;e=s[t+12>>2]==8}return e}function te(e,t,n,r,o,a){if(e=e|0,t=t|0,n=n|0,r=r|0,o=o|0,a=a|0,j(e,s[t+8>>2],a)){H(t,n,r,o);return}e=s[e+8>>2],Se[s[s[e>>2]+20>>2]](e,t,n,r,o,a)}function ne(){for(var e=0,t=0,n=0;t=e<<4,n=t+1376|0,s[t+1380>>2]=n,s[t+1384>>2]=n,e=e+1|0,(e|0)!=64;);M(48)}function re(e,t,n,r){if(e=e|0,t=t|0,n=n|0,r=r|0,j(e,s[t+8>>2],0)){Z(t,n,r);return}e=s[e+8>>2],Se[s[s[e>>2]+28>>2]](e,t,n,r)}function oe(e,t,n,r,o,a){e=e|0,t=t|0,n=n|0,r=r|0,o=o|0,a=a|0,j(e,s[t+8>>2],a)&&H(t,n,r,o)}function ae(e,t,n){if(n)for(;a[e|0]=u[t|0],e=e+1|0,t=t+1|0,n=n-1|0,!!n;);}function ie(e,t){if(t)for(;a[e|0]=0,e=e+1|0,t=t-1|0,!!t;);}function le(e,t,n,r){e=e|0,t=t|0,n=n|0,r=r|0,j(e,s[t+8>>2],0)&&Z(t,n,r)}function se(e,t,n){s[e+28>>2]==1|s[e+4>>2]!=(t|0)||(s[e+28>>2]=n)}function ue(e,t){return e=e|0,t=t|0,_(t,20)+e|0}function ce(e){return e=e|0,c[e+8>>1]>>>1|0}function de(e){return e=e|0,l[e+8>>1]&1}function me(e){return e=e|0,s[e+12>>2]}function pe(e){return e=e|0,s[e>>2]&15}function _e(e){return e=e|0,s[e+16>>2]}function fe(e){return e=e|0,c[e+4>>1]}function ge(e){return e=e|0,s[e+8>>2]}function he(e){return e=e|0,u[e+4|0]}function ye(e){return e=e|0,e|0}function Ce(e){return $(e)}function be(e){e=e|0,O(e)}function ve(e){e=e|0}n=u,i(t);var Se=e([null,ye,be,ve,ve,A,oe,z,le,be,te,W,re]);function Re(){return o.byteLength/65536|0}function Le(e){e=e|0;var t=Re()|0,i=t+e|0;if(t<i&&i<65536){var f=new ArrayBuffer(_(i,65536)),g=new Int8Array(f);g.set(a),a=new Int8Array(f),l=new Int16Array(f),s=new Int32Array(f),u=new Uint8Array(f),c=new Uint16Array(f),d=new Uint32Array(f),m=new Float32Array(f),p=new Float64Array(f),o=f,r.buffer=o,n=u}return t}return{c:ne,d:Ce,e:be,f:X,g:Y,h:B,i:N,j:U,k:P,l:w,m:K,n:Q,o:x,p:pe,q:he,r:ue,s:fe,t:ge,u:me,v:me,w:_e,x:ce,y:de,z:ce,A:Se}}return l(t)})(he)},instantiate:function(t,n){return{then:function(n){var e=new S.Module(t);n({instance:new S.Instance(e)})}}},RuntimeError:Error};b=[],typeof S!="object"&&ne("no native wasm support detected");var R,L=!1,E;function k(e,t){e||ne("Assertion failed: "+t)}function I(e,t){return e%t>0&&(e+=t-e%t),e}var T,D,x,$,P,N,M,w,A;function F(e){T=e,t.HEAP8=D=new Int8Array(e),t.HEAP16=$=new Int16Array(e),t.HEAP32=N=new Int32Array(e),t.HEAPU8=x=new Uint8Array(e),t.HEAPU16=P=new Uint16Array(e),t.HEAPU32=M=new Uint32Array(e),t.HEAPF32=w=new Float32Array(e),t.HEAPF64=A=new Float64Array(e)}var O=t.INITIAL_MEMORY||2097152;t.wasmMemory?R=t.wasmMemory:R=new S.Memory({initial:O/65536,maximum:32768}),R&&(T=R.buffer),O=T.byteLength,F(T);var B,W=[],q=[],U=[],V=!1;function H(){if(t.preRun)for(typeof t.preRun=="function"&&(t.preRun=[t.preRun]);t.preRun.length;)j(t.preRun.shift());ue(W)}function G(){V=!0,ue(q)}function z(){if(t.postRun)for(typeof t.postRun=="function"&&(t.postRun=[t.postRun]);t.postRun.length;)Q(t.postRun.shift());ue(U)}function j(e){W.unshift(e)}function K(e){q.unshift(e)}function Q(e){U.unshift(e)}if((!Math.imul||Math.imul(4294967295,5)!==-5)&&(Math.imul=function(t,n){var e=t>>>16,r=t&65535,o=n>>>16,a=n&65535;return r*a+(e*a+r*o<<16)|0}),!Math.fround){var X=new Float32Array(1);Math.fround=function(e){return X[0]=e,X[0]}}Math.clz32||(Math.clz32=function(e){var t=32,n=e>>16;return n&&(t-=16,e=n),n=e>>8,n&&(t-=8,e=n),n=e>>4,n&&(t-=4,e=n),n=e>>2,n&&(t-=2,e=n),n=e>>1,n?t-2:t-e}),Math.trunc||(Math.trunc=function(e){return e<0?Math.ceil(e):Math.floor(e)});var Y=0,J=null,Z=null;function ee(e){Y++,t.monitorRunDependencies&&t.monitorRunDependencies(Y)}function te(e){if(Y--,t.monitorRunDependencies&&t.monitorRunDependencies(Y),Y==0&&(J!==null&&(clearInterval(J),J=null),Z)){var n=Z;Z=null,n()}}t.preloadedImages={},t.preloadedAudios={};function ne(e){t.onAbort&&t.onAbort(e),e+="",C(e),L=!0,E=1,e="abort("+e+"). Build with -s ASSERTIONS=1 for more info.";var n=new S.RuntimeError(e);throw o(n),n}var re="data:application/octet-stream;base64,";function oe(e){return e.startsWith(re)}var ae="dgwcppbridge.wasm";oe(ae)||(ae=p(ae));function ie(e){try{if(e==ae&&b)return new Uint8Array(b);var t=ge(e);if(t)return t;if(g)return g(e);throw"both async and sync fetching of the wasm failed"}catch(e){ne(e)}}function le(){return!b&&(c||d)&&typeof fetch=="function"?fetch(ae,{credentials:"same-origin"}).then(function(e){if(!e.ok)throw"failed to load wasm binary file at '"+ae+"'";return e.arrayBuffer()}).catch(function(){return ie(ae)}):n.resolve().then(function(){return ie(ae)})}function se(){var e={a:he};function n(e,n){var r=e.exports;t.asm=r,B=t.asm.A,K(t.asm.c),te("wasm-instantiate")}ee("wasm-instantiate");function r(e){n(e.instance)}function a(t){return le().then(function(t){var n=S.instantiate(t,e);return n}).then(t,function(e){C("failed to asynchronously prepare wasm: "+e),ne(e)})}function i(){return!b&&typeof S.instantiateStreaming=="function"&&!oe(ae)&&typeof fetch=="function"?fetch(ae,{credentials:"same-origin"}).then(function(t){var n=S.instantiateStreaming(t,e);return n.then(r,function(e){return C("wasm streaming compile failed: "+e),C("falling back to ArrayBuffer instantiation"),a(r)})}):a(r)}if(t.instantiateWasm)try{var l=t.instantiateWasm(e,n);return l}catch(e){return C("Module.instantiateWasm callback failed with error: "+e),!1}return i().catch(o),{}}function ue(e){for(;e.length>0;){var n=e.shift();if(typeof n=="function"){n(t);continue}var r=n.func;typeof r=="number"?n.arg===void 0?B.get(r)():B.get(r)(n.arg):r(n.arg===void 0?null:n.arg)}}function ce(e){try{return R.grow(e-T.byteLength+65535>>>16),F(R.buffer),1}catch(e){}}function de(e){var t=x.length;e=e>>>0;var n=2147483648;if(e>n)return!1;for(var r=1;r<=4;r*=2){var o=t*(1+.2/r);o=Math.min(o,e+100663296);var a=Math.min(n,I(Math.max(e,o),65536)),i=ce(a);if(i)return!0}return!1}var me=!1;function pe(e){for(var t=[],n=0;n<e.length;n++){var r=e[n];r>255&&(r&=255),t.push(String.fromCharCode(r))}return t.join("")}var _e=typeof atob=="function"?atob:function(e){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",n="",r,o,a,i,l,s,u,c=0;e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");do i=t.indexOf(e.charAt(c++)),l=t.indexOf(e.charAt(c++)),s=t.indexOf(e.charAt(c++)),u=t.indexOf(e.charAt(c++)),r=i<<2|l>>4,o=(l&15)<<4|s>>2,a=(s&3)<<6|u,n=n+String.fromCharCode(r),s!==64&&(n=n+String.fromCharCode(o)),u!==64&&(n=n+String.fromCharCode(a));while(c<e.length);return n};function fe(e){try{for(var t=_e(e),n=new Uint8Array(t.length),r=0;r<t.length;++r)n[r]=t.charCodeAt(r);return n}catch(e){throw new Error("Converting base64 string to bytes failed.")}}function ge(e){if(oe(e))return fe(e.slice(re.length))}var he={b:de,a:R},ye=se(),Ce=t.___wasm_call_ctors=function(){return(Ce=t.___wasm_call_ctors=t.asm.c).apply(null,arguments)},be=t.__malloc=function(){return(be=t.__malloc=t.asm.d).apply(null,arguments)},ve=t.__free=function(){return(ve=t.__free=t.asm.e).apply(null,arguments)},Se=t.__DgwCodecEncodeEmpty=function(){return(Se=t.__DgwCodecEncodeEmpty=t.asm.f).apply(null,arguments)},Re=t.__DgwCodecEncodeDeauth=function(){return(Re=t.__DgwCodecEncodeDeauth=t.asm.g).apply(null,arguments)},Le=t.__DgwCodecEncodeDrain=function(){return(Le=t.__DgwCodecEncodeDrain=t.asm.h).apply(null,arguments)},Ee=t.__DgwCodecEncodeStreamGroup_EstabStream=function(){return(Ee=t.__DgwCodecEncodeStreamGroup_EstabStream=t.asm.i).apply(null,arguments)},ke=t.__DgwCodecEncodeStreamGroup_EndOfData=function(){return(ke=t.__DgwCodecEncodeStreamGroup_EndOfData=t.asm.j).apply(null,arguments)},Ie=t.__DgwCodecEncodeStreamGroup_Data=function(){return(Ie=t.__DgwCodecEncodeStreamGroup_Data=t.asm.k).apply(null,arguments)},Te=t.__DgwCodecEncodeStreamGroup_Ack=function(){return(Te=t.__DgwCodecEncodeStreamGroup_Ack=t.asm.l).apply(null,arguments)},De=t.__DgwCodecEncodePing=function(){return(De=t.__DgwCodecEncodePing=t.asm.m).apply(null,arguments)},xe=t.__DgwCodecEncodePong=function(){return(xe=t.__DgwCodecEncodePong=t.asm.n).apply(null,arguments)},$e=t.__DgwCodecDecode=function(){return($e=t.__DgwCodecDecode=t.asm.o).apply(null,arguments)},Pe=t.__getFrameType=function(){return(Pe=t.__getFrameType=t.asm.p).apply(null,arguments)},Ne=t.__getDrainReasonFromDrainFrame=function(){return(Ne=t.__getDrainReasonFromDrainFrame=t.asm.q).apply(null,arguments)},Me=t.__getDGWFramePtr=function(){return(Me=t.__getDGWFramePtr=t.asm.r).apply(null,arguments)},we=t.__getStreamIdFromStreamGroupFrame=function(){return(we=t.__getStreamIdFromStreamGroupFrame=t.asm.s).apply(null,arguments)},Ae=t.__getEncodedParamsFromEstablishStreamFrame=function(){return(Ae=t.__getEncodedParamsFromEstablishStreamFrame=t.asm.t).apply(null,arguments)},Fe=t.__getEncodedParamsSizeFromEstablishStreamFrame=function(){return(Fe=t.__getEncodedParamsSizeFromEstablishStreamFrame=t.asm.u).apply(null,arguments)},Oe=t.__getDataFromGroupedStreamDataFrame=function(){return(Oe=t.__getDataFromGroupedStreamDataFrame=t.asm.v).apply(null,arguments)},Be=t.__getDataSizeFromGroupedStreamDataFrame=function(){return(Be=t.__getDataSizeFromGroupedStreamDataFrame=t.asm.w).apply(null,arguments)},We=t.__getAckIdFromGroupedStreamDataFrame=function(){return(We=t.__getAckIdFromGroupedStreamDataFrame=t.asm.x).apply(null,arguments)},qe=t.__getRequiresAckFromGroupedStreamDataFrame=function(){return(qe=t.__getRequiresAckFromGroupedStreamDataFrame=t.asm.y).apply(null,arguments)},Ue=t.__getAckIdFromGroupedStreamAckFrame=function(){return(Ue=t.__getAckIdFromGroupedStreamAckFrame=t.asm.z).apply(null,arguments)},Ve;Z=function e(){Ve||He(),Ve||(Z=e)};function He(e){if(e=e||l,Y>0||(H(),Y>0))return;function n(){Ve||(Ve=!0,t.calledRun=!0,!L&&(G(),r(t),t.onRuntimeInitialized&&t.onRuntimeInitialized(),z()))}t.setStatus?(t.setStatus("Running..."),setTimeout(function(){setTimeout(function(){t.setStatus("")},1),n()},1)):n()}if(t.run=He,t.preInit)for(typeof t.preInit=="function"&&(t.preInit=[t.preInit]);t.preInit.length>0;)t.preInit.pop()();return He(),t.ready})})();typeof i=="object"&&typeof a=="object"?a.exports=e:typeof define=="function"&&define.amd?define([],function(){return e}):typeof i=="object"&&(i.Module=e)}),null);
__d("DGWUtils",["Base64","DGWConstants","DGWCppBridge","DGWLoggingContext","Promise","Random","URI","asyncToGeneratorRuntime","getErrorSafe"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u=4;function c(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=o("Random").random()*16|0,n=e==="x"?t:t&3|8;return n.toString(16)})}function d(e){var t=new TextDecoder,n=t.decode(e),o=r("Base64").encode(n),a=o.replace(/\+/gi,"-").replace(/\//gi,"_").replace(/=/gi,"");return a}var m=null,p=null;function _(){return p==null&&(p=(s||(s=n("Promise"))).resolve().then(function(){return r("DGWCppBridge")()}).then(function(e){m=e})),p}var f=(function(){function t(){}return t.initialize=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){return _()});function t(){return e.apply(this,arguments)}return t})(),t.constructConnectUrl=function(n){var t,a,i=n.appId,l=n.appVersion,s=n.authType,u=n.deviceId,c=n.dgwVersion,m=n.fbId,p=n.tier,_=n.loggingId,f=n.headers,g=n.endpoint,h=n.serviceId,y=n.regionHint,C=n.establishStreamFrame,b=n.trafficTracing,v=n.authToken,S=(t={},t[(a=o("DGWConstants")).HEADER_CONSTANTS.HEADER_APPID]=i,t[a.HEADER_CONSTANTS.HEADER_APPVERSION]=l,t[a.HEADER_CONSTANTS.HEADER_AUTHTYPE]=s,t[a.HEADER_CONSTANTS.HEADER_DGW_VERSION]=""+c,t[a.HEADER_CONSTANTS.HEADER_UUID]=m,t[a.HEADER_CONSTANTS.HEADER_TARGET_TIER]=p,t);C!==void 0&&(S[o("DGWConstants").HEADER_CONSTANTS.HEADER_ESTABLISH_STREAM_FRAME_BASE64]=d(C)),_!==void 0&&(S[o("DGWConstants").HEADER_CONSTANTS.HEADER_LOGGING_ID]=_),y!==void 0&&(S[o("DGWConstants").HEADER_CONSTANTS.HEADER_REGIONHINT]=y),u!==void 0&&(S[o("DGWConstants").HEADER_CONSTANTS.HEADER_DEVICE_ID]=u),b!==void 0&&(S[o("DGWConstants").HEADER_CONSTANTS.TRAFFIC_TRACING]="debug:"+b),v!==void 0&&(S[o("DGWConstants").HEADER_CONSTANTS.HEADER_AUTHTOKEN]=v),Object.keys(f).forEach(function(e){var t=o("DGWConstants").HEADER_CONSTANTS.APPHEADER_PREFIX+e;Object.prototype.hasOwnProperty.call(S,t)||(S[t]=f[e])});var R=new(e||(e=r("URI")))(g);return R.setQueryData(S),R.setPath(R.getPath()+"/"+h),R.toString().length>2e3&&(delete S[o("DGWConstants").HEADER_CONSTANTS.HEADER_ESTABLISH_STREAM_FRAME_BASE64],R.setQueryData(S)),R.toStringRawQuery()},t})(),g=(function(){function e(e,t,n){this.$1=null,this.$2=e,this.$3=t,this.$4=n}e.initialize=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){return _()});function t(){return e.apply(this,arguments)}return t})();var t=e.prototype;return t.malloc=function(t){try{var e=m.__malloc(t);if(e===0){var n;return(n=this.$2)==null||n.logError(o("DGWLoggingContext").DGWLoggingComponent.CODEC_COMPONENT,"wasm malloc failure","malloc returned 0"),-1}return e}catch(e){var a;return(a=this.$2)==null||a.logError(o("DGWLoggingContext").DGWLoggingComponent.CODEC_COMPONENT,"wasm malloc failure","exception during malloc",r("getErrorSafe")(e).message),-1}},t.free=function(t){m.__free(t)},t.append=function(t){if(this.$1==null){this.$1=t;return}var e=this.$1.length,n=new Uint8Array(e+t.length);n.set(this.$1,0),n.set(t,e),this.$1=n},t.processData=function(){var e=this;if(this.$1!=null){var t=this.$1.length,n=this.malloc(t);if(n!==-1){var r=m.HEAPU8.subarray(n,n+t);if(this.$1)for(var a=0;a<r.length;++a)r[a]=this.$1[a];var i=this.malloc(u*4);if(i!==-1){var l=i,s=l+u,c=s+u,d=c+u,p=m.__DgwCodecDecode(n,t,l,s,c,d);if(this.free(n),p!==o("DGWConstants").DgwCodecReturnCode.DgwCodecReturnCode_Success){var _;this.free(i),(_=this.$2)==null||_.logError(o("DGWLoggingContext").DGWLoggingComponent.CODEC_COMPONENT,"Codec Decode Failure","Failed to decode Frame(s). Received error code "+o("DGWConstants").DgwCodecReturnCodeToString(p));return}var f=m.HEAPU32.subarray(d/u,d/u+1)[0];if(this.$1==null){this.free(i);return}var g=this.$1.length-f;if(this.$1&&this.$1.length>g){var h;this.$1=new Uint8Array(((h=this.$1)==null?void 0:h.subarray(g))||[])}else this.$1=null;for(var y=m.HEAPU32.subarray(s/u,s/u+1)[0],C=m.HEAPU32.subarray(l/u,l/u+1)[0],b=[],v=function(){var t=m.__getDGWFramePtr(C,S),n=m.__getFrameType(t);switch(n){case o("DGWConstants").DgwFrameType.DgwFrameType_Drain:{var r,a=m.__getDrainReasonFromDrainFrame(t),i=o("DGWConstants").drainReasonToDrainReasonString(a);(r=e.$2)==null||r.logEvent(o("DGWLoggingContext").DGWLoggingComponent.CODEC_COMPONENT,"Received Drain Frame from server","DrainReason: "+i),b.push(function(){var t;return(t=e.$3)==null?void 0:t.receivedDrainSignal(i)});break}case o("DGWConstants").DgwFrameType.DgwFrameType_StreamGroup_EstabStream:{var l=m.__getStreamIdFromStreamGroupFrame(t),s=m.__getEncodedParamsFromEstablishStreamFrame(t),u=new Uint8Array(m.HEAPU8.subarray(s,s+m.__getEncodedParamsSizeFromEstablishStreamFrame(t)));e.free(s),b.push(function(){var t;return(t=e.$3)==null?void 0:t.onGroupedStreamEstablishStreamReceived(l,u)});break}case o("DGWConstants").DgwFrameType.DgwFrameType_StreamGroup_Data:{var c=m.__getStreamIdFromStreamGroupFrame(t),d=m.__getDataFromGroupedStreamDataFrame(t),p=new Uint8Array(m.HEAPU8.subarray(d,d+m.__getDataSizeFromGroupedStreamDataFrame(t)));e.free(d);var _=m.__getRequiresAckFromGroupedStreamDataFrame(t)?m.__getAckIdFromGroupedStreamDataFrame(t):null;b.push(function(){var t;return(t=e.$3)==null?void 0:t.onGroupedStreamDataReceived(c,p,_)});break}case o("DGWConstants").DgwFrameType.DgwFrameType_StreamGroup_Ack:{var f=m.__getStreamIdFromStreamGroupFrame(t),g=m.__getAckIdFromGroupedStreamAckFrame(t);b.push(function(){var t;return(t=e.$3)==null?void 0:t.onGroupedStreamAckReceived(f,g)});break}case o("DGWConstants").DgwFrameType.DgwFrameType_StreamGroup_EndOfData:{var h=m.__getStreamIdFromStreamGroupFrame(t);b.push(function(){var t;return(t=e.$3)==null?void 0:t.onGroupedStreamEndOfDataReceived(h)});break}case o("DGWConstants").DgwFrameType.DgwFrameType_Ping:{b.push(function(){var t;return(t=e.$3)==null?void 0:t.onPingReceived()});break}case o("DGWConstants").DgwFrameType.DgwFrameType_Pong:{b.push(function(){var t;return(t=e.$3)==null?void 0:t.onPongReceived()});break}default:break}e.free(t)},S=0;S<y;++S)v();this.free(i);for(var R=0;R<b.length;R++)b[R]()}}}},t.encodeData=function(t,n,r,a){var e=this.malloc(t.length);if(e===-1)return null;for(var i=m.HEAPU8.subarray(e,e+t.length),l=0;l<i.length;++l)i[l]=t[l];var s=this.malloc(u*2),c=s,d=s+u,p=m.__DgwCodecEncodeStreamGroup_Data(a,e,i.length,n,r,c,d);if(this.free(e),p!==o("DGWConstants").DgwCodecReturnCode.DgwCodecReturnCode_Success){var _;return(_=this.$2)==null||_.logError(o("DGWLoggingContext").DGWLoggingComponent.CODEC_COMPONENT,"Data Frame encode failure","Failed to decode DGW Data Frame. Received error code "+o("DGWConstants").DgwCodecReturnCodeToString(p)),null}var f=m.HEAPU32.subarray(c/u,c/u+1)[0],g=m.HEAPU32.subarray(d/u,d/u+1)[0],h=new Uint8Array(m.HEAPU8.subarray(f,f+g));return this.free(f),this.free(s),h},t.encodeAck=function(t,n){var e=this.malloc(u*2);if(e===-1)return null;var r=e,a=e+u,i=m.__DgwCodecEncodeStreamGroup_Ack(n,t,r,a);if(i!==o("DGWConstants").DgwCodecReturnCode.DgwCodecReturnCode_Success){var l;return(l=this.$2)==null||l.logError(o("DGWLoggingContext").DGWLoggingComponent.CODEC_COMPONENT,"ACK Frame encode failure","Failed to encode ACK Frame. Received error code "+o("DGWConstants").DgwCodecReturnCodeToString(i)),null}var s=m.HEAPU32.subarray(r/u,r/u+1)[0],c=m.HEAPU32.subarray(a/u,a/u+1)[0],d=new Uint8Array(m.HEAPU8.subarray(s,s+c));return this.free(s),this.free(e),d},t.encodeDrain=function(t){var e=this.malloc(u*2);if(e===-1)return null;var n=e,r=e+u,a=m.__DgwCodecEncodeDrain(t,n,r);if(a!==o("DGWConstants").DgwCodecReturnCode.DgwCodecReturnCode_Success){var i;return(i=this.$2)==null||i.logError(o("DGWLoggingContext").DGWLoggingComponent.CODEC_COMPONENT,"Drain Frame encode failure","Failed to encode Drain Frame. Received error code "+o("DGWConstants").DgwCodecReturnCodeToString(a)),null}var l=m.HEAPU32.subarray(n/u,n/u+1)[0],s=m.HEAPU32.subarray(r/u,r/u+1)[0],c=new Uint8Array(m.HEAPU8.subarray(l,l+s));return this.free(l),this.free(e),c},t.encodeEstablishStream=function(t,n){var e=this.malloc(n.length);if(e===-1)return null;for(var r=m.HEAPU8.subarray(e,e+n.length),a=0;a<n.length;++a)r[a]=n[a];var i=this.malloc(u*2),l=i,s=i+u,c=m.__DgwCodecEncodeStreamGroup_EstabStream(t,e,n.length,l,s);if(this.free(e),c!==o("DGWConstants").DgwCodecReturnCode.DgwCodecReturnCode_Success){var d;return(d=this.$2)==null||d.logError(o("DGWLoggingContext").DGWLoggingComponent.CODEC_COMPONENT,"EstablishStream Frame encode failure","Failed to encode EstablishStream Frame. Received error code "+o("DGWConstants").DgwCodecReturnCodeToString(c)+" for StreamId "+t),null}var p=m.HEAPU32.subarray(l/u,l/u+1)[0],_=m.HEAPU32.subarray(s/u,s/u+1)[0],f=new Uint8Array(m.HEAPU8.subarray(p,p+_));return this.free(p),this.free(i),f},t.encodeEndOfData=function(t){var e=this.malloc(u*2);if(e===-1)return null;var n=e,r=e+u,a=m.__DgwCodecEncodeStreamGroup_EndOfData(t,n,r);if(a!==o("DGWConstants").DgwCodecReturnCode.DgwCodecReturnCode_Success){var i;return(i=this.$2)==null||i.logError(o("DGWLoggingContext").DGWLoggingComponent.CODEC_COMPONENT,"EndOfData Frame encode failure","Failed to encode EndOfData Frame. Received error code "+o("DGWConstants").DgwCodecReturnCodeToString(a)),null}var l=m.HEAPU32.subarray(n/u,n/u+1)[0],s=m.HEAPU32.subarray(r/u,r/u+1)[0],c=new Uint8Array(m.HEAPU8.subarray(l,l+s));return this.free(l),this.free(e),c},t.encodePing=function(){var e=this.malloc(u*2);if(e===-1)return null;var t=e,n=e+u,r=m.__DgwCodecEncodePing(t,n);if(r!==o("DGWConstants").DgwCodecReturnCode.DgwCodecReturnCode_Success){var a;return(a=this.$2)==null||a.logError(o("DGWLoggingContext").DGWLoggingComponent.CODEC_COMPONENT,"Ping Frame encode failure","Failed to encode Ping Frame. Received error code "+o("DGWConstants").DgwCodecReturnCodeToString(r)),null}var i=m.HEAPU32.subarray(t/u,t/u+1)[0],l=m.HEAPU32.subarray(n/u,n/u+1)[0],s=new Uint8Array(m.HEAPU8.subarray(i,i+l));return this.free(i),this.free(e),s},t.encodePong=function(){if(this.$5!=null)return this.$5;var e=this.malloc(u*2);if(e===-1)return null;var t=e,n=e+u,r=m.__DgwCodecEncodePong(t,n);if(r!==o("DGWConstants").DgwCodecReturnCode.DgwCodecReturnCode_Success){var a;return(a=this.$2)==null||a.logError(o("DGWLoggingContext").DGWLoggingComponent.CODEC_COMPONENT,"Pong Frame encode failure","Failed to encode Pong Frame. Received error code "+o("DGWConstants").DgwCodecReturnCodeToString(r)),null}var i=m.HEAPU32.subarray(t/u,t/u+1)[0],l=m.HEAPU32.subarray(n/u,n/u+1)[0],s=new Uint8Array(m.HEAPU8.subarray(i,i+l));return this.free(i),this.free(e),this.$5=s,s},e})();l.uuidv4=c,l.Uint8ArrayToBase64UrlStr=d,l.DGWUtils=f,l.DGWCodec=g}),98);
__d("DGWExponentialBackoff",["Promise","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i){"use strict";var e,l={maxRetries:5,baseRetryInterval:1e3,backoffFactor:Math.sqrt(2)},s=(function(e){function t(t,n){var r;return r=e.call(this,t)||this,r.errors=n,r}return babelHelpers.inheritsLoose(t,e),t})(babelHelpers.wrapNativeSuper(Error));function u(e,t){return c.apply(this,arguments)}function c(){return c=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){t===void 0&&(t=l);try{return yield d(e,t)}catch(e){throw e.errors[e.errors.length-1]}}),c.apply(this,arguments)}function d(e,t){return m.apply(this,arguments)}function m(){return m=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){for(var n=0,r=[],o=t.baseRetryInterval,a=t.backoffFactor;n<=t.maxRetries;){try{var i=yield e();return i}catch(e){r.push(e)}yield p(o*Math.pow(a,n)),++n}throw new s("Max call count exceeded",r)}),m.apply(this,arguments)}function p(e){return _.apply(this,arguments)}function _(){return _=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){yield new(e||(e=n("Promise")))(function(e){return window.setTimeout(e,t)})}),_.apply(this,arguments)}i.callWithExponentialBackoff=u}),66);
__d("DGWGlobalLogger",["gkx","uuidv4"],(function(t,n,r,o,a,i,l){"use strict";var e=(function(){function e(){var e=this;this.tabID=r("uuidv4")(),this.isTabClosed=!1,this.otherTabs=new Map,this.thisTab={realtime:0,lightspeed:0},this.broadcastChannel=this.$1("DGWGlobalLogger"),this.broadcastChannel.onmessage=function(t){var n=JSON.parse(String(t.data)),r=!e.otherTabs.has(n.key);n.event==="DELETE"?e.otherTabs.delete(n.key):n.event==="UPDATE"&&n.value!=null&&(e.otherTabs.set(n.key,n.value),r&&e.$2())}}var t=e.prototype;return t.$1=function(t){return window.BroadcastChannel!=null?new BroadcastChannel(t):{onmessage:function(t){},postMessage:function(t){}}},t.streamRequested=function(t){switch(t){case"realtime":this.thisTab.realtime++;break;case"lightspeed":this.thisTab.lightspeed++;break}this.$2()},t.streamClosed=function(t){switch(t){case"realtime":this.thisTab.realtime=Math.max(0,this.thisTab.realtime-1);break;case"lightspeed":this.thisTab.lightspeed=Math.max(0,this.thisTab.lightspeed-1);break}this.$2()},t.tabClosed=function(){if(!this.isTabClosed){this.isTabClosed=!0;var e={key:this.tabID,event:"DELETE"};this.broadcastChannel.postMessage(JSON.stringify(e))}},t.getGlobalState=function(){var e={realtime:this.thisTab.realtime,lightspeed:this.thisTab.lightspeed};return this.otherTabs.forEach(function(t){e.realtime+=t.realtime,e.lightspeed+=t.lightspeed}),e},t.$2=function(){var e={key:this.tabID,event:"UPDATE",value:this.thisTab};this.broadcastChannel.postMessage(JSON.stringify(e))},e})(),s=r("gkx")("4337")?new e:{streamRequested:function(){},streamClosed:function(){},tabClosed:function(){},getGlobalState:function(){return{realtime:-1,lightspeed:-1}}},u=function(){return s};l.getInstance=u}),98);
__d("DGWPinger",["DGWLoggingContext"],(function(t,n,r,o,a,i,l){"use strict";var e=(function(){function e(e,t,n){this.$1=e,this.$4=t,this.$5=n,this.$3=!1}var t=e.prototype;return t.$6=function(){var e=this;if(this.$3){var t;(t=o("DGWLoggingContext")).DGWLoggingContext.bumpODSKey(t.DGWLoggingComponent.PINGER,"timeout_fired.reset"),this.$3=!1,this.$4(),t.DGWLoggingContext.bumpODSKey(t.DGWLoggingComponent.PINGER,"timeout.newtimeout"),this.$2=window.setTimeout(function(){e.$6()},this.$1)}else o("DGWLoggingContext").DGWLoggingContext.bumpODSKey(o("DGWLoggingContext").DGWLoggingComponent.PINGER,"timeout_fired.disconnect"),this.$5()},t.reset=function(){var e=this;this.$3=!0,this.$2&&(o("DGWLoggingContext").DGWLoggingContext.bumpODSKey(o("DGWLoggingContext").DGWLoggingComponent.PINGER,"reset"),window.clearTimeout(this.$2),this.$2=null),this.$1>0&&(o("DGWLoggingContext").DGWLoggingContext.bumpODSKey(o("DGWLoggingContext").DGWLoggingComponent.PINGER,"reset.newtimeout"),this.$2=window.setTimeout(function(){e.$6()},this.$1))},t.cancel=function(){this.$2&&(o("DGWLoggingContext").DGWLoggingContext.bumpODSKey(o("DGWLoggingContext").DGWLoggingComponent.PINGER,"canceled"),window.clearTimeout(this.$2),this.$2=null)},e})();l.DGWPinger=e}),98);
__d("DGWStreamGroupCallbacks",["$InternalEnum"],(function(t,n,r,o,a,i){"use strict";var e=n("$InternalEnum")({TRANSPORT_SERVER_INTERNAL_ERROR:0,TRANSPORT_ABNORMAL_CLOSURE:1,TRANSPORT_GOING_AWAY:2,TRANSPORT_UNKNOWN_ERROR:3,TRANSPORT_KEEPALIVE_TIMEOUT:4,TRANSPORT_UNAUTHORIZED:5,TRANSPORT_REJECTED:6,TRANSPORT_BAD_REQUEST:7,TRANSPORT_DGW_SERVER_ERROR:8,TRANSPORT_NORMAL_CLOSURE:9});function l(t){switch(t){case e.TRANSPORT_SERVER_INTERNAL_ERROR:return"TRANSPORT_SERVER_INTERNAL_ERROR";case e.TRANSPORT_ABNORMAL_CLOSURE:return"TRANSPORT_ABNORMAL_CLOSURE";case e.TRANSPORT_GOING_AWAY:return"TRANSPORT_GOING_AWAY";case e.TRANSPORT_UNKNOWN_ERROR:return"TRANSPORT_UNKNOWN_ERROR";case e.TRANSPORT_KEEPALIVE_TIMEOUT:return"TRANSPORT_KEEPALIVE_TIMEOUT";case e.TRANSPORT_UNAUTHORIZED:return"TRANSPORT_UNAUTHORIZED";case e.TRANSPORT_REJECTED:return"TRANSPORT_REJECTED";case e.TRANSPORT_BAD_REQUEST:return"TRANSPORT_BAD_REQUEST";case e.TRANSPORT_DGW_SERVER_ERROR:return"TRANSPORT_DGW_SERVER_ERROR";case e.TRANSPORT_NORMAL_CLOSURE:return"TRANSPORT_NORMAL_CLOSURE"}}function s(t){switch(t){case e.TRANSPORT_UNAUTHORIZED:return!1;default:return!0}}var u=(function(){function e(){}var t=e.prototype;return t.onStreamGroupError=function(){},t.onStreamGroupMustDrain=function(){},t.onStreamGroupTransportClose=function(){},e})();i.DGWStreamGroupError=e,i.dgwStreamGroupErrorToString=l,i.isRetryableError=s,i.NoOpDGWStreamGroupCallbacks=u}),66);
__d("DGWTransportEvents",["DGWLoggingContext","NetworkStatus"],(function(t,n,r,o,a,i,l){"use strict";var e=(function(){function e(e){this.$3=e}var t=e.prototype;return t.transportEstablished=function(t){this.$3.logEvent(o("DGWLoggingContext").DGWLoggingComponent.WEBSOCKET_TRANSPORT_COMPONENT,"open",t),this.$2=Date.now(),this.$3.bumpODSKey(o("DGWLoggingContext").DGWLoggingComponent.WEBSOCKET_TRANSPORT_COMPONENT,"stream_group_establishment_success")},t.transportPingSent=function(t){this.$3.logEvent(o("DGWLoggingContext").DGWLoggingComponent.WEBSOCKET_TRANSPORT_COMPONENT,"Ping Frame Sent",t,!0)},t.transportPongReceived=function(t){this.$3.logEvent(o("DGWLoggingContext").DGWLoggingComponent.WEBSOCKET_TRANSPORT_COMPONENT,"Pong Frame Received",t,!0)},t.transportEstablishmentPending=function(){this.$1=Date.now(),this.$3.logEvent(o("DGWLoggingContext").DGWLoggingComponent.WEBSOCKET_TRANSPORT_COMPONENT,"transportPending",null,!0),this.$3.bumpODSKey(o("DGWLoggingContext").DGWLoggingComponent.WEBSOCKET_TRANSPORT_COMPONENT,"stream_group_establishment_pending")},t.transportClosed=function(t,n,r){this.$4=Date.now(),t?(this.$3.bumpODSKey(o("DGWLoggingContext").DGWLoggingComponent.WEBSOCKET_TRANSPORT_COMPONENT,"transport_close_graceful"),this.$3.logEvent(o("DGWLoggingContext").DGWLoggingComponent.WEBSOCKET_TRANSPORT_COMPONENT,"Transport closed gracefully",null,!0)):(this.$3.bumpODSKey(o("DGWLoggingContext").DGWLoggingComponent.WEBSOCKET_TRANSPORT_COMPONENT,"transport_close_with_error"),this.$3.logError(o("DGWLoggingContext").DGWLoggingComponent.WEBSOCKET_TRANSPORT_COMPONENT,"Transport closed abnormally",n,r))},t.transportEstablishmentFailure=function(t){this.$3.logError(o("DGWLoggingContext").DGWLoggingComponent.WEBSOCKET_TRANSPORT_COMPONENT,"WebSocket transport establishment failure","WebSocket close code: "+t.code+" reason: "+t.reason+" wasClean: "+String(t.wasClean)),this.$3.bumpODSKey(o("DGWLoggingContext").DGWLoggingComponent.WEBSOCKET_TRANSPORT_COMPONENT,"stream_group_establishment_failure")},t.streamEstablishmentTimeout=function(t,n,a){this.$3.logError(o("DGWLoggingContext").DGWLoggingComponent.WEBSOCKET_TRANSPORT_COMPONENT,"Grouped Stream establishment timeout",t,"streamId:"+n+", onLine:"+String(r("NetworkStatus").isOnline()),!1,a),this.$3.bumpODSKey(o("DGWLoggingContext").DGWLoggingComponent.WEBSOCKET_TRANSPORT_COMPONENT,"stream_establishment_timeout")},t.streamEstablishmentPending=function(t,n){this.$3.logEvent(o("DGWLoggingContext").DGWLoggingComponent.WEBSOCKET_TRANSPORT_COMPONENT,"Grouped Stream establishment pending","streamId:"+t,!0,n),this.$3.bumpODSKey(o("DGWLoggingContext").DGWLoggingComponent.WEBSOCKET_TRANSPORT_COMPONENT,"stream_establishment_pending")},t.streamEstablishmentSuccess=function(t,n){this.$3.logEvent(o("DGWLoggingContext").DGWLoggingComponent.WEBSOCKET_TRANSPORT_COMPONENT,"Grouped Stream establishment success","streamId:"+t,!0,n),this.$3.bumpODSKey(o("DGWLoggingContext").DGWLoggingComponent.WEBSOCKET_TRANSPORT_COMPONENT,"stream_establishment_success")},t.transportError=function(t,n,r){this.$3.logError(o("DGWLoggingContext").DGWLoggingComponent.WEBSOCKET_TRANSPORT_COMPONENT,t,n,r)},t.receivedFrameForInactiveStream=function(t,n,r){this.$3.logWarn(o("DGWLoggingContext").DGWLoggingComponent.WEBSOCKET_TRANSPORT_COMPONENT,"Frame received for inactive stream","frameType: "+t+", streamID: "+n,r)},t.ranOutOfStreamIds=function(t){this.$3.logWarn(o("DGWLoggingContext").DGWLoggingComponent.WEBSOCKET_TRANSPORT_COMPONENT,"Hit max StreamId limit","Hit max StreamId limit",t)},e})();l.DGWTransportEvents=e}),98);
__d("DGWWebSocketTransport",[],(function(t,n,r,o,a,i){"use strict";function e(e){var t=new WebSocket(e);return t.binaryType="arraybuffer",t.onopen=function(){},t.onclose=function(){},t.onerror=function(){},t}i.getWebSocketConnection=e}),66);
__d("DGWStreamEvents",[],(function(t,n,r,o,a,i){"use strict";var e=(function(){function e(e,t,n){this.$4=new Map,this.$5=new Map,this.$6=e,this.$1=t,n!=null&&(this.$8="streamId:"+n+"::")}var t=e.prototype;return t.dataSent=function(t,n,r){var e,o=n?"sendWithAckRequested":"sendWithoutAckRequested";this.$6.logEvent(this.$1,o,((e=this.$8)!=null?e:"")+"sendId:"+r+", payloadSize:"+t,!0),this.$4.set(r,{ackRequested:n,payloadSize:t,sendTimestamp:Date.now()})},t.ackReceived=function(t){var e;this.$6.logEvent(this.$1,"AckReceived",((e=this.$8)!=null?e:"")+"sendId:"+t,!0),this.$6.bumpODSKey(this.$1,"ack_received");var n=this.$4.get(t);n!=null&&(n.ackReceivedTimestamp=Date.now())},t.ackSent=function(t){var e;this.$6.bumpODSKey(this.$1,"ack_sent"),this.$6.logEvent(this.$1,"ACK sent",((e=this.$8)!=null?e:"")+"ackId:"+t,!0)},t.drainSent=function(t){var e;this.$6.logEvent(this.$1,"Drain sent",((e=this.$8)!=null?e:"")+"drainReason: "+t)},t.dataReceived=function(t,n,r){var e;this.$6.bumpODSKey(this.$1,"data_received"),this.$6.logEvent(this.$1,"Data received",((e=this.$8)!=null?e:"")+"sendId:"+(r!=null?r:"null")+", ackRequested:"+n.toString()+", payloadSize:"+t,!0),r!=null&&this.$5.set(r,{ackRequested:n,payloadSize:t,receiveTimestamp:Date.now()})},t.endOfDataReceived=function(){this.$6.bumpODSKey(this.$1,"end_of_data_received"),this.$6.logEvent(this.$1,"EndOfDataReceived",this.$8,!0)},t.endOfDataSent=function(){this.$6.bumpODSKey(this.$1,"end_of_data_sent"),this.$6.logEvent(this.$1,"EndOfDataSent",this.$8,!0)},t.streamClosed=function(t,n){this.$7=Date.now();var e=this.$9();if(t){var r;this.$6.bumpODSKey(this.$1,"stream_closed_gracefully"),this.$6.logEvent(this.$1,"Stream closed gracefully",""+((r=this.$8)!=null?r:"")+e)}else{var o;this.$6.bumpODSKey(this.$1,"stream_closed_with_error"),this.$6.logError(this.$1,"Stream closed abnormally",n,""+((o=this.$8)!=null?o:"")+e)}},t.connectionEstablishmentFailure=function(t){this.$6.logEvent(this.$1,"WebSocket connection establishment failure","WebSocket close code: "+t)},t.streamEstablishmentFailure=function(t,n){var e;this.$6.logError(this.$1,"Failed to establish DGW Stream","Last seen error: "+t.toString(),""+((e=this.$8)!=null?e:"")+n),this.$6.bumpODSKey(this.$1,"stream_establishment_failure")},t.error=function(t,n){var e={msg:n,state:this.$9()};this.$6.logError(this.$1,t,JSON.stringify(e),this.$8)},t.$9=function(){var e={currentNetworkCondition:window.navigator&&window.navigator.onLine===!0,establishRequestTimestamp:this.$2,establishedTimestamp:this.$3,streamClosedTimestamp:this.$7,sendHistory:JSON.stringify(Array.from(this.$4.entries())),receiveHistory:JSON.stringify(Array.from(this.$5.entries()))};return JSON.stringify(e)},e})();i.DGWStreamEvents=e}),66);
__d("PerfFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(t,n,r,o,a,i,l){"use strict";var e=r("getFalcoLogPolicy_DO_NOT_USE")("1744178"),s=o("FalcoLoggerInternal").create("perf",e),u=s;l.default=u}),98);
__d("PerfXSharedFields",["CurrentLocale","Locale","SiteData","getErrorSafe"],(function(t,n,r,o,a,i,l){var e=typeof window!="undefined"?window:self,s={addCommonValues:function(n){var t=e==null?void 0:e.navigator;try{t&&typeof t.hardwareConcurrency=="number"&&(n.num_cores=Math.floor(t.hardwareConcurrency)),t&&t.deviceMemory&&(n.ram_gb=t.deviceMemory),t&&t.connection&&(typeof t.connection.downlink=="number"&&(n.downlink_megabits=t.connection.downlink),typeof t.connection.effectiveType=="string"&&(n.effective_connection_type=t.connection.effectiveType),typeof t.connection.rtt=="number"&&(n.rtt_ms=t.connection.rtt))}catch(e){if(r("getErrorSafe")(e).message!=="can't access dead object")throw r("getErrorSafe")(e)}return n.client_push_phase=r("SiteData").push_phase,n.client_revision=r("SiteData").client_revision,r("SiteData").server_revision!=null&&(n.server_revision=r("SiteData").server_revision),n.locale=r("CurrentLocale").get(),n.isRTL=Number(r("Locale").isRTL()),n},getCommonData:function(){var e={};return s.addCommonValues(e),e}},u=s;l.default=u}),98);
__d("QPLCoreHelpers",[],(function(t,n,r,o,a,i){"use strict";function e(e,t,n,r,o,a,i){var l,s,u,c="unreliable";o!=null&&(c+="_"+o);var d={string:(l={},l.join_id=e,l.qpl_join__source_clock=c,l.qpl__source="client_js",l),int:(s={},s.qpl_join__absolute_time_origin_ms=t,s),bool:(u={},u.qpl_join__source_is_primary=n,u)};if(r!=null&&d.int&&(d.int.qpl_join__close_session_after_seconds=r),a!=null){var m;d.string_array=(m={},m.qpl_join__namespaces=a,m)}return i!=null&&d.int&&(d.int.qpl_join__action_priority=i),d}function l(e){switch(e){case 1:return"join_request_";case 0:return"join_request_";case 3:return"join_response_";case 2:return"join_response_";default:return null}}function s(e,t){var n=l(e);return n==null?null:n+t}i.generateJoinAnnotations=e,i.getAlignmentPointNamePrefix=l,i.getAlignmentPointName=s}),66);
__d("QPLEvent",[],(function(t,n,r,o,a,i){"use strict";function e(e){return e.i}function l(e){var t;return(t=e.r)!=null?t:0}function s(e){var t;return(t=e.m)!=null?t:1}i.getMarkerId=e,i.getSampleRate=l,i.getSamplingMethod=s}),66);
__d("DoublyLinkedListMap",[],(function(t,n,r,o,a,i){var e=(function(){"use strict";function e(){this._head=null,this._tail=null,this._nodes={},this._nodeCount=0}var t=e.prototype;return t.get=function(t){var e,n=(e=this._nodes[t])==null?void 0:e.data;return n||null},t.getIndex=function(t){for(var e=this._head,n=0;e;e=e.next,n++)if(e.key===t)return n;return null},t._insert=function(t,n,r,o){r&&!this._nodes[r]&&(r=null);var e;r&&this._nodes[r]?e=this._nodes[r]:e=o?this._head:this._tail;var a={data:n,key:t,next:null,prev:null};return e&&(this.remove(t),o?(a.prev=e.prev,e.prev&&(e.prev.next=a),e.prev=a,a.next=e):(a.next=e.next,e.next&&(e.next.prev=a),e.next=a,a.prev=e)),a.prev===null&&(this._head=a),a.next===null&&(this._tail=a),this._nodes[t]=a,this._nodeCount++,this},t.insertBefore=function(t,n,r){return this._insert(t,n,r,!0)},t.insertAfter=function(t,n,r){return this._insert(t,n,r,!1)},t.prepend=function(t,n){return this.insertBefore(t,n,this._head&&this._head.key)},t.append=function(t,n){return this.insertAfter(t,n,this._tail&&this._tail.key)},t.remove=function(t){var e=this._nodes[t];if(e){var n=e.next,r=e.prev;n&&(n.prev=r),r&&(r.next=n),this._head===e&&(this._head=n),this._tail===e&&(this._tail=r),delete this._nodes[t],this._nodeCount--}return this},t.find=function(t){for(var e=this._head;e;e=e.next)if(t(e.data))return e.key;return null},t.reduce=function(t,n){for(var e=this._head;e;e=e.next)n=t(e.data,n);return n},t.exists=function(t){return!!this._nodes[t]},t.isEmpty=function(){return!this._head},t.reset=function(){this._head=null,this._tail=null,this._nodes={},this._nodeCount=0},t.map=function(t){for(var e=this._head;e;e=e.next)t(e.data)},t.getCount=function(){return this._nodeCount},t.getHead=function(){var e;return(e=this._head)==null?void 0:e.data},t.getTail=function(){var e;return(e=this._tail)==null?void 0:e.data},t.getNext=function(t){var e;return(e=this._nodes[t])==null||(e=e.next)==null?void 0:e.data},t.getPrev=function(t){var e;return(e=this._nodes[t])==null||(e=e.prev)==null?void 0:e.data},t.getHeadKey=function(){var e;return(e=this._head)==null?void 0:e.key},t.getTailKey=function(){var e;return(e=this._tail)==null?void 0:e.key},e})();a.exports=e}),null);
__d("QPLMarkerMap",["DoublyLinkedListMap"],(function(t,n,r,o,a,i,l){"use strict";var e=(function(){function e(e){var t=e===void 0?{}:e,n=t.totalLimit,o=n===void 0?null:n,a=t.perMarkerLimit,i=a===void 0?null:a;this.size=0,this.$1={},this.$4=o,this.$5=i,this.$3=new Map,this.$2=new(r("DoublyLinkedListMap"))}var t=e.prototype;return t.set=function(t,n,r){var e=this.$1[t];if(e===void 0){var o={};e=o,this.$1[t]=e}var a=Object.prototype.hasOwnProperty.call(e,n);a||(this.$6(t),this.$7()),this.$8(t,n),a||this.size++,e[n]=r},t.delete=function(t,n){var e=this.$1[t];e===void 0||!Object.prototype.hasOwnProperty.call(e,n)||(this.$9(t,n),delete e[n],this.size--,Object.keys(e).length===0&&delete this.$1[t])},t.get=function(t,n){var e=this.$1[t];if(e!==void 0)return e[n]},t.has=function(t,n){var e=this.$1[t];return e===void 0?!1:Object.prototype.hasOwnProperty.call(e,n)},t.forEach=function(t){var e=0;for(var n in this.$1){var r=Number(n),o=this.$1[r];for(var a in o){var i=Number(a);t(o[i],r,i,e++)}}},t.toString=function(){try{return JSON.stringify(this.$1)}catch(e){return"{}"}},t.$8=function(t,n){var e={markerId:t,instanceKey:n},r=this.$10(t,n),o=this.$4!=null,a=this.$5!=null;o&&(this.$2.remove(r),this.$2.append(r,e));var i=this.$11(t);a&&(i.remove(r),i.append(r,e))},t.$9=function(t,n){var e=this.$10(t,n),r=this.$4!=null,o=this.$5!=null;if(r&&this.$2.remove(e),o){var a=this.$3.get(t);a&&(a.remove(e),a.isEmpty()&&this.$3.delete(t))}},t.$6=function(t){var e=this.$5;if(e!=null){var n=this.$11(t);n.getCount()>=e&&this.$12(n)}},t.$7=function(){var e=this.$4;e!=null&&this.size>=e&&this.$12(this.$2)},t.$12=function(t){var e=t.getHeadKey();if(e!=null){var n=t.get(e);n&&this.delete(n.markerId,n.instanceKey)}},t.$10=function(t,n){return t+":"+n},t.$11=function(t){var e=this.$3.get(t);return e||(e=new(r("DoublyLinkedListMap")),this.$3.set(t,e)),e},e})();l.default=e}),98);
__d("QPLTimestamp",[],(function(t,n,r,o,a,i){"use strict";function e(e){if(e===0)return"0";var t=e.toFixed(6).split(".",2),n=t[0],r=t[1];return n==="0"?r.replace(/^0+/,""):n+r}function l(t,n){var r=n-t;return e(r)}i.timestampToSerializedNanoseconds=e,i.calculateDurationAsNanoseconds=l}),66);
__d("crc32",[],(function(t,n,r,o,a,i){function e(e){for(var t=-1,n=0,r=e.length;n<r;n++)t=t>>>8^l[(t^e.charCodeAt(n))&255];return~t}var l=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117];t.Int32Array!==void 0&&(l=new Int32Array(l)),i.default=e}),66);
__d("QPLUtils",["crc32"],(function(t,n,r,o,a,i,l){"use strict";function e(e){return r("crc32")(e)>>>0}function s(t){return t!=null?e(t):0}l.unsignedCrc32=e,l.deriveInstanceKey=s}),98);
__d("QuickPerformanceLoggerTypes",[],(function(t,n,r,o,a,i){"use strict";var e=1,l=3;i.EVENT_BASED_SAMPLING=e,i.USER_BASED_SAMPLING=l}),66);
__d("QPLCore",["QPLCoreHelpers","QPLEvent","QPLMarkerMap","QPLTimestamp","QPLUtils","QuickPerformanceLoggerTypes","uuidv4"],(function(t,n,r,o,a,i,l){"use strict";var e;function s(e){if(e==null)return e;var t={};for(var n in e)t[n]=String(e[n]);return t}function u(e){if(e==null)return e;var t={};for(var n in e)t[n]=e[n].map(String);return t}function c(e,t,n,r){var o,a=t[e];if(!a||Object.entries(a).length===0)return null;var i={};return Object.keys(a).forEach(function(e){var t=a[e];t==null||t.length===0?delete a[e]:r?i[e]=r(t):i[e]=t}),o={},o[e]=babelHelpers.extends({},n&&n[e],i),o}function d(e,t){if(e==null)return t;var n=babelHelpers.extends({},t,c("string",e,t),c("int",e,t,Math.trunc),c("double",e,t),c("bool",e,t),c("string_array",e,t),c("int_array",e,t,function(e){return e.map(Math.trunc)}),c("double_array",e,t),c("bool_array",e,t));return Object.keys(n).forEach(function(e){var t=n[e];(t==null||Object.entries(t).length===0)&&delete n[e]}),Object.entries(n).length!==0?n:null}function m(e,t){var n={};g.isMarkerTracked(t)&&(n.tracked_for_loss=!0),typeof t.absoluteTimeOrigin=="number"&&(n.absolute_time_origin_ns=o("QPLTimestamp").timestampToSerializedNanoseconds(t.absoluteTimeOrigin));var r=babelHelpers.extends({},e,n);return r}function p(e,t){if(!t)return e;var n={};return t.string&&(n.annotations=t.string),t.int&&(n.annotations_int=s(t.int)),t.double&&(n.annotations_double=t.double),t.bool&&(n.annotations_bool=t.bool),t.string_array&&(n.annotations_string_array=t.string_array),t.int_array&&(n.annotations_int_array=u(t.int_array)),t.double_array&&(n.annotations_double_array=t.double_array),t.bool_array&&(n.annotations_bool_array=t.bool_array),babelHelpers.extends({},e,n)}var _=new Map([[o("QuickPerformanceLoggerTypes").EVENT_BASED_SAMPLING,"random_sampling"],[o("QuickPerformanceLoggerTypes").USER_BASED_SAMPLING,"per_user"]]);function f(e,t){return e===0?!1:e<=1?!0:typeof t=="string"?o("QPLUtils").unsignedCrc32(t)%e===0:Math.random()*e<=1}var g=(function(){function t(e){var t;this.$2=1,this.$3=100,this.$4=new Map,this.$5=new Map,this.$6=null,this.$8=new Map,this.activeMarkers=new Map,this.$1=e,this.$7=e.logger,this.$5=(t=e.listenersWithMarker)!=null?t:new Map,this.$9=new(r("QPLMarkerMap"))}var n=t.prototype;return n.$10=function(t,n){try{return n()}catch(e){this.$1.onError&&this.$1.onError(t,e)}},n.getMarker=function(n,r){var t=this;return this.$10("getMarker",function(){var a=t.$11((e||(e=o("QPLEvent"))).getMarkerId(n));if(!a)return null;var i=a.get(r);return i||null})},n.isMarkerOn=function(n,r){var t,a=this;return r===void 0&&(r=0),(t=this.$10("isMarkerOn",function(){var t=a.$11((e||(e=o("QPLEvent"))).getMarkerId(n));if(!t)return!1;var i=t.get(r);return!!i}))!=null?t:!1},t.isMarkerTracked=function(t){return t.trackedForLoss===!0||t.type===2},n.$11=function(t){return this.activeMarkers.get(t)},n.addMarker=function(t,n,r){var e=this.activeMarkers.get(t);e||(e=new Map,this.activeMarkers.set(t,e)),e.set(n,r)},n.deleteMarker=function(t,n){var e;(e=this.activeMarkers.get(t))==null||e.delete(n),this.$12(t,n)},n.markerStart=function(r,a,i,l){var n=this;a===void 0&&(a=0),i===void 0&&(i=this.currentTimestamp());var s=l===void 0?{}:l,u=s.cancelExisting,c=u===void 0?!1:u,d=s.cancelOnUnload,m=d===void 0?!1:d,p=s.trackedForLoss,_=p===void 0?!1:p,f=s.type,g=f===void 0?1:f,h=s.samplingBasis,y=h===void 0?null:h,C=s.qplInternalDoNotUseAbsoluteTimeOrigin,b=s.timeoutMS,v=b===void 0?null:b,S=s.onMarkerTimeout__DoNotUse,R=S===void 0?null:S,L=s.enableE2ETracing,E=L===void 0?!1:L,k=s.crashResilient,I=k===void 0?!1:k;this.$10("markerStart",function(){var l=n.getMarker(r,a);if(l){var s=Math.round(i-l.timestamp);c&&(n.markerAnnotate(r,{string:{cancelType:"DUPLICATE_EVENT"},int:{time_between_markers_ms:s}},{instanceKey:a}),n.markerEnd(r,4,a,i))}var u=n.$13(r,y),d=u[0],p=u[1],f=u[2],h=null;E&&(h=n.$1.e2eTracingIDGenerator?n.$1.e2eTracingIDGenerator(r):null);var b={event:r,passesSampling:d,timestamp:i,sampleRate:p,samplingMethod:f,points:[],cancelOnUnload:m,trackedForLoss:_,type:g,timeoutMS:v,e2eTracingID:h,isCrashResilient:I};if(typeof C=="number"&&(b.absoluteTimeOrigin=C),n.$4.forEach(function(e){e.onMarkerStart&&e.onMarkerStart(r,a,i)}),n.$5.forEach(function(e){e.onMarkerStartWithMarker(r,a,i,b)}),d&&(n.addMarker((e||(e=o("QPLEvent"))).getMarkerId(r),a,b),v!=null&&n.$14(r,a,v,R)),d&&t.isMarkerTracked(b)&&n.$15({marker_id:27787271,action_id:51,sample_rate:1,annotations_int:{tracked_marker_id:String((e||(e=o("QPLEvent"))).getMarkerId(r))},marker_type:1}),h!==null){var S;n.markerAnnotate(r,{string:(S={},S.qpl_e2e__tracing_id=h,S)},{instanceKey:a})}d&&n.$4.forEach(function(e){e.onMarkerStarted&&e.onMarkerStarted(r,a,i,n.$16(b))})})},n.$16=function(t){if(t==null){var e={isCrashResilient:!1};return e}return{isCrashResilient:t.isCrashResilient}},n.$17=function(t,n){this.$9.delete(t,n)},n.$18=function(t,n,r){this.$9.set(t,n,r)},n.$12=function(t,n){var e,r=this.$9.get(t,n);r&&(e=this.$1.runtimeAbstractionLayer)!=null&&e.clearTimeout&&(this.$1.runtimeAbstractionLayer.clearTimeout(r),this.$17(t,n))},n.$14=function(n,r,a,i){var t=this,l=(e||(e=o("QPLEvent"))).getMarkerId(n);try{var s,u;if(this.$12(l,r),!((s=this.$1.runtimeAbstractionLayer)!=null&&s.setTimeout))return;var c=(u=this.$1.runtimeAbstractionLayer)==null?void 0:u.setTimeout(function(){i!=null&&i(n,r),t.$4.forEach(function(e){e.onTimeoutEvent!=null&&e.onTimeoutEvent({event:n,instanceKey:r,passesSampling:!0})}),t.$17(l,r),t.markerEnd(n,113,r)},a);this.$18(l,r,c)}catch(e){}},n.markerAnnotate=function(t,n,r){var e=this,o=r===void 0?{}:r,a=o.instanceKey,i=a===void 0?0:a;this.$10("markerAnnotate",function(){e.$4.forEach(function(e){Object.keys(n).forEach(function(r){var o=n[r];o&&Object.keys(o).forEach(function(n){e.onAnnotation&&e.onAnnotation(t,i,n,o[n],r)})})});var r=e.getMarker(t,i);r&&(r.annotations=d(n,r.annotations))})},n.markerPoint=function(t,n,r){var e=this,o=r===void 0?{}:r,a=o.instanceKey,i=a===void 0?0:a,l=o.data,s=o.timestamp,u=s===void 0?this.currentTimestamp():s;this.$10("markerPoint",function(){e.$4.forEach(function(e){e.onMarkerPoint&&e.onMarkerPoint(t,i,n,l,u)});var r=e.getMarker(t,i);if(r){var o={name:n,timeSinceStart:Math.trunc(u-r.timestamp)},a=d(l);a&&(o.data=a),r.points.push(o)}})},n.markerEnd=function(n,r,a,i){var t=this;a===void 0&&(a=0),i===void 0&&(i=this.currentTimestamp()),this.$10("markerEnd",function(){var l=t.getMarker(n,a);if(!l){t.$4.forEach(function(e){var o={durationMs:0,passesSampling:!1};e.onMarkerEnd&&e.onMarkerEnd(r,n,a,i,babelHelpers.extends({},o,t.$16(l)))});return}var c=r,d=t.$19(l,l.timestamp,i);d&&r===2&&(c=5947);var f=l.points.map(function(e){return e.data?{name:e.name,timeSinceStart:String(e.timeSinceStart),data:(function(t,n,r,o,a,i,l,c){var d={};if(((t=e.data)==null?void 0:t.string)!=null&&(d.string=e.data.string),((n=e.data)==null?void 0:n.string_array)!=null&&(d.string_array=e.data.string_array),((r=e.data)==null?void 0:r.int)!=null){var m;d.int=s((m=e.data)==null?void 0:m.int)}if(((o=e.data)==null?void 0:o.int_array)!=null){var p;d.int_array=u((p=e.data)==null?void 0:p.int_array)}return((a=e.data)==null?void 0:a.double)!=null&&(d.double=e.data.double),((i=e.data)==null?void 0:i.double_array)!=null&&(d.double_array=e.data.double_array),((l=e.data)==null?void 0:l.bool)!=null&&(d.bool=e.data.bool),((c=e.data)==null?void 0:c.bool_array)!=null&&(d.bool_array=e.data.bool_array),d})()}:{name:e.name,timeSinceStart:String(e.timeSinceStart)}}),g={marker_id:(e||(e=o("QPLEvent"))).getMarkerId(n),action_id:c,instance_id:a,sample_rate:l.sampleRate,method:_.get(l.samplingMethod),duration_ns:o("QPLTimestamp").calculateDurationAsNanoseconds(l.timestamp,i),points:f,metadata:{application_analytics:{time_since_qpl_module_init:i-t.$1.moduleLoadTimestamp}},marker_type:l.type,flags:1,unique_marker_id_debug_only:l.uniqueMarkerDebugId},h=p(g,l.annotations),y=m(h,l);t.$4.forEach(function(e){var t={durationMs:l?i-l.timestamp:0,logData:y,passesSampling:l.passesSampling,isCrashResilient:l.isCrashResilient};e.onMarkerEnd&&e.onMarkerEnd(c,n,a,i,t)}),l.passesSampling&&(l.timestampIsApproximate!==!0&&t.$15(y),t.$6===(e||(e=o("QPLEvent"))).getMarkerId(n)&&t.$1.onDebuggingIdEnded&&t.$1.onDebuggingIdEnded()),t.deleteMarker(e.getMarkerId(n),a)})},n.markerDrop=function(n,r){var t=this;r===void 0&&(r=0),this.$10("markerDrop",function(){var a=t.getMarker(n,r);t.deleteMarker((e||(e=o("QPLEvent"))).getMarkerId(n),r);var i=t.currentTimestamp();t.$4.forEach(function(e){if(e.onMarkerDrop){var o;e.onMarkerDrop(n,r,i,babelHelpers.extends({passesSampling:(o=a==null?void 0:a.passesSampling)!=null?o:!1},t.$16(a)))}})})},n.markEvent=function(n,r,a,i){var t=this,l=i===void 0?{}:i,s=l.timestamp,u=s===void 0?this.currentTimestamp():s,c=l.annotations;this.$10("markEvent",function(){var i;if(t.$4.forEach(function(e){e.onMarkEvent&&e.onMarkEvent({event:n,timestamp:u,annotations:c})}),!((i=t.$1.quickLogConfigHelper)!=null&&i.isKillswitchOn())){var l=t.$13(n),s=l[0],m=l[1],f=l[2];if(s){var g=d(typeof c=="function"?c():c),h={marker_id:(e||(e=o("QPLEvent"))).getMarkerId(n),action_id:51,instance_id:0,sample_rate:m,method:_.get(f),da_type:r,da_level:a,metadata:{application_analytics:{time_since_qpl_module_init:u-t.$1.moduleLoadTimestamp}},marker_type:1,flags:1};t.$15(p(h,g))}}})},n.markerStartForJoin=function(t,n,r){var e=this,a=r===void 0?{}:r,i=a.instanceKey,l=i===void 0?0:i,s=a.cancelExisting,u=s===void 0?!1:s,c=a.cancelOnUnload,d=c===void 0?!1:c,m=a.trackedForLoss,p=m===void 0?!1:m,_=a.type,f=_===void 0?1:_,g=a.qplInternalDoNotUseAbsoluteTimeOrigin,h=g===void 0?null:g,y=a.timeoutMS,C=y===void 0?null:y,b=a.monotonicTimestamp,v=b===void 0?this.currentTimestamp():b,S=a.absoluteTimeOriginMs,R=S===void 0?this.currentUnixTimestamp():S,L=a.sourceIsPrimary,E=L===void 0?!1:L,k=a.closeSession,I=a.onMarkerTimeout__DoNotUse,T=a.unreliableSourceClockProcessId,D=a.crashResilient,x=a.joinNamespaces,$=a.actionPriority;this.$10("markerStartForJoin",function(){e.markerStart(t,l,v,{cancelExisting:u,cancelOnUnload:d,trackedForLoss:p,type:f,samplingBasis:n,qplInternalDoNotUseAbsoluteTimeOrigin:h,timeoutMS:C,onMarkerTimeout__DoNotUse:I,crashResilient:D});var r=o("QPLCoreHelpers").generateJoinAnnotations(n,R,E,k,T,x,$);e.markerAnnotate(t,r,{instanceKey:l})})},n.addAlignmentPointForJoin=function(t,n,r){var e=this,a=r===void 0?{}:r,i=a.instanceKey,l=i===void 0?0:i,s=a.requestId,u=s===void 0?"default_id":s,c=a.timestamp,d=c===void 0?this.currentTimestamp():c;this.$10("addAlignmentPointForJoin",function(){var r=o("QPLCoreHelpers").getAlignmentPointName(n,u);r!=null&&e.markerPoint(t,r,{instanceKey:l,timestamp:d})})},n.setAlwaysOnSampleRate=function(t,n){this.$8.set(t,n)},n.setDefaultSampleRate=function(t){this.$3=t},n.currentTimestamp=function(){var e,t=this;return(e=this.$10("currentTimestamp",function(){return t.$1.monotonicNowMs()}))!=null?e:0},n.currentUnixTimestamp=function(){var e,t=this;return(e=this.$10("currentUnixTimestamp",function(){return t.$1.unixNowMs()}))!=null?e:0},n.enableDebug=function(t){this.$6=t},n.disableDebug=function(){this.$6=null},n.addListener=function(t){var e,n=this;return(e=this.$10("addListener",function(){var e=n.$2++;return n.$4.set(e,t),{dispose:function(){n.$4.delete(e)}}}))!=null?e:{dispose:function(){}}},n.$13=function(n,r){var t,a;if(this.$1.unsampleAllEvents&&this.$1.unsampleAllEvents()||this.$6===(e||(e=o("QPLEvent"))).getMarkerId(n))return[!0,1,o("QuickPerformanceLoggerTypes").EVENT_BASED_SAMPLING];var i=(e||(e=o("QPLEvent"))).getSampleRate(n),l=e.getSamplingMethod(n);if(this.$8.get(n)==null&&i!==0&&l===o("QuickPerformanceLoggerTypes").USER_BASED_SAMPLING)return[!0,i!=null?i:1,o("QuickPerformanceLoggerTypes").USER_BASED_SAMPLING];var s=(t=(a=this.$8.get(n))!=null?a:i)!=null?t:this.$3,u=l!=null?l:o("QuickPerformanceLoggerTypes").EVENT_BASED_SAMPLING,c=f(s,r);return[c,s,u]},n.$15=function(t){this.$4.forEach(function(e){e.onUploadEvent&&e.onUploadEvent(t)});var e=this.$1.decorateEventBeforeUpload?this.$1.decorateEventBeforeUpload(t):t;this.$1.sendEvent(t,e)},n.$19=function(t,n,r){if(t.timeoutMS==null)return!1;var e=r-n;return e>=t.timeoutMS},n.getActiveMarkerIds=function(t){var e,n=this,r=t.type;return(e=this.$10("getActiveMarkerIds",function(){var e=new Set;return n.activeMarkers.forEach(function(t,n){t.forEach(function(t){if(t.type===r){e.add(n);return}})}),Array.from(e)}))!=null?e:[]},n.getActiveE2ETraceIds=function(){var e,t=this;return(e=this.$10("getActiveE2ETraceIds",function(){var e=new Map;return t.activeMarkers.forEach(function(t,n){var r=new Map;t.forEach(function(e,t){e.e2eTracingID!=null&&r.set(t,{e2eTraceID:e.e2eTracingID,qplEvent:e.event})}),r.size>0&&e.set(n,r)}),e}))!=null?e:new Map},n.getActiveE2ETraceIdsAsArray=function(){var e,t=this;return(e=this.$10("getActiveE2ETraceIdsAsArray",function(){var e=[];return t.activeMarkers.forEach(function(t,n){t.forEach(function(t,n){t.e2eTracingID!=null&&e.push(t.e2eTracingID)})}),e}))!=null?e:[]},n.forEachMarkerInstance=function(t,n){var e=this;this.$10("forEachMarkerInstance",function(){var r=e.$11(t);if(r)for(var o of r.entries()){var a=o[0],i=o[1];n(a,i.event)}})},n.getMarkerStartTs=function(t,n){var e=this,r=n===void 0?{}:n,o=r.instanceKey,a=o===void 0?0:o;return this.$10("getMarkerStartTs",function(){var n=e.getMarker(t,a);if(n)return n.timestamp})},n.markerLogDebugPoints=function(n,a){var t=this,i=a===void 0?{}:a,l=i.instanceKey,s=l===void 0?0:l;this.$10("markerLogDebugPoints",function(){var a=(e||(e=o("QPLEvent"))).getMarkerId(n),i=t.getMarker(n,s);if(i){var l=r("uuidv4")();i.uniqueMarkerDebugId=l}})},t})();g.normalizeAnnotations=d,l.default=g}),98);
__d("QPLInspector",[],(function(t,n,r,o,a,i){var e=(function(){function e(){this.$1=[],this.$2={}}var t=e.prototype;return t.appendLog=function(t){for(var e in this.$2)!Object.prototype.hasOwnProperty.call(this.$2,e)||t.marker_id!==e||this.$2[t.marker_id].forEach(function(e){return e(t)});this.$1.push(t)},t.dumpLogs=function(){return this.$1},t.addListener=function(t,n){Object.prototype.hasOwnProperty.call(this.$2,t)||(this.$2[t]=[]),this.$2[t].push(n),this.$1.forEach(function(e){e.marker_id===t&&n(e)})},t.removeListener=function(t,n){var e=this.$2[t].indexOf(n);e!==-1&&this.$2[t].splice(e,1)},e})(),l=new e;i.default=l}),66);
__d("QuickPerformanceLogger",["Arbiter","Env","FBLogger","ODS","PerfFalcoEvent","PerfXSharedFields","Promise","QPLCore","QPLEvent","QPLInspector","Run","WebStorage","clearTimeout","cr:1984081","cr:23134","cr:686","getErrorSafe","gkx","guid","performanceAbsoluteNow","performanceNavigationStart","performanceNow","setTimeout"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c,d,m,p,_,f=typeof window!="undefined"?window:self;function g(t,n){r("FBLogger")("qpl").catching(r("getErrorSafe")(n)).MUSTFIX(e||(e=babelHelpers.taggedTemplateLiteralLoose(["QPL error in ",""])),t)}function h(e){var t=r("PerfXSharedFields").getCommonData(),n={memory_stats:{total_mem:t.ram_gb!=null?t.ram_gb*1073741824:null},network_stats:{downlink_megabits:t.downlink_megabits,network_subtype:t.effective_connection_type,rtt_ms:t.rtt_ms},sitedata_info:{client_push_phase:t.client_push_phase,client_revision:t.client_revision,server_revision:t.server_revision},locale_info:{locale:t.locale,isRTL:t.isRTL}};if(r("gkx")("20836")&&(n.workplace_info={is_gemini:r("gkx")("21050")}),r("gkx")("21051")&&typeof f.__sapienzMetadataCallback__=="function"){var o=f.__sapienzMetadataCallback__();n.sapienz={request_id:String(o.requestId),config_name:String(o.configName)}}return babelHelpers.extends({},e,{metadata:babelHelpers.extends({},e.metadata,n)})}function y(e,t,n){return{i:e,m:n,r:t}}function C(e,t){return new(_||(_=n("Promise")))(function(){var n=t||e;typeof f.__je2e_recordQPLMarker=="function"&&f.__je2e_recordQPLMarker(n),(p||(p=r("Env"))).enable_qplinspector===!0&&r("QPLInspector").appendLog(n),r("gkx")("21053")||r("gkx")("20935")||r("gkx")("5679")?r("PerfFalcoEvent").logImmediately(function(){return n}):r("gkx")("2160")||r("gkx")("21055")||r("gkx")("1624")?r("PerfFalcoEvent").logCritical(function(){return n}):r("PerfFalcoEvent").log(function(){return n})})}function b(e){var t=(s||(s=o("QPLEvent"))).getMarkerId(e),n=t+"_"+r("guid")();return(m||(m=o("ODS"))).bumpEntityKey(2401,"obc.www.all","qpl.e2e_tracing_id_generated."+t),n}function v(e){var t=babelHelpers.extends({},e,{config_type:r("gkx")("21056")?"alpha_beta":"prod"});return h(t)}function S(){return(p||(p=r("Env"))).enable_qplinspector===!0||typeof f.__je2e_recordQPLMarker=="function"||r("gkx")("21057")}function R(){r("Arbiter").inform("qpl_debugger_finished")}var L=(u||(u=r("performanceAbsoluteNow")))();typeof f.__je2e_felabsTracePlugin_setQplInit=="function"&&f.__je2e_felabsTracePlugin_setQplInit((c||(c=r("performanceNow")))());var E={debug:function(t,n,r){},warn:function(t){r("FBLogger")("qpl").blameToPreviousDirectory().warn(t)}},k="qpl",I=(function(e){function t(){var t;t=e.call(this,{decorateEventBeforeUpload:v,unsampleAllEvents:S,onDebuggingIdEnded:R,monotonicNowMs:u||(u=r("performanceAbsoluteNow")),unixNowMs:u||(u=r("performanceAbsoluteNow")),moduleLoadTimestamp:L,logger:E,sendEvent:C,e2eTracingIDGenerator:b,runtimeAbstractionLayer:{setTimeout:r("setTimeout"),clearTimeout:r("clearTimeout")},debugLoggingEnabled:(p||(p=r("Env"))).qpl_debug_logging,onError:g})||this;var n=r("gkx")("21055")?r("gkx")("21058")?function(e){return o("Run").onBeforeUnload(e,!1)}:o("Run").onBeforeUnload:o("Run").onUnload;return n(function(){t.$QuickPerformanceLogger$p_1(),t.$QuickPerformanceLogger$p_2(706,{respectUnloadPolicy:!0,timestamp:t.currentTimestamp()})}),t.$QuickPerformanceLogger$p_3(),t.initQplFlipperPlugin(),t.initQplSapienzPlugin(),t.initQplUserTimingPlugin(),t}babelHelpers.inheritsLoose(t,e);var a=t.prototype;return a.$QuickPerformanceLogger$p_3=function(){var e=this,t=(d||(d=r("WebStorage"))).getSessionStorageForRead();if(!t){this.$QuickPerformanceLogger$p_4("#loadSavedState","sessionStorage is not available");return}var n=t.getItem(k);if(n!=null){t.removeItem(k);var o=JSON.parse(n);if(o==null){this.$QuickPerformanceLogger$p_4("#loadSavedState","Saved state failed to deserialize");return}if(o.markers==null||o.markers.length===0){this.$QuickPerformanceLogger$p_4("#loadSavedState","No saved markers found");return}o.markers.forEach(function(t){var n=t[0],r=t[1],o=t[2];e.addMarker(n,r,o),e.$QuickPerformanceLogger$p_4("#loadSavedState","Marker "+n+" (instanceKey: "+r+") resumed")})}},a.$QuickPerformanceLogger$p_1=function(){var e=this,t=[];if(this.activeMarkers.forEach(function(e,n){e.forEach(function(e,r){e.resumeAfterNavigation===!0&&(delete e.resumeAfterNavigation,t.push([n,r,e]))})}),t.length>0){var n={markers:t},o=(d||(d=r("WebStorage"))).getSessionStorage(),a=d.setItemGuarded(o,k,JSON.stringify(n));a&&(t.forEach(function(t){var n=t[0],r=t[1],o=t[2],a=y(n,o.sampleRate,o.samplingMethod);e.markerEnd(a,96,r)}),this.$QuickPerformanceLogger$p_4("#storeSavedState","Failed to store saved state: "+a.message),r("FBLogger")("qpl").catching(a).warn("Failed to store QPL state: "+JSON.stringify(n,null,2))),t.forEach(function(t){var n=t[0],r=t[1];e.deleteMarker(n,r)})}},a.markerStoreBeforeNavigation=function(t,n){var e=n===void 0?{}:n,r=e.instanceKey,a=r===void 0?0:r,i=(s||(s=o("QPLEvent"))).getMarkerId(t),l=this.getMarker(t,a);if(!l){this.$QuickPerformanceLogger$p_4("markerStoreBeforeNavigation","Failed to set marker to store on page unload. Could not find marker "+i+", instancekey="+a);return}l.resumeAfterNavigation=!0,this.$QuickPerformanceLogger$p_4("markerStoreBeforeNavigation","Set marker "+i+" to store on page unload, instancekey="+a)},a.markerStartFromNavStart=function(t,n,o){n===void 0&&(n=0);var e=o===void 0?{}:o,a=e.cancelExisting,i=a===void 0?!1:a,l=e.cancelOnUnload,s=l===void 0?!1:l,u=e.trackedForLoss,c=u===void 0?!1:u,d=e.type,m=d===void 0?1:d,p=e.qplInternalDoNotUseConvertToTimeOnServer,_=e.onMarkerTimeout__DoNotUse,f=e.timeoutMS,g=f===void 0?null:f,h=e.crashResilient,y=h===void 0?!1:h,C=r("performanceNavigationStart")(),b=typeof p=="function"?p(C):void 0;if(this.markerStart(t,n,C,{cancelExisting:i,cancelOnUnload:s,trackedForLoss:c,type:m,qplInternalDoNotUseAbsoluteTimeOrigin:b,onMarkerTimeout__DoNotUse:_,timeoutMS:g,crashResilient:y}),r("performanceNavigationStart").isPolyfilled){var v=this.getMarker(t,n);v&&(v.timestampIsApproximate=!0)}},a.markerStartForJoinFromNavStart=function(t,n,o){var e=o===void 0?{}:o,a=e.instanceKey,i=a===void 0?0:a,l=e.cancelExisting,s=l===void 0?!1:l,u=e.cancelOnUnload,c=u===void 0?!1:u,d=e.trackedForLoss,m=d===void 0?!1:d,p=e.type,_=p===void 0?1:p,f=e.qplInternalDoNotUseConvertToTimeOnServer,g=e.absoluteTimeOriginMs,h=e.sourceIsPrimary,y=h===void 0?!1:h,C=e.closeSession,b=e.unreliableSourceClockProcessId,v=e.onMarkerTimeout__DoNotUse,S=e.timeoutMS,R=e.crashResilient,L=R===void 0?!1:R,E=r("performanceNavigationStart")(),k=typeof f=="function"?f(E):void 0;if(this.markerStartForJoin(t,n,{instanceKey:i,cancelExisting:s,cancelOnUnload:c,trackedForLoss:m,type:_,qplInternalDoNotUseAbsoluteTimeOrigin:k,monotonicTimestamp:E,absoluteTimeOriginMs:g,sourceIsPrimary:y,closeSession:C,unreliableSourceClockProcessId:b,timeoutMS:S,onMarkerTimeout__DoNotUse:v,crashResilient:L}),r("performanceNavigationStart").isPolyfilled){var I=this.getMarker(t,i);I&&(I.timestampIsApproximate=!0)}},a.$QuickPerformanceLogger$p_2=function(t,n){var e=this,r=n===void 0?{}:n,o=r.timestamp,a=r.respectUnloadPolicy;this.activeMarkers.forEach(function(n,r){n.forEach(function(n,i){if(!a||n.cancelOnUnload===!0){var l=y(r,n.sampleRate,n.samplingMethod);e.markerEnd(l,t,i,o)}})})},a.$QuickPerformanceLogger$p_4=function(t,n,r){E.debug(t,n,r)},a.initQplFlipperPlugin=function(){n("cr:686")!=null&&this.addListener(n("cr:686").qplFlipperPlugin.listener())},a.initQplSapienzPlugin=function(){n("cr:1984081")!=null&&this.addListener(n("cr:1984081").getQplSapienzListener())},a.initQplUserTimingPlugin=function(){n("cr:23134")!=null&&this.addListener(n("cr:23134").getQplUserTimingListener())},t})(r("QPLCore")),T=new I;i.exports=T}),34);
__d("qpl",["FBLogger","QPLHasteSupportDataStorage"],(function(t,n,r,o,a,i,l){"use strict";var e={},s={_:function(n,o){var t=e[o];if(t==null){var a=r("QPLHasteSupportDataStorage").get(o);a==null?(r("FBLogger")("staticresources").mustfix("Failed to find a Haste-supplied config for the QPL event identified by token `%s`.",o),t={i:n}):t=babelHelpers.extends({i:n},a),e[o]=t}return t}},u=s;l.default=u}),98);
__d("GroupedStream",["DGWAckManager","DGWConstants","DGWLoggingContext","DGWStream","DGWStreamEvents","Promise","QuickPerformanceLogger","Random","asyncToGeneratorRuntime","qpl"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u=r("qpl")._(701242292,"2919"),c=(function(){function t(e,t,n,a,i,l,c){this.$1=e,this.$3=!1,this.$4=!1,this.$5=!1,this.$6=t,this.$7=n,this.$8=a,this.$2=l,this.$9=i,this.$10=new(o("DGWAckManager")).DGWAckManager(this.$9),this.$12=new(o("DGWStreamEvents")).DGWStreamEvents(this.$9,o("DGWLoggingContext").DGWLoggingComponent.GROUPED_STREAM_COMPONENT,this.$1),this.$11=0,this.$13=c,this.$14=Date.now()+(Math.round(o("Random").random()*1e4)+1e4),(s||(s=r("QuickPerformanceLogger"))).markerStart(u,this.$14)}var a=t.prototype;return a.send=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=this.$11++%o("DGWConstants").MAX_ACK_ID,r=this.$15(e,!0,n);if(!this.$16(r,!0,n))return!1;var a=yield this.$10.waitForAck(n,t!=null?t:o("DGWConstants").DEFAULT_ACK_TIMEOUT_MS);return a});function t(t,n){return e.apply(this,arguments)}return t})(),a.sendFrame=(function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,r,a){var i=this.$11++%o("DGWConstants").MAX_ACK_ID,l=this.$15(r,!0,i);if(l==null)return!1;var s=new Uint8Array(t.length+l.length);if(s.set(t),s.set(l,t.length),!this.$16(s,!0,i))return!1;var u=yield this.$10.waitForAck(i,a!=null?a:o("DGWConstants").DEFAULT_ACK_TIMEOUT_MS);return this.__markerPoint(u?"ack_recevied":"ack_timeout"),u||(this.__endMarker(3),(e||(e=n("Promise"))).reject(o("DGWStream").StreamError.ACK_TIMEOUT))});function r(e,n,r){return t.apply(this,arguments)}return r})(),a.sendAndForget=function(t){var e=this.$15(t,!1,0);return this.$16(e,!1,0)},a.sendFrameAndForget=function(t,n){var e=this.$15(n,!1,0);if(e==null)return!1;var r=new Uint8Array(t.length+e.length);return r.set(t),r.set(e,t.length),this.$16(r,!1,0)},a.close=function(){var e=this.$2.encodeEndOfData(this.$1);if(e==null){this.$9.logError(o("DGWLoggingContext").DGWLoggingComponent.GROUPED_STREAM_COMPONENT,"Failed to encode EndOfData","streamId: "+this.$1);return}var t=this.$8.send(e);if(!t){this.$9.logError(o("DGWLoggingContext").DGWLoggingComponent.GROUPED_STREAM_COMPONENT,"Failed to send EndOfData","streamId: "+this.$1+". StreamGroupTransport not open during send");return}this.$12.endOfDataSent(),this.$5=!0,this.$4&&this.$17()},a.loggingContext=function(){return this.$9},a.__sendDrain=function(t){var e=o("DGWConstants").drainReasonToDrainReasonString(t);if(this.$5)return!1;var n=this.$2.encodeDrain(t);if(n==null)return!1;this.$12.drainSent(e);var r=this.$8.send(n);return r},a.__transportCloseHook=function(t){this.$13(),this.$10.clearPendingAcks(),t?(this.$12.error("Received StreamError","StreamErrorType: "+t),this.$6.onError(t)):this.$5&&this.$4?this.$17():(this.$12.streamClosed(!1,"Stream closed: ClosedLocally: "+this.$5.toString()+", EndOfDataReceived: "+this.$4.toString()),this.$6.onError(o("DGWStream").StreamError.PREMATURE_CLOSE))},a.$17=function(){this.$13(),this.$12.streamClosed(!0,"Graceful close"),this.$6.onClose(this)},a.__dataReceivedHook=function(t,n){this.$12.dataReceived(t.length,n!=null,n),n!=null&&this.$18(n),this.$6.onDataReceived(t)},a.__ackReceivedHook=function(t){this.$12.ackReceived(t),this.$10.handleAckReceived(t)},a.__drainReceivedHook=function(t){this.$3===!1&&(this.$6.onStreamMustDrain(this,t),this.$3=!0)},a.__endOfDataHook=function(){this.$12.endOfDataReceived(),this.$4=!0,this.$5?this.$17():this.$6.onServerHasFinishedSendingData(this)},a.__markerPoint=function(t){var e=this.$14;(s||(s=r("QuickPerformanceLogger"))).markerPoint(u,t,{instanceKey:e})},a.__markerAnnotate=function(t){var e=this.$14;(s||(s=r("QuickPerformanceLogger"))).markerAnnotate(u,t,{instanceKey:e})},a.__endMarker=function(t){(s||(s=r("QuickPerformanceLogger"))).markerEnd(u,t,this.$14)},a.$15=function(t,n,r){return this.$2.encodeData(t,n,r,this.$1)},a.$16=function(t,n,r){if(this.__markerPoint("send_data_start"),this.$5)return this.$9.logError(o("DGWLoggingContext").DGWLoggingComponent.GROUPED_STREAM_COMPONENT,"Failed to send data","Stream closed locally"),!1;if(t==null)return!1;var e=this.$8.send(t);return e?(this.__markerPoint("send_data_end"),this.$12.dataSent(t.length,n,r),!0):(this.$9.logError(o("DGWLoggingContext").DGWLoggingComponent.GROUPED_STREAM_COMPONENT,"Failed to send data","ClosedLocally: "+this.$5.toString()),!1)},a.$18=function(t){var e=this.$2.encodeAck(t,this.$1);if(e==null)return this.$9.logError(o("DGWLoggingContext").DGWLoggingComponent.GROUPED_STREAM_COMPONENT,"Failed to encode ACK","ackId: "+t),!1;var n=this.$8.send(e);return n?(this.$12.ackSent(t),!0):(this.$9.logError(o("DGWLoggingContext").DGWLoggingComponent.GROUPED_STREAM_COMPONENT,"Failed to send ACK","ackId: "+t),!1)},t})();l.GroupedStream=c}),98);
__d("StreamIdGenerator",["err"],(function(t,n,r,o,a,i,l){"use strict";var e=65535,s=(function(){function t(){this.$1=new Set,this.$2=0}var n=t.prototype;return n.getNextStreamId=function(){var t;if(!this.streamIdAvailable())throw r("err")("Max number of stream IDs reached");if(this.$2<=e)return this.$2++;var n=(t=this.$1.values().next().value)!=null?t:0;return this.$1.delete(n),n},n.putBackStreamId=function(t){this.$1.add(t)},n.streamIdAvailable=function(){return this.$1.size>0||this.$2<=e},t})();l.MAX_STREAM_ID=e,l.StreamIdGeneratorImpl=s}),98);
__d("StreamGroupWebSocketTransport",["DGWConstants","DGWExponentialBackoff","DGWGlobalLogger","DGWLoggingContext","DGWPinger","DGWStream","DGWStreamGroupCallbacks","DGWTransportEvents","DGWUtils","DGWWebSocketTransport","GroupedStream","Promise","QuickPerformanceLogger","Random","Run","StreamIdGenerator","asyncToGeneratorRuntime","err","getErrorSafe","qex","qpl"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c=r("qpl")._(701238781,"3037"),d=(e=r("qex")._("2103"))!=null?e:!1,m=function(t,n,r,a,i){var e=this;this.groupedStream=t,this.$1=window.setTimeout(function(){r(o("DGWStream").StreamError.ESTABLISHMENT_TIMEOUT)},a),this.handleEstablishFrameReceived=function(){window.clearTimeout(e.$1),n(e.groupedStream)},this.abortStream=function(e){i(),r(e)}},p=(function(){function e(t,n,a,i,l,s,d,m){var p=this,_;this.$18=-1,this.$15=l,this.$17=this.__getStreamIdGenerator(),this.$5=new Map,this.$6=new Map,this.$7=i.keepAliveMs,this.$8=!1,this.$9=!1,this.$3=!0,this.$4=!1,this.$21=!1,this.$22=!1,this.$13=a,this.$11=new TextEncoder,this.$12=new TextDecoder,this.$14=i;var f={onDataReceived:function(){},handleAckReceived:function(){},receivedDrainSignal:function(t){p.$9||(p.$9=!0,p.$15(),p.$13.transportClosed(!0,""),p.$14.streamGroupCallbacks.onStreamGroupMustDrain(t),p.$5.forEach(function(e){e.__drainReceivedHook(t)}),p.onClose(o("DGWConstants").WebsocketCloseCodes.GRACEFUL_CLOSE))},onGroupedStreamDataReceived:function(t,n,r){if(p.$5.has(t)){var e=p.$5.get(t);e==null||e.__dataReceivedHook(n,r)}else p.$13.receivedFrameForInactiveStream("Data",t,"sendAckID: "+(r!=null?r:"null"))},onGroupedStreamAckReceived:function(t,n){if(p.$5.has(t)){var e=p.$5.get(t);e==null||e.__ackReceivedHook(n)}else p.$13.receivedFrameForInactiveStream("ACK",t,"ackId: "+(n!=null?n:"null"))},onGroupedStreamEndOfDataReceived:function(t){if(p.$5.has(t)){var e=p.$5.get(t);e==null||e.__endOfDataHook()}else p.$13.receivedFrameForInactiveStream("EndOfData",t)},onGroupedStreamEstablishStreamReceived:function(t,n){if(p.$6.has(t)){var e=p.$6.get(t);p.$6.delete(t);var r=JSON.parse(p.$12.decode(n));(r.code===void 0||r.code!==200)&&(e==null||e.abortStream(o("DGWStream").StreamError.ABNORMAL_CLOSURE)),e==null||e.handleEstablishFrameReceived()}else p.$13.receivedFrameForInactiveStream("EstablishStream",t,"EstablishStream received for non-inflight stream")},onPingReceived:function(){var e=p.$2.encodePing();e!=null&&p.send(e)},onPongReceived:function(){p.$3=!1,p.$22||(p.$22=!0,p.__markerPoint("auth_success")),p.$13.transportPongReceived("readyState:"+p.$1.readyState+", bufferedAmount:"+p.$1.bufferedAmount)}};this.$2=new(o("DGWUtils")).DGWCodec(s,f,i.dgwVersion),this.$20=Date.now()+(Math.round(o("Random").random()*1e4)+1e4),this.$23=o("DGWGlobalLogger").getInstance(),this.$24=(_=i.connectTimeoutMs)!=null?_:2e4;var g=o("Run").onUnload(function(){p.$23.tabClosed()});if(i.enableFirstStreamOnWsHandshake){var h,y,C,b;if(d===void 0)throw r("err")("Missing grouped stream options");if(m===void 0)throw r("err")("Missing grouped stream callbacks");var v=this.$17.getNextStreamId(),S=this.createEstablishStreamFrame(v,d),R=o("DGWUtils").DGWUtils.constructConnectUrl({appId:i.appId,appVersion:i.appVersion,authType:i.authType,deviceId:(h=i.deviceId)!=null?h:void 0,dgwVersion:i.dgwVersion,fbId:i.fbId,tier:i.tier,loggingId:(y=i.loggingId)!=null?y:void 0,headers:e.__prefixAppHeaders(i.headers),endpoint:i.connectEndpoint,serviceId:i.serviceId,regionHint:(C=i.regionHint)!=null?C:void 0,establishStreamFrame:S,authToken:(b=i.authToken)!=null?b:void 0});if(this.$1=n(R),!R.includes(o("DGWConstants").HEADER_CONSTANTS.HEADER_ESTABLISH_STREAM_FRAME_BASE64))return;var L=new(o("DGWLoggingContext")).DGWLoggingContext(this.$14.dgwVersion,d.loggingId,this.$14.serviceId,this.$14.fbId,this.$14.loggingId,d.disableFalcoLogging),E=this.__createGroupedStream(v,m,d,L);this.$16=this.waitForEstablishStream(v,E,d,function(e){p.$5.set(v,e)},function(){p.$17.putBackStreamId(v)})}else this.$1=n(t);this.$23.streamRequested(i.serviceId),(u||(u=r("QuickPerformanceLogger"))).markerStart(c,this.$20),this.__markerAnnotate({string:{serviceId:this.$14.serviceId,streamGroupId:this.$14.loggingId}})}var t=e.prototype;return t.send=function(t){try{return this.$1.send(t),!0}catch(e){return this.$13.transportError("Failed to send over transport","readyState: "+this.$1.readyState,r("getErrorSafe")(e).message),!1}},t.close=function(){var e;this.$23.streamClosed(this.$14.serviceId),this.__markerPoint("teardown"),this.$8=!0,(e=this.$10)==null||e.cancel(),this.$1.onopen=function(e){},this.$1.onmessage=function(e){},this.$1.onerror=function(e){},this.$1.onclose=function(e){},this.$1.close()},t.onClose=function(t){var e;this.$23.streamClosed(this.$14.serviceId),this.__markerPoint("abort"),this.__markerAnnotate({int:{abort_code:t}}),this.$8=!0,(e=this.$10)==null||e.cancel(),this.$1.close(t)},t.abort=function(t,n,r,o,a){this.$8||(this.$23.streamClosed(this.$14.serviceId),this.$8=!0,this.$13.transportClosed(!1,o,a),this.$5.forEach(function(e){e.__transportCloseHook(n)}),this.$6.forEach(function(e){e.abortStream(n)}),this.$14.streamGroupCallbacks.onStreamGroupError(t),this.$5.clear(),this.$6.clear(),this.$15(),this.onClose(r))},e.getTransportWithInitialStream=(function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,n,r,a,i,l){yield o("DGWUtils").DGWCodec.initialize();var s=new(o("DGWTransportEvents")).DGWTransportEvents(a);s.transportEstablishmentPending();var u=function(){return e.$25("",r,s,i,a,t,n)};try{var c=yield o("DGWExponentialBackoff").callWithExponentialBackoff(u,l),d=c.$16!=null?c.$16:c.establishGroupedStream(n,t,new(o("DGWLoggingContext")).DGWLoggingContext(r.dgwVersion,t.loggingId,r.serviceId,r.fbId,r.loggingId,t.disableFalcoLogging));return{transport:c,streamPromise:d}}catch(e){throw e}});function r(e,n,r,o,a,i){return t.apply(this,arguments)}return r})(),e.getTransport_DEPRECATED=(function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,n,r,a,i){yield o("DGWUtils").DGWCodec.initialize();var l=new(o("DGWTransportEvents")).DGWTransportEvents(r);l.transportEstablishmentPending();var s=function(){return e.$25(t,n,l,a,r)};try{return yield o("DGWExponentialBackoff").callWithExponentialBackoff(s,i)}catch(e){throw e}});function r(e,n,r,o,a){return t.apply(this,arguments)}return r})(),t.establishGroupedStream=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,o,a,i,l){var u=this;i===void 0&&(i=!0);var c=this.getStreamId(),d=this.createEstablishStreamFrame(c,t),m=this.__createGroupedStream(c,e,t,o);m.__markerAnnotate({string:{serviceId:this.$14.serviceId,streamGroupId:this.$14.loggingId,streamId:t.streamTraceId}}),l!=null&&m.__markerAnnotate(l);var p=this.waitForEstablishStream(c,m,t,function(e){u.$5.set(c,e)},function(){u.$17.putBackStreamId(c)});if(a!=null){var _;m.__markerPoint("send_payload_start"),m.__markerAnnotate({int:{establishStreamPayloadSize:a.byteLength}});var f=(_=t.ackTimeoutMs)!=null?_:3e4,g=i?yield m.sendFrame(d,a,f):m.sendFrameAndForget(d,a);return g?(m.__markerPoint("send_payload_end"),m.__endMarker(2),(s||(s=n("Promise"))).resolve(m)):(m.__endMarker(3),(s||(s=n("Promise"))).reject("Failed to send data when establishing stream"))}if(m.__markerPoint("send_establish_stream_start"),!this.send(d))throw m.__endMarker(3),r("err")("Websocket connection closed before stream established");m.__markerPoint("send_establish_stream_end");var h=yield p;return m.__endMarker(2),h});function t(t,n,r,o,a,i){return e.apply(this,arguments)}return t})(),e.__prefixAppHeaders=function(t){return Object.keys(t).reduce(function(e,n){return e[""+o("DGWConstants").HEADER_CONSTANTS.APPHEADER_PREFIX+n]=t[n],e},{})},t.waitForEstablishStream=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,r,o,a){var i=this;this.$13.streamEstablishmentPending(e,r.loggingId);try{var l=yield new(s||(s=n("Promise")))(function(n,r){i.$6.set(e,new m(t,n,r,3e4,function(){i.streamEndCallback(e)}))});return o(t),this.$13.streamEstablishmentSuccess(e,r.loggingId),l}catch(t){throw a(),this.$13.streamEstablishmentTimeout("Stream establishment timeout. readyState: "+this.$1.readyState,e,r.loggingId),t}});function t(t,n,r,o,a){return e.apply(this,arguments)}return t})(),e.$25=(function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,n,r,a,i,l,s){var u=new e(t,o("DGWWebSocketTransport").getWebSocketConnection,r,n,a,i,l,s);u.$1.onmessage=e.$26(u),u.$1.onopen=function(){u.__markerPoint("onopen"),r.transportEstablished(t),u.$10!=null&&u.$10.cancel(),u.$7!=null&&(u.$10=new(o("DGWPinger")).DGWPinger(u.$7,function(){u.$27()},function(){u.abort(o("DGWStreamGroupCallbacks").DGWStreamGroupError.TRANSPORT_KEEPALIVE_TIMEOUT,o("DGWStream").StreamError.KEEPALIVE_TIMEOUT,o("DGWConstants").WebsocketCloseCodes.KEEPALIVE_TIMEOUT,"Aborting transport because of keepalive timeout","readyState:"+u.$1.readyState+", bufferedAmount:"+u.$1.bufferedAmount)}))},u.$1.onerror=function(){u.__markerPoint("onerror"),u.$13.transportError("onerror","readyState: "+u.$1.readyState)},u.$1.onclose=e.$28(u);var c=yield e.getTransportPromise(u);return c});function r(e,n,r,o,a,i,l){return t.apply(this,arguments)}return r})(),e.getTransportPromise=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=yield new(s||(s=n("Promise")))(function(t,n){var r=e.$1.onerror,a=e.$1.onmessage,i=e.$1.onclose;e.$19=window.setTimeout(function(){e.$15(),e.$13.transportClosed(!1,"TIMEOUT"),e.__markerPoint("connect_timeout"),e.close(),n(o("DGWStream").StreamError.TRANSPORT_ESTABLISHMENT_TIMEOUT)},e.$24),e.$1.onerror=function(){e.$19!=null&&(window.clearTimeout(e.$19),e.$19=null),r(),e.close(),d||n(o("DGWStream").StreamError.ESTABLISHMENT_ERROR)},e.$1.onclose=function(t){e.$19!=null&&(window.clearTimeout(e.$19),e.$19=null),i(t),t.code===o("DGWConstants").WebsocketCloseCodes.UNAUTHORIZED?n(o("DGWStream").StreamError.UNAUTHORIZED):n(t.code+":"+t.reason)},e.$1.onmessage=function(n){a(n),e.$19!=null&&!e.$3&&(window.clearTimeout(e.$19),e.$19=null,e.__markerPoint("connect_success"),t(e))}});return t});function t(t){return e.apply(this,arguments)}return t})(),e.$26=function(t){return function(e){var n;if(t.$21||(t.$21=!0,t.__markerPoint("onmessage")),(n=t.$10)==null||n.reset(),!(e.data instanceof ArrayBuffer)){t.$13.transportError("Incorrect Data Protocol","Received "+typeof e.data+" instead of ArrayBuffer");return}t.$2.append(new Uint8Array(e.data)),t.$2.processData()}},e.$28=function(t){return function(e){var n,r=t.$23.getGlobalState();if(t.__markerPoint("onclose"),t.__markerAnnotate({string:{reason:e.reason},int:{code:e.code,realtimeWebSockets:r.realtime,lightspeedWebSockets:r.lightspeed}}),t.__endMarker(e.code===o("DGWConstants").WebsocketCloseCodes.GRACEFUL_CLOSE?2:3),(n=t.$10)==null||n.cancel(),!(t.$8===!0||t.$4)){if(t.$23.streamClosed(t.$14.serviceId),t.$8=!0,t.$3===!0){t.$13.transportEstablishmentFailure(e),t.$5.clear(),t.$15();return}if(t.$15(),t.$3=!0,e.code!==o("DGWConstants").WebsocketCloseCodes.GRACEFUL_CLOSE){t.$13.transportClosed(!1,"Websocket connection failure with code: "+e.code+" reason: "+e.reason+" wasClean: "+String(e.wasClean));var a=o("DGWStreamGroupCallbacks").DGWStreamGroupError.TRANSPORT_UNKNOWN_ERROR,i=o("DGWStream").StreamError.UNKNOWN_ERROR;switch(e.code){case o("DGWConstants").WebsocketCloseCodes.NORMAL_CLOSURE:a=o("DGWStreamGroupCallbacks").DGWStreamGroupError.TRANSPORT_NORMAL_CLOSURE,i=o("DGWStream").StreamError.ABNORMAL_CLOSURE;break;case o("DGWConstants").WebsocketCloseCodes.ABNORMAL_CLOSURE:a=o("DGWStreamGroupCallbacks").DGWStreamGroupError.TRANSPORT_ABNORMAL_CLOSURE,i=o("DGWStream").StreamError.ABNORMAL_CLOSURE;break;case o("DGWConstants").WebsocketCloseCodes.SERVER_INTERNAL_ERROR:a=o("DGWStreamGroupCallbacks").DGWStreamGroupError.TRANSPORT_SERVER_INTERNAL_ERROR,i=o("DGWStream").StreamError.SERVER_INTERNAL_ERROR;break;case o("DGWConstants").WebsocketCloseCodes.GOING_AWAY:a=o("DGWStreamGroupCallbacks").DGWStreamGroupError.TRANSPORT_GOING_AWAY,i=o("DGWStream").StreamError.GOING_AWAY;break;case o("DGWConstants").WebsocketCloseCodes.UNAUTHORIZED:a=o("DGWStreamGroupCallbacks").DGWStreamGroupError.TRANSPORT_UNAUTHORIZED,i=o("DGWStream").StreamError.UNAUTHORIZED;break;case o("DGWConstants").WebsocketCloseCodes.REJECTED:a=o("DGWStreamGroupCallbacks").DGWStreamGroupError.TRANSPORT_REJECTED,i=o("DGWStream").StreamError.REJECTED;break;case o("DGWConstants").WebsocketCloseCodes.BAD_REQUEST:a=o("DGWStreamGroupCallbacks").DGWStreamGroupError.TRANSPORT_BAD_REQUEST,i=o("DGWStream").StreamError.BAD_REQUEST;break;case o("DGWConstants").WebsocketCloseCodes.DGW_SERVER_ERROR:a=o("DGWStreamGroupCallbacks").DGWStreamGroupError.TRANSPORT_SERVER_INTERNAL_ERROR,i=o("DGWStream").StreamError.DGW_SERVER_ERROR,a=o("DGWStreamGroupCallbacks").DGWStreamGroupError.TRANSPORT_DGW_SERVER_ERROR;break;default:a=o("DGWStreamGroupCallbacks").DGWStreamGroupError.TRANSPORT_UNKNOWN_ERROR,i=o("DGWStream").StreamError.UNKNOWN_ERROR;break}t.$14.streamGroupCallbacks.onStreamGroupError(a),t.$5.forEach(function(e){e.__transportCloseHook(i)}),t.$6.forEach(function(e){e.abortStream(i)})}else t.$13.transportClosed(!0,""),t.$14.streamGroupCallbacks.onStreamGroupTransportClose(),t.$5.forEach(function(e){e.__transportCloseHook()}),t.$6.forEach(function(e){e.abortStream(o("DGWStream").StreamError.TRANSPORT_CLOSED_BEFORE_STREAM_INIT)});t.$5.clear(),t.$6.clear()}}},t.$27=function(){var e=this.$2.encodePing();if(e==null)throw r("err")("Failed to encode Ping Frame");var t=this.send(e);this.$18=this.$1.bufferedAmount,this.$13.transportPingSent("readyState:"+this.$1.readyState+", bufferedAmount:"+this.$18+", payloadSize:"+(e==null?void 0:e.byteLength)+", sent:"+String(t))},t.isClosedLocally=function(){return this.$3||this.$8||this.$4},t.streamEndCallback=function(t){this.$5.delete(t),this.$6.delete(t),this.$17.putBackStreamId(t)},t.canCreateGroupedStream=function(){return this.$17.streamIdAvailable()},t.createEstablishStreamFrame=function(n,a){var t=e.__prefixAppHeaders(a.groupedStreamHeaders);a.streamTraceId!=null&&(t[o("DGWConstants").HEADER_CONSTANTS.HEADER_STREAM_TRACE_ID]=a.streamTraceId);var i=this.$2.encodeEstablishStream(n,new Uint8Array(this.$11.encode(JSON.stringify(t))));if(i==null)throw this.$17.putBackStreamId(n),r("err")("Failed to encode EstablishStreamFrame");return i},t.getStreamId=function(){try{return this.$17.getNextStreamId()}catch(e){throw this.$13.ranOutOfStreamIds("inFlightGroupedStreamSize: "+this.$6.size+" groupedStreamSize: "+this.$5.size),e}},t.__createGroupedStream=function(t,n,r,a){var e=this;return new(o("GroupedStream")).GroupedStream(t,n,r,this,a,this.$2,function(){e.streamEndCallback(t)})},t.__getStreamIdGenerator=function(){return new(o("StreamIdGenerator")).StreamIdGeneratorImpl},t.__markerPoint=function(t){var e=this.$20;(u||(u=r("QuickPerformanceLogger"))).markerPoint(c,t,{instanceKey:e})},t.__markerAnnotate=function(t){var e=this.$20;(u||(u=r("QuickPerformanceLogger"))).markerAnnotate(c,t,{instanceKey:e})},t.__endMarker=function(t){(u||(u=r("QuickPerformanceLogger"))).markerEnd(c,t,this.$20)},e})();l.StreamGroupWebSocketTransport=p}),98);
__d("StreamGroup",["DGWConstants","DGWLoggingContext","DGWUtils","StreamGroupWebSocketTransport","asyncToGeneratorRuntime","justknobx"],(function(t,n,r,o,a,i,l){"use strict";var e={maxRetries:r("justknobx")._("2595"),baseRetryInterval:1e3,backoffFactor:Math.sqrt(2)},s=(function(){function t(e,t,n,r,a,i,l,s,u){var c,d,m,p,_,f,g,h,y;this.$2=u,this.$1=u.getNewStreamGroupId();var C=(c=l.overrideUrl)!=null?c:a;this.$5=null,this.$3={appId:e,appVersion:t,authType:(d=l.authType)!=null?d:n,deviceId:l.deviceId,dgwVersion:r,headers:l.streamGroupAppHeaders,tier:(m=l.serviceTier)!=null?m:o("DGWConstants").DEFAULT_SERVICE_TIER,connectEndpoint:C,fbId:i,loggingId:l.loggingId,serviceId:l.serviceId,streamGroupCallbacks:s,keepAliveMs:l.keepAliveMs,regionHint:l.regionHint,enableFirstStreamOnWsHandshake:!1,authToken:l.authToken,connectTimeoutMs:l.connectTimeoutMs},this.$4=l,this.streamGroupLoggingContext=new(o("DGWLoggingContext")).DGWLoggingContext(this.$3.dgwVersion,null,this.$3.serviceId,this.$3.fbId,this.$4.loggingId,!1,(p=l.verboseLoggingEnabled)!=null?p:!1),this.$6=o("DGWUtils").DGWUtils.constructConnectUrl({appId:this.$3.appId,appVersion:this.$3.appVersion,authType:this.$3.authType,deviceId:(_=this.$3.deviceId)!=null?_:void 0,dgwVersion:this.$3.dgwVersion,fbId:this.$3.fbId,headers:babelHelpers.extends({},this.$3.headers),loggingId:(f=this.$3.loggingId)!=null?f:void 0,tier:this.$3.tier,serviceId:this.$3.serviceId,endpoint:this.$3.connectEndpoint,regionHint:(g=this.$3.regionHint)!=null?g:void 0,trafficTracing:(h=this.$4.trafficTracing)!=null?h:void 0,authToken:(y=this.$4.authToken)!=null?y:void 0})}var r=t.prototype;return r.initTransport=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=this,t={maxRetries:0,baseRetryInterval:1e3,backoffFactor:Math.sqrt(2)};this.$5=this.$5||o("StreamGroupWebSocketTransport").StreamGroupWebSocketTransport.getTransport_DEPRECATED(this.$6,this.$3,this.streamGroupLoggingContext,function(){e.$2.removeStreamGroupAndTransport(e.$1)},t);var n;try{n=yield this.$5,this.$5=null}catch(e){throw this.$5=null,e}return this.$2.containsStreamGroup(this.$1)||this.$2.setStreamGroupAndTransport(this.$1,n),n});function t(){return e.apply(this,arguments)}return t})(),r.establishStream=(function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,n,r,a,i){var l=this;if(this.$2.containsStreamGroup(this.$1)===!1)if(this.streamGroupLoggingContext.logEvent(o("DGWLoggingContext").DGWLoggingComponent.STREAM_GROUP_COMPONENT,"createTransportWhenEstablishStream"),this.$3.enableFirstStreamOnWsHandshake){var u=yield o("StreamGroupWebSocketTransport").StreamGroupWebSocketTransport.getTransportWithInitialStream(t,n,this.$3,this.streamGroupLoggingContext,function(){l.$2.removeStreamGroupAndTransport(l.$1)},e);return this.$2.setStreamGroupAndTransport(this.$1,u.transport),u.streamPromise}else{this.$5=this.$5||o("StreamGroupWebSocketTransport").StreamGroupWebSocketTransport.getTransport_DEPRECATED(this.$6,this.$3,this.streamGroupLoggingContext,function(){l.$2.removeStreamGroupAndTransport(l.$1)},e);var s;try{s=yield this.$5,this.$5=null}catch(e){throw this.$5=null,e}this.$2.containsStreamGroup(this.$1)||this.$2.setStreamGroupAndTransport(this.$1,s)}return this.establishStreamWithTransport(t,n,r,a,i)});function r(e,n,r,o,a){return t.apply(this,arguments)}return r})(),r.establishStreamWithTransport=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n,r,a){var i,l=e.loggingId;this.streamGroupLoggingContext.logEvent(o("DGWLoggingContext").DGWLoggingComponent.STREAM_GROUP_COMPONENT,"Establishing Grouped Stream","initialData:"+String(n!=null),!0,l);var s=yield this.$2.getStreamGroupTransport(this.$1).establishGroupedStream(t,e,new(o("DGWLoggingContext")).DGWLoggingContext(this.$3.dgwVersion,l,this.$3.serviceId,this.$3.fbId,this.$3.loggingId,e.disableFalcoLogging,(i=e.verboseLoggingEnabled)!=null?i:!1),n,r,a);return s});function t(t,n,r,o,a){return e.apply(this,arguments)}return t})(),r.canCreateGroupedStream=function(){var e=!0;if(this.$2.containsStreamGroup(this.$1)!==!1){var t=this.$2.getStreamGroupTransport(this.$1);e=t.canCreateGroupedStream()}return o("DGWLoggingContext").DGWLoggingContext.bumpODSKey(o("DGWLoggingContext").DGWLoggingComponent.STREAM_GROUP_COMPONENT,e?"can_create":"cannot_create"),e},r.close=function(){if(this.$2.containsStreamGroup(this.$1)){var e=this.$2.getStreamGroupTransport(this.$1);e.close()}},t})();l.StreamGroup=s}),98);
__d("StreamGroupRegistry",["Random","err"],(function(t,n,r,o,a,i,l){"use strict";var e=(function(){function e(){this.$1=new Map,this.$2=new Set}var t=e.prototype;return t.setStreamGroupAndTransport=function(t,n){this.$1.set(t,n)},t.containsStreamGroup=function(t){return this.$1.has(t)},t.removeStreamGroupAndTransport=function(t){this.$1.delete(t)},t.getStreamGroupTransport=function(t){var e=this.$1.get(t);if(e==null)throw r("err")("No stream group transport");return e},t.getNewStreamGroupId=function(){for(var e=o("Random").uint32();this.$2.has(e);)e=o("Random").uint32();return this.$2.add(e),e},e})();l.StreamGroupRegistry=e}),98);
__d("RawDGWClient",["CurrentUser","DGWAuth","DGWLoggingContext","DGWStream","StreamGroup","StreamGroupRegistry","isFastRefreshEnabledForCurrentDomain"],(function(t,n,r,o,a,i,l){"use strict";var e=(function(){function e(e){var t=e.appId,n=e.appVersion,r=e.authType,a=e.dgwVersion,i=e.endpoint,l=e.fbId,s=e.authToken;this.$1=t,this.$2=n,this.$3=r,this.$5=a,this.$6=i,this.$7=l,this.$8=new(o("StreamGroupRegistry")).StreamGroupRegistry,this.$4=s}var t=e.prototype;return t.createStreamGroup=function(t,n){var e,r;this.handleUserChecks((e=n.authType)!=null?e:this.$3);var a=(r=n.authToken)!=null?r:this.$4;return a!=null&&this.$3===o("DGWAuth").DGWAuth.GUEST&&(n.authToken=a),new(o("StreamGroup")).StreamGroup(this.$1,this.$2,this.$3,this.$5,this.$6,this.$7,n,t,this.$8)},t.handleUserChecks=function(t){if(!r("CurrentUser").isLoggedInNow()&&o("DGWAuth").fromDGWAuthToString(t)!=="GUEST"&&!r("isFastRefreshEnabledForCurrentDomain")())throw o("DGWLoggingContext").DGWLoggingContext.bumpODSKey(o("DGWLoggingContext").DGWLoggingComponent.RAW_CLIENT,"unauthenticated"),o("DGWStream").StreamError.UNAUTHENTICATED},e})();l.RawDGWClient=e}),98);
__d("DGWClient",["DGWAuth","DGWEnvUtil","DGWWebConfig","RawDGWClient","err"],(function(t,n,r,o,a,i,l){"use strict";var e,s=new(o("RawDGWClient")).RawDGWClient({appId:r("DGWWebConfig").appId,appVersion:r("DGWWebConfig").appVersion,authType:o("DGWAuth").fromStringToDGWAuth((e=r("DGWEnvUtil")).getDGWAuthType()),dgwVersion:e.getDGWVersion(),endpoint:e.getDGWEndpoint(),fbId:r("DGWWebConfig").fbId,authToken:e.getDGWAuthToken()});function u(){if(r("DGWEnvUtil").isDGWEnvCompatible())return s;throw r("err")("unsupported_environment_retry_with_mqtt")}l.default=u}),98);
__d("DGWRequestStreamUtils",["Base64","WebDriverConfig","cr:3024","gkx"],(function(t,n,r,o,a,i,l){"use strict";function e(e,t,o,a){var i={};for(var l of Object.entries(e)){var s=l[0],u=l[1];typeof u=="string"?i["XRSS-"+s]=u:typeof u=="number"?i["XRSN-"+s]=u.toString():typeof u=="boolean"?i["XRSB-"+s]=u.toString():typeof u=="object"&&u!=null&&(i["XRSO-"+s]=r("Base64").encode(JSON.stringify(u)))}if(t&&(i["xrs-body"]="true"),o!=null&&o.length>0&&(i["xrs-instrumentation"]=r("Base64").encode(o)),i["XRS-Accept-Ack"]="RSAck",a!=null&&a.ackTimeoutSec!=null&&(i["XRS-SRAck-Timeout"]=a.ackTimeoutSec.toString()),i["XRSS-http_referer"]=window.location.href,r("WebDriverConfig").isTestRunning&&r("gkx")("20919")){var c=n("cr:3024")==null?void 0:n("cr:3024").get();c!=null&&(i["XRSB-is_test"]="true",i["XRSS-original_request_id"]=c)}return i}function s(e){return Object.keys(e).reduce(function(t,n){return(typeof e[n]=="string"||typeof e[n]=="boolean"||typeof e[n]=="number"||typeof e[n]=="object")&&(t[n]=e[n]),t},{})}function u(e){if(e.response&&e.response.instrumentation_data!=null&&e.response.instrumentation_data.length>0)try{var t,n=JSON.parse(new TextDecoder("utf-8").decode(e.response.instrumentation_data));return{auxId:n.auxId,dfTraceId:(t=n.dataFlowTracingData)==null?void 0:t.traceId}}catch(e){}return null}function c(e,t){var n=e.headers,r=e.body;if(t.kill_body===!0&&(r=null),t.new_body!=null&&(r=t.new_body),t.new_headers!=null)try{n=s(JSON.parse(t.new_headers))}catch(e){}if(t.patch_headers!=null)try{n=babelHelpers.extends({},n,s(JSON.parse(t.patch_headers)))}catch(e){}return{headers:n,body:r}}l.convertHeaders=e,l.cleanHeaders=s,l.getInstrumentationDataFieldsFromPayload=u,l.transformContextWithRewriteDelta=c}),98);
__d("DGWStreamHandler",[],(function(t,n,r,o,a,i){"use strict";var e=(function(){function e(e,t,n,r,o){this.$2=e,this.$3=t,this.$4=n,this.$5=r,this.$6=o,this.$1=!0}var t=e.prototype;return t.onClose=function(t){this.$1&&this.$2(t)},t.onDataReceived=function(t){this.$1&&this.$3(t)},t.onError=function(t){this.$1&&this.$4(t)},t.onStreamMustDrain=function(t,n){this.$1&&this.$5(t,n)},t.onServerHasFinishedSendingData=function(t){this.$1&&this.$6(t)},t.stop=function(){this.$1=!1},t.isStopped=function(){return!this.$1},e})();i.default=e}),66);
__d("InflightAmends",["Deferred","err"],(function(t,n,r,o,a,i,l){"use strict";var e="inflight_amends_timeout",s="inflight_amends_duplicate_id",u=(function(){function t(e,t,n){this.$1=e,this.$3=t,this.$4=n,this.$2=new Map}var n=t.prototype;return n.add=function(n){var t=this;if(this.$2.has(n))throw r("err")(s);var o=new(r("Deferred")),a=Date.now(),i=setTimeout(function(){t.$2.has(n)&&t.reject(n,r("err")(e))},this.$1);return this.$2.set(n,{id:n,deferred:o,createdTimestampMs:a,timeoutId:i}),o.getPromise()},n.getPromise=function(t){var e;return(e=this.$5(t))==null?void 0:e.deferred.getPromise()},n.resolve=function(t,n){var e=this.$5(t);e&&(e.deferred.resolve==null||e.deferred.resolve(n),this.$3(e.id,Date.now()-e.createdTimestampMs),this.$6(e))},n.reject=function(t,n){var e=this.$5(t);e&&(e.deferred.reject==null||e.deferred.reject(n),this.$4(e.id,n),this.$6(e))},n.rejectAll=function(t){for(var e of this.$2.entries()){var n=e[0],r=e[1];this.reject(n,t)}},n.getSize=function(){return this.$2.size},n.getAllPromises=function(){var e=[];for(var t of this.$2.values())e.push(t.deferred.getPromise());return e},n.$6=function(t){clearTimeout(t.timeoutId),this.$2.delete(t.id)},n.$5=function(t){return this.$2.get(t)},t})();l.default=u}),98);
__d("RequestStreamCloseReason",["$InternalEnum"],(function(t,n,r,o,a,i){"use strict";var e=n("$InternalEnum").Mirrored(["UserIntention","StartStreamFailure","StreamError","RemoteTermination","ServerDataEnd","ServerDrain","ReestablishError","ClientError"]);i.RequestStreamCloseReason=e}),66);
__d("RequestStreamCommonRequestStreamCommonTypes",["$InternalEnum"],(function(t,n,r,o,a,i){"use strict";var e,l=(e=n("$InternalEnum"))({Accepted:1,Started:2,Stopped:3}),s=e({Rejected:40,Error:50,TryAgain:80,Closed:99}),u=e({BestEffort:0,Socket:10,Device:20}),c=e({Flow_status:"flow_status",Log:"log",Rewrite:"rewrite",Data:"data",Termination:"termination",Amend_ack:"amend_ack"});a.exports={AckLevel:u,FlowStatus:l,StreamResponseDelta$Types:c,TerminationReason:s}}),null);
__d("RequestStreamCommonRequestStreamCommonSerializers",["RequestStreamCommonRequestStreamCommonTypes","ThriftTypes","jsbi"],(function(t,n,r,o,a,i,l){"use strict";var e;function s(){return{}}function u(){return{expected_existing_headers:"",patch_headers_if_match:""}}function c(){return{bytes:Uint8Array.of()}}function d(){return{message:""}}function m(){return{reason:o("RequestStreamCommonRequestStreamCommonTypes").TerminationReason.cast(0)}}function p(){return{}}function _(){return{stream_id:"0",last_sequencer:0,amendment_count:0,last_status:o("RequestStreamCommonRequestStreamCommonTypes").FlowStatus.cast(0)}}function f(){return{caller_timestamp_ms:"0"}}function g(){return{original_ping_timestamp_ms:"0"}}function h(){return{}}function y(t,n){n.writeStructBegin("ResponseRewriteRequest"),t.new_headers!=null&&(n.writeFieldBegin({fname:"new_headers",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:1}),n.writeString(t.new_headers),n.writeFieldEnd()),t.new_body!=null&&(n.writeFieldBegin({fname:"new_body",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:2}),n.writeBinary(t.new_body),n.writeFieldEnd()),t.patch_headers!=null&&(n.writeFieldBegin({fname:"patch_headers",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:3}),n.writeString(t.patch_headers),n.writeFieldEnd()),t.kill_body!=null&&(n.writeFieldBegin({fname:"kill_body",ftype:(e||(e=r("ThriftTypes"))).BOOL,fid:4}),n.writeBool(t.kill_body),n.writeFieldEnd()),t.temporary!=null&&(n.writeFieldBegin({fname:"temporary",ftype:(e||(e=r("ThriftTypes"))).BOOL,fid:5}),n.writeBool(t.temporary),n.writeFieldEnd()),t.conditional_patch_headers!=null&&(n.writeFieldBegin({fname:"conditional_patch_headers",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:6}),C(t.conditional_patch_headers,n),n.writeFieldEnd()),n.writeFieldStop(),n.writeStructEnd()}function C(t,n){if(n.writeStructBegin("ResponseRewriteConditionalPatchHeaders"),n.writeFieldBegin({fname:"expected_existing_headers",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:1}),t.expected_existing_headers!=null)n.writeString(t.expected_existing_headers);else{var o="";n.writeString(o)}if(n.writeFieldEnd(),n.writeFieldBegin({fname:"patch_headers_if_match",ftype:e.STRING,fid:2}),t.patch_headers_if_match!=null)n.writeString(t.patch_headers_if_match);else{var a="";n.writeString(a)}n.writeFieldEnd(),t.patch_headers_otherwise!=null&&(n.writeFieldBegin({fname:"patch_headers_otherwise",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:3}),n.writeString(t.patch_headers_otherwise),n.writeFieldEnd()),n.writeFieldStop(),n.writeStructEnd()}function b(t,n){if(n.writeStructBegin("ResponseData"),n.writeFieldBegin({fname:"bytes",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:1}),t.bytes!=null)n.writeBinary(t.bytes);else{var o=Uint8Array.of();n.writeBinary(o)}n.writeFieldEnd(),t.metadata!=null&&(n.writeFieldBegin({fname:"metadata",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:2}),n.writeString(t.metadata),n.writeFieldEnd()),n.writeFieldStop(),n.writeStructEnd()}function v(t,n){if(n.writeStructBegin("LogMessage"),n.writeFieldBegin({fname:"message",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:1}),t.message!=null)n.writeString(t.message);else{var o="";n.writeString(o)}n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd()}function S(t,n){if(n.writeStructBegin("Termination"),n.writeFieldBegin({fname:"reason",ftype:(e||(e=r("ThriftTypes"))).I32,fid:1}),t.reason!=null){var a;n.writeI32((a=t.reason)!=null?a:0)}else{var i=o("RequestStreamCommonRequestStreamCommonTypes").TerminationReason.cast(0);n.writeI32(i!=null?i:0)}n.writeFieldEnd(),t.message!=null&&(n.writeFieldBegin({fname:"message",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:2}),n.writeString(t.message),n.writeFieldEnd()),t.retry_delay_ms!=null&&(n.writeFieldBegin({fname:"retry_delay_ms",ftype:(e||(e=r("ThriftTypes"))).I64,fid:3}),n.writeI64(r("jsbi").BigInt(t.retry_delay_ms)),n.writeFieldEnd()),n.writeFieldStop(),n.writeStructEnd()}function R(t,n){n.writeStructBegin("AmendStreamAck"),t.amendment_id!=null&&(n.writeFieldBegin({fname:"amendment_id",ftype:(e||(e=r("ThriftTypes"))).I64,fid:1}),n.writeI64(r("jsbi").BigInt(t.amendment_id)),n.writeFieldEnd()),t.accepted!=null&&(n.writeFieldBegin({fname:"accepted",ftype:(e||(e=r("ThriftTypes"))).BOOL,fid:2}),n.writeBool(t.accepted),n.writeFieldEnd()),t.result!=null&&(n.writeFieldBegin({fname:"result",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:3}),n.writeBinary(t.result),n.writeFieldEnd()),n.writeFieldStop(),n.writeStructEnd()}function L(t,n){if(n.writeStructBegin("StreamCheck"),n.writeFieldBegin({fname:"stream_id",ftype:(e||(e=r("ThriftTypes"))).I64,fid:1}),t.stream_id!=null)n.writeI64(r("jsbi").BigInt(t.stream_id));else{var a="0";n.writeI64(r("jsbi").BigInt(a))}if(n.writeFieldEnd(),n.writeFieldBegin({fname:"last_sequencer",ftype:e.I32,fid:2}),t.last_sequencer!=null)n.writeI32(t.last_sequencer);else{var i=0;n.writeI32(i)}if(n.writeFieldEnd(),n.writeFieldBegin({fname:"amendment_count",ftype:e.I32,fid:4}),t.amendment_count!=null)n.writeI32(t.amendment_count);else{var l=0;n.writeI32(l)}if(n.writeFieldEnd(),n.writeFieldBegin({fname:"last_status",ftype:e.I32,fid:3}),t.last_status!=null){var s;n.writeI32((s=t.last_status)!=null?s:0)}else{var u=o("RequestStreamCommonRequestStreamCommonTypes").FlowStatus.cast(0);n.writeI32(u!=null?u:0)}n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd()}function E(t,n){if(n.writeStructBegin("Ping"),n.writeFieldBegin({fname:"caller_timestamp_ms",ftype:(e||(e=r("ThriftTypes"))).I64,fid:1}),t.caller_timestamp_ms!=null)n.writeI64(r("jsbi").BigInt(t.caller_timestamp_ms));else{var o="0";n.writeI64(r("jsbi").BigInt(o))}if(n.writeFieldEnd(),t.streams_to_check!=null){n.writeFieldBegin({fname:"streams_to_check",ftype:(e||(e=r("ThriftTypes"))).LIST,fid:2}),n.writeListBegin({etype:e.STRUCT,size:t.streams_to_check.length});for(var a of t.streams_to_check)L(a,n);n.writeListEnd(),n.writeFieldEnd()}n.writeFieldStop(),n.writeStructEnd()}function k(t,n){if(n.writeStructBegin("Pong"),n.writeFieldBegin({fname:"original_ping_timestamp_ms",ftype:(e||(e=r("ThriftTypes"))).I64,fid:1}),t.original_ping_timestamp_ms!=null)n.writeI64(r("jsbi").BigInt(t.original_ping_timestamp_ms));else{var o="0";n.writeI64(r("jsbi").BigInt(o))}if(n.writeFieldEnd(),t.stream_ids_missing!=null){n.writeFieldBegin({fname:"stream_ids_missing",ftype:(e||(e=r("ThriftTypes"))).LIST,fid:2}),n.writeListBegin({etype:e.I64,size:t.stream_ids_missing.length});for(var a of t.stream_ids_missing)n.writeI64(r("jsbi").BigInt(a));n.writeListEnd(),n.writeFieldEnd()}if(t.stream_ids_behind!=null){n.writeFieldBegin({fname:"stream_ids_behind",ftype:(e||(e=r("ThriftTypes"))).LIST,fid:3}),n.writeListBegin({etype:e.I64,size:t.stream_ids_behind.length});for(var i of t.stream_ids_behind)n.writeI64(r("jsbi").BigInt(i));n.writeListEnd(),n.writeFieldEnd()}if(t.stream_ids_with_lost_amendments!=null){n.writeFieldBegin({fname:"stream_ids_with_lost_amendments",ftype:(e||(e=r("ThriftTypes"))).LIST,fid:4}),n.writeListBegin({etype:e.I64,size:t.stream_ids_with_lost_amendments.length});for(var l of t.stream_ids_with_lost_amendments)n.writeI64(r("jsbi").BigInt(l));n.writeListEnd(),n.writeFieldEnd()}if(t.stream_ids_with_wrong_status!=null){n.writeFieldBegin({fname:"stream_ids_with_wrong_status",ftype:(e||(e=r("ThriftTypes"))).LIST,fid:5}),n.writeListBegin({etype:e.I64,size:t.stream_ids_with_wrong_status.length});for(var s of t.stream_ids_with_wrong_status)n.writeI64(r("jsbi").BigInt(s));n.writeListEnd(),n.writeFieldEnd()}n.writeFieldStop(),n.writeStructEnd()}function I(t,n){if(n.writeStructBegin("StreamResponseDelta"),t.flow_status!=null){var o;n.writeFieldBegin({fname:"flow_status",ftype:(e||(e=r("ThriftTypes"))).I32,fid:1}),n.writeI32((o=t.flow_status)!=null?o:0),n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd();return}if(t.log!=null){n.writeFieldBegin({fname:"log",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:2}),v(t.log,n),n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd();return}if(t.rewrite!=null){n.writeFieldBegin({fname:"rewrite",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:3}),y(t.rewrite,n),n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd();return}if(t.data!=null){n.writeFieldBegin({fname:"data",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:4}),b(t.data,n),n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd();return}if(t.termination!=null){n.writeFieldBegin({fname:"termination",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:5}),S(t.termination,n),n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd();return}if(t.amend_ack!=null){n.writeFieldBegin({fname:"amend_ack",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:6}),R(t.amend_ack,n),n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd();return}n.writeFieldStop(),n.writeStructEnd()}function T(t){var n={};for(t.readStructBegin();;){var o=t.readFieldBegin(),a=o.ftype,i=o.fid;if(a===(e||(e=r("ThriftTypes"))).STOP)break;switch(i){case 1:a===(e||(e=r("ThriftTypes"))).STRING?n.new_headers=t.readString():t.skip(a);break;case 2:a===(e||(e=r("ThriftTypes"))).STRING?n.new_body=t.readBinary():t.skip(a);break;case 3:a===(e||(e=r("ThriftTypes"))).STRING?n.patch_headers=t.readString():t.skip(a);break;case 4:a===(e||(e=r("ThriftTypes"))).BOOL?n.kill_body=t.readBool():t.skip(a);break;case 5:a===(e||(e=r("ThriftTypes"))).BOOL?n.temporary=t.readBool():t.skip(a);break;case 6:a===(e||(e=r("ThriftTypes"))).STRUCT?n.conditional_patch_headers=D(t):t.skip(a);break;default:t.skip(a)}t.readFieldEnd()}return t.readStructEnd(),n}function D(t){var n={};for(t.readStructBegin();;){var o=t.readFieldBegin(),a=o.ftype,i=o.fid;if(a===(e||(e=r("ThriftTypes"))).STOP)break;switch(i){case 1:a===(e||(e=r("ThriftTypes"))).STRING?n.expected_existing_headers=t.readString():t.skip(a);break;case 2:a===(e||(e=r("ThriftTypes"))).STRING?n.patch_headers_if_match=t.readString():t.skip(a);break;case 3:a===(e||(e=r("ThriftTypes"))).STRING?n.patch_headers_otherwise=t.readString():t.skip(a);break;default:t.skip(a)}t.readFieldEnd()}return t.readStructEnd(),n.expected_existing_headers===void 0&&(n.expected_existing_headers=""),n.patch_headers_if_match===void 0&&(n.patch_headers_if_match=""),n}function x(t){var n={};for(t.readStructBegin();;){var o=t.readFieldBegin(),a=o.ftype,i=o.fid;if(a===(e||(e=r("ThriftTypes"))).STOP)break;switch(i){case 1:a===(e||(e=r("ThriftTypes"))).STRING?n.bytes=t.readBinary():t.skip(a);break;case 2:a===(e||(e=r("ThriftTypes"))).STRING?n.metadata=t.readString():t.skip(a);break;default:t.skip(a)}t.readFieldEnd()}return t.readStructEnd(),n.bytes===void 0&&(n.bytes=Uint8Array.of()),n}function $(t){var n={};for(t.readStructBegin();;){var o=t.readFieldBegin(),a=o.ftype,i=o.fid;if(a===(e||(e=r("ThriftTypes"))).STOP)break;switch(i){case 1:a===(e||(e=r("ThriftTypes"))).STRING?n.message=t.readString():t.skip(a);break;default:t.skip(a)}t.readFieldEnd()}return t.readStructEnd(),n.message===void 0&&(n.message=""),n}function P(t){var n={};for(t.readStructBegin();;){var a=t.readFieldBegin(),i=a.ftype,l=a.fid;if(i===(e||(e=r("ThriftTypes"))).STOP)break;switch(l){case 1:i===(e||(e=r("ThriftTypes"))).I32?n.reason=o("RequestStreamCommonRequestStreamCommonTypes").TerminationReason.cast(t.readI32()):t.skip(i);break;case 2:i===(e||(e=r("ThriftTypes"))).STRING?n.message=t.readString():t.skip(i);break;case 3:i===(e||(e=r("ThriftTypes"))).I64?n.retry_delay_ms=t.readI64().toString():t.skip(i);break;default:t.skip(i)}t.readFieldEnd()}return t.readStructEnd(),n.reason===void 0&&(n.reason=o("RequestStreamCommonRequestStreamCommonTypes").TerminationReason.cast(0)),n}function N(t){var n={};for(t.readStructBegin();;){var o=t.readFieldBegin(),a=o.ftype,i=o.fid;if(a===(e||(e=r("ThriftTypes"))).STOP)break;switch(i){case 1:a===(e||(e=r("ThriftTypes"))).I64?n.amendment_id=t.readI64().toString():t.skip(a);break;case 2:a===(e||(e=r("ThriftTypes"))).BOOL?n.accepted=t.readBool():t.skip(a);break;case 3:a===(e||(e=r("ThriftTypes"))).STRING?n.result=t.readBinary():t.skip(a);break;default:t.skip(a)}t.readFieldEnd()}return t.readStructEnd(),n}function M(t){var n={};for(t.readStructBegin();;){var a=t.readFieldBegin(),i=a.ftype,l=a.fid;if(i===(e||(e=r("ThriftTypes"))).STOP)break;switch(l){case 1:i===(e||(e=r("ThriftTypes"))).I64?n.stream_id=t.readI64().toString():t.skip(i);break;case 2:i===(e||(e=r("ThriftTypes"))).I32?n.last_sequencer=t.readI32():t.skip(i);break;case 4:i===(e||(e=r("ThriftTypes"))).I32?n.amendment_count=t.readI32():t.skip(i);break;case 3:i===(e||(e=r("ThriftTypes"))).I32?n.last_status=o("RequestStreamCommonRequestStreamCommonTypes").FlowStatus.cast(t.readI32()):t.skip(i);break;default:t.skip(i)}t.readFieldEnd()}return t.readStructEnd(),n.stream_id===void 0&&(n.stream_id="0"),n.last_sequencer===void 0&&(n.last_sequencer=0),n.amendment_count===void 0&&(n.amendment_count=0),n.last_status===void 0&&(n.last_status=o("RequestStreamCommonRequestStreamCommonTypes").FlowStatus.cast(0)),n}function w(t){var n={};for(t.readStructBegin();;){var o=t.readFieldBegin(),a=o.ftype,i=o.fid;if(a===(e||(e=r("ThriftTypes"))).STOP)break;switch(i){case 1:a===(e||(e=r("ThriftTypes"))).I64?n.caller_timestamp_ms=t.readI64().toString():t.skip(a);break;case 2:if(a===(e||(e=r("ThriftTypes"))).LIST){n.streams_to_check=[];for(var l=t.readListBegin(),s=0;s<l.size;s++){var u=M(t);n.streams_to_check.push(u)}}else t.skip(a);break;default:t.skip(a)}t.readFieldEnd()}return t.readStructEnd(),n.caller_timestamp_ms===void 0&&(n.caller_timestamp_ms="0"),n}function A(t){var n={};for(t.readStructBegin();;){var o=t.readFieldBegin(),a=o.ftype,i=o.fid;if(a===(e||(e=r("ThriftTypes"))).STOP)break;switch(i){case 1:a===(e||(e=r("ThriftTypes"))).I64?n.original_ping_timestamp_ms=t.readI64().toString():t.skip(a);break;case 2:if(a===(e||(e=r("ThriftTypes"))).LIST){n.stream_ids_missing=[];for(var l=t.readListBegin(),s=0;s<l.size;s++){var u=t.readI64().toString();n.stream_ids_missing.push(u)}}else t.skip(a);break;case 3:if(a===(e||(e=r("ThriftTypes"))).LIST){n.stream_ids_behind=[];for(var c=t.readListBegin(),d=0;d<c.size;d++){var m=t.readI64().toString();n.stream_ids_behind.push(m)}}else t.skip(a);break;case 4:if(a===(e||(e=r("ThriftTypes"))).LIST){n.stream_ids_with_lost_amendments=[];for(var p=t.readListBegin(),_=0;_<p.size;_++){var f=t.readI64().toString();n.stream_ids_with_lost_amendments.push(f)}}else t.skip(a);break;case 5:if(a===(e||(e=r("ThriftTypes"))).LIST){n.stream_ids_with_wrong_status=[];for(var g=t.readListBegin(),h=0;h<g.size;h++){var y=t.readI64().toString();n.stream_ids_with_wrong_status.push(y)}}else t.skip(a);break;default:t.skip(a)}t.readFieldEnd()}return t.readStructEnd(),n.original_ping_timestamp_ms===void 0&&(n.original_ping_timestamp_ms="0"),n}function F(t){var n,a={};for(t.readStructBegin();;){var i=t.readFieldBegin(),l=i.ftype,s=i.fid;if(l===(e||(e=r("ThriftTypes"))).STOP)break;switch(s){case 1:if(l===(e||(e=r("ThriftTypes"))).I32)if(n==null)a.flow_status=o("RequestStreamCommonRequestStreamCommonTypes").FlowStatus.cast(t.readI32()),n="flow_status";else throw new Error("more than one field have been deserialized in union type: StreamResponseDelta; current field: flow_status, previous deserialized field: "+n);else t.skip(l);break;case 2:if(l===(e||(e=r("ThriftTypes"))).STRUCT)if(n==null)a.log=$(t),n="log";else throw new Error("more than one field have been deserialized in union type: StreamResponseDelta; current field: log, previous deserialized field: "+n);else t.skip(l);break;case 3:if(l===(e||(e=r("ThriftTypes"))).STRUCT)if(n==null)a.rewrite=T(t),n="rewrite";else throw new Error("more than one field have been deserialized in union type: StreamResponseDelta; current field: rewrite, previous deserialized field: "+n);else t.skip(l);break;case 4:if(l===(e||(e=r("ThriftTypes"))).STRUCT)if(n==null)a.data=x(t),n="data";else throw new Error("more than one field have been deserialized in union type: StreamResponseDelta; current field: data, previous deserialized field: "+n);else t.skip(l);break;case 5:if(l===(e||(e=r("ThriftTypes"))).STRUCT)if(n==null)a.termination=P(t),n="termination";else throw new Error("more than one field have been deserialized in union type: StreamResponseDelta; current field: termination, previous deserialized field: "+n);else t.skip(l);break;case 6:if(l===(e||(e=r("ThriftTypes"))).STRUCT)if(n==null)a.amend_ack=N(t),n="amend_ack";else throw new Error("more than one field have been deserialized in union type: StreamResponseDelta; current field: amend_ack, previous deserialized field: "+n);else t.skip(l);break;default:t.skip(l)}t.readFieldEnd()}return t.readStructEnd(),a}l.ResponseRewriteRequest$DefaultConstructor=s,l.ResponseRewriteConditionalPatchHeaders$DefaultConstructor=u,l.ResponseData$DefaultConstructor=c,l.LogMessage$DefaultConstructor=d,l.Termination$DefaultConstructor=m,l.AmendStreamAck$DefaultConstructor=p,l.StreamCheck$DefaultConstructor=_,l.Ping$DefaultConstructor=f,l.Pong$DefaultConstructor=g,l.StreamResponseDelta$DefaultConstructor=h,l.serializeResponseRewriteRequest=y,l.serializeResponseRewriteConditionalPatchHeaders=C,l.serializeResponseData=b,l.serializeLogMessage=v,l.serializeTermination=S,l.serializeAmendStreamAck=R,l.serializeStreamCheck=L,l.serializePing=E,l.serializePong=k,l.serializeStreamResponseDelta=I,l.deserializeResponseRewriteRequest=T,l.deserializeResponseRewriteConditionalPatchHeaders=D,l.deserializeResponseData=x,l.deserializeLogMessage=$,l.deserializeTermination=P,l.deserializeAmendStreamAck=N,l.deserializeStreamCheck=M,l.deserializePing=w,l.deserializePong=A,l.deserializeStreamResponseDelta=F}),98);
__d("RequestStreamSingleChannelSingleChannelRequestStreamTypes",["$InternalEnum"],(function(t,n,r,o,a,i){"use strict";var e=n("$InternalEnum")({Ignored:100,Success:200,Queued:250,UnknownStream:400,HandledUnknownResult:450,Failure:500}),l=n("$InternalEnum")({Request_headers:"request_headers",Request_body:"request_body",Amend:"amend",Ack:"ack",Response:"response",Ping:"ping",Pong:"pong"});a.exports={Ack:e,Payload$Types:l}}),null);
__d("RequestStreamSingleChannelSingleChannelRequestStreamSerializers",["RequestStreamCommonRequestStreamCommonSerializers","RequestStreamCommonRequestStreamCommonTypes","RequestStreamSingleChannelSingleChannelRequestStreamTypes","ThriftTypes","jsbi"],(function(t,n,r,o,a,i,l){"use strict";var e;function s(){return{}}function u(){return{body:Uint8Array.of()}}function c(){return{amendment:Uint8Array.of()}}function d(){return{ack:o("RequestStreamSingleChannelSingleChannelRequestStreamTypes").Ack.cast(0)}}function m(){return{delta:[]}}function p(){return{}}function _(t,n){n.writeStructBegin("RequestStreamHeaders"),t.headers!=null&&(n.writeFieldBegin({fname:"headers",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:1}),n.writeBinary(t.headers),n.writeFieldEnd()),t.instrumentation_data!=null&&(n.writeFieldBegin({fname:"instrumentation_data",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:2}),n.writeBinary(t.instrumentation_data),n.writeFieldEnd()),n.writeFieldStop(),n.writeStructEnd()}function f(t,n){if(n.writeStructBegin("RequestStreamBody"),n.writeFieldBegin({fname:"body",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:1}),t.body!=null)n.writeBinary(t.body);else{var o=Uint8Array.of();n.writeBinary(o)}n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd()}function g(t,n){if(n.writeStructBegin("AmendStream"),t.amendment_id!=null&&(n.writeFieldBegin({fname:"amendment_id",ftype:(e||(e=r("ThriftTypes"))).I64,fid:1}),n.writeI64(r("jsbi").BigInt(t.amendment_id)),n.writeFieldEnd()),n.writeFieldBegin({fname:"amendment",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:2}),t.amendment!=null)n.writeBinary(t.amendment);else{var o=Uint8Array.of();n.writeBinary(o)}n.writeFieldEnd(),t.is_query!=null&&(n.writeFieldBegin({fname:"is_query",ftype:(e||(e=r("ThriftTypes"))).BOOL,fid:3}),n.writeBool(t.is_query),n.writeFieldEnd()),t.instrumentation_data!=null&&(n.writeFieldBegin({fname:"instrumentation_data",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:4}),n.writeBinary(t.instrumentation_data),n.writeFieldEnd()),n.writeFieldStop(),n.writeStructEnd()}function h(t,n){if(n.writeStructBegin("StreamResponseAck"),t.response_id!=null&&(n.writeFieldBegin({fname:"response_id",ftype:(e||(e=r("ThriftTypes"))).I64,fid:1}),n.writeI64(r("jsbi").BigInt(t.response_id)),n.writeFieldEnd()),n.writeFieldBegin({fname:"ack",ftype:(e||(e=r("ThriftTypes"))).I32,fid:2}),t.ack!=null){var a;n.writeI32((a=t.ack)!=null?a:0)}else{var i=o("RequestStreamSingleChannelSingleChannelRequestStreamTypes").Ack.cast(0);n.writeI32(i!=null?i:0)}n.writeFieldEnd(),t.query_result!=null&&(n.writeFieldBegin({fname:"query_result",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:3}),n.writeBinary(t.query_result),n.writeFieldEnd()),n.writeFieldStop(),n.writeStructEnd()}function y(t,n){if(n.writeStructBegin("StreamResponse"),t.response_id!=null&&(n.writeFieldBegin({fname:"response_id",ftype:(e||(e=r("ThriftTypes"))).I64,fid:1}),n.writeI64(r("jsbi").BigInt(t.response_id)),n.writeFieldEnd()),n.writeFieldBegin({fname:"delta",ftype:(e||(e=r("ThriftTypes"))).LIST,fid:2}),t.delta!=null){n.writeListBegin({etype:(e||(e=r("ThriftTypes"))).STRUCT,size:t.delta.length});for(var a of t.delta)o("RequestStreamCommonRequestStreamCommonSerializers").serializeStreamResponseDelta(a,n);n.writeListEnd()}else{var i=[];n.writeListBegin({etype:(e||(e=r("ThriftTypes"))).STRUCT,size:i.length});for(var l of i)o("RequestStreamCommonRequestStreamCommonSerializers").serializeStreamResponseDelta(l,n);n.writeListEnd()}if(n.writeFieldEnd(),t.ack_level!=null){var s;n.writeFieldBegin({fname:"ack_level",ftype:(e||(e=r("ThriftTypes"))).I32,fid:3}),n.writeI32((s=t.ack_level)!=null?s:0),n.writeFieldEnd()}t.query_request!=null&&(n.writeFieldBegin({fname:"query_request",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:4}),n.writeBinary(t.query_request),n.writeFieldEnd()),t.instrumentation_data!=null&&(n.writeFieldBegin({fname:"instrumentation_data",ftype:(e||(e=r("ThriftTypes"))).STRING,fid:5}),n.writeBinary(t.instrumentation_data),n.writeFieldEnd()),n.writeFieldStop(),n.writeStructEnd()}function C(t,n){if(n.writeStructBegin("Payload"),t.request_headers!=null){n.writeFieldBegin({fname:"request_headers",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:1}),_(t.request_headers,n),n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd();return}if(t.request_body!=null){n.writeFieldBegin({fname:"request_body",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:2}),f(t.request_body,n),n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd();return}if(t.amend!=null){n.writeFieldBegin({fname:"amend",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:3}),g(t.amend,n),n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd();return}if(t.ack!=null){n.writeFieldBegin({fname:"ack",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:4}),h(t.ack,n),n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd();return}if(t.response!=null){n.writeFieldBegin({fname:"response",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:5}),y(t.response,n),n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd();return}if(t.ping!=null){n.writeFieldBegin({fname:"ping",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:6}),o("RequestStreamCommonRequestStreamCommonSerializers").serializePing(t.ping,n),n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd();return}if(t.pong!=null){n.writeFieldBegin({fname:"pong",ftype:(e||(e=r("ThriftTypes"))).STRUCT,fid:7}),o("RequestStreamCommonRequestStreamCommonSerializers").serializePong(t.pong,n),n.writeFieldEnd(),n.writeFieldStop(),n.writeStructEnd();return}n.writeFieldStop(),n.writeStructEnd()}function b(t){var n={};for(t.readStructBegin();;){var o=t.readFieldBegin(),a=o.ftype,i=o.fid;if(a===(e||(e=r("ThriftTypes"))).STOP)break;switch(i){case 1:a===(e||(e=r("ThriftTypes"))).STRING?n.headers=t.readBinary():t.skip(a);break;case 2:a===(e||(e=r("ThriftTypes"))).STRING?n.instrumentation_data=t.readBinary():t.skip(a);break;default:t.skip(a)}t.readFieldEnd()}return t.readStructEnd(),n}function v(t){var n={};for(t.readStructBegin();;){var o=t.readFieldBegin(),a=o.ftype,i=o.fid;if(a===(e||(e=r("ThriftTypes"))).STOP)break;switch(i){case 1:a===(e||(e=r("ThriftTypes"))).STRING?n.body=t.readBinary():t.skip(a);break;default:t.skip(a)}t.readFieldEnd()}return t.readStructEnd(),n.body===void 0&&(n.body=Uint8Array.of()),n}function S(t){var n={};for(t.readStructBegin();;){var o=t.readFieldBegin(),a=o.ftype,i=o.fid;if(a===(e||(e=r("ThriftTypes"))).STOP)break;switch(i){case 1:a===(e||(e=r("ThriftTypes"))).I64?n.amendment_id=t.readI64().toString():t.skip(a);break;case 2:a===(e||(e=r("ThriftTypes"))).STRING?n.amendment=t.readBinary():t.skip(a);break;case 3:a===(e||(e=r("ThriftTypes"))).BOOL?n.is_query=t.readBool():t.skip(a);break;case 4:a===(e||(e=r("ThriftTypes"))).STRING?n.instrumentation_data=t.readBinary():t.skip(a);break;default:t.skip(a)}t.readFieldEnd()}return t.readStructEnd(),n.amendment===void 0&&(n.amendment=Uint8Array.of()),n}function R(t){var n={};for(t.readStructBegin();;){var a=t.readFieldBegin(),i=a.ftype,l=a.fid;if(i===(e||(e=r("ThriftTypes"))).STOP)break;switch(l){case 1:i===(e||(e=r("ThriftTypes"))).I64?n.response_id=t.readI64().toString():t.skip(i);break;case 2:i===(e||(e=r("ThriftTypes"))).I32?n.ack=o("RequestStreamSingleChannelSingleChannelRequestStreamTypes").Ack.cast(t.readI32()):t.skip(i);break;case 3:i===(e||(e=r("ThriftTypes"))).STRING?n.query_result=t.readBinary():t.skip(i);break;default:t.skip(i)}t.readFieldEnd()}return t.readStructEnd(),n.ack===void 0&&(n.ack=o("RequestStreamSingleChannelSingleChannelRequestStreamTypes").Ack.cast(0)),n}function L(t){var n={};for(t.readStructBegin();;){var a=t.readFieldBegin(),i=a.ftype,l=a.fid;if(i===(e||(e=r("ThriftTypes"))).STOP)break;switch(l){case 1:i===(e||(e=r("ThriftTypes"))).I64?n.response_id=t.readI64().toString():t.skip(i);break;case 2:if(i===(e||(e=r("ThriftTypes"))).LIST){n.delta=[];for(var s=t.readListBegin(),u=0;u<s.size;u++){var c=o("RequestStreamCommonRequestStreamCommonSerializers").deserializeStreamResponseDelta(t);n.delta.push(c)}}else t.skip(i);break;case 3:i===(e||(e=r("ThriftTypes"))).I32?n.ack_level=o("RequestStreamCommonRequestStreamCommonTypes").AckLevel.cast(t.readI32()):t.skip(i);break;case 4:i===(e||(e=r("ThriftTypes"))).STRING?n.query_request=t.readBinary():t.skip(i);break;case 5:i===(e||(e=r("ThriftTypes"))).STRING?n.instrumentation_data=t.readBinary():t.skip(i);break;default:t.skip(i)}t.readFieldEnd()}return t.readStructEnd(),n.delta===void 0&&(n.delta=[]),n}function E(t){var n,a={};for(t.readStructBegin();;){var i=t.readFieldBegin(),l=i.ftype,s=i.fid;if(l===(e||(e=r("ThriftTypes"))).STOP)break;switch(s){case 1:if(l===(e||(e=r("ThriftTypes"))).STRUCT)if(n==null)a.request_headers=b(t),n="request_headers";else throw new Error("more than one field have been deserialized in union type: Payload; current field: request_headers, previous deserialized field: "+n);else t.skip(l);break;case 2:if(l===(e||(e=r("ThriftTypes"))).STRUCT)if(n==null)a.request_body=v(t),n="request_body";else throw new Error("more than one field have been deserialized in union type: Payload; current field: request_body, previous deserialized field: "+n);else t.skip(l);break;case 3:if(l===(e||(e=r("ThriftTypes"))).STRUCT)if(n==null)a.amend=S(t),n="amend";else throw new Error("more than one field have been deserialized in union type: Payload; current field: amend, previous deserialized field: "+n);else t.skip(l);break;case 4:if(l===(e||(e=r("ThriftTypes"))).STRUCT)if(n==null)a.ack=R(t),n="ack";else throw new Error("more than one field have been deserialized in union type: Payload; current field: ack, previous deserialized field: "+n);else t.skip(l);break;case 5:if(l===(e||(e=r("ThriftTypes"))).STRUCT)if(n==null)a.response=L(t),n="response";else throw new Error("more than one field have been deserialized in union type: Payload; current field: response, previous deserialized field: "+n);else t.skip(l);break;case 6:if(l===(e||(e=r("ThriftTypes"))).STRUCT)if(n==null)a.ping=o("RequestStreamCommonRequestStreamCommonSerializers").deserializePing(t),n="ping";else throw new Error("more than one field have been deserialized in union type: Payload; current field: ping, previous deserialized field: "+n);else t.skip(l);break;case 7:if(l===(e||(e=r("ThriftTypes"))).STRUCT)if(n==null)a.pong=o("RequestStreamCommonRequestStreamCommonSerializers").deserializePong(t),n="pong";else throw new Error("more than one field have been deserialized in union type: Payload; current field: pong, previous deserialized field: "+n);else t.skip(l);break;default:t.skip(l)}t.readFieldEnd()}return t.readStructEnd(),a}l.RequestStreamHeaders$DefaultConstructor=s,l.RequestStreamBody$DefaultConstructor=u,l.AmendStream$DefaultConstructor=c,l.StreamResponseAck$DefaultConstructor=d,l.StreamResponse$DefaultConstructor=m,l.Payload$DefaultConstructor=p,l.serializeRequestStreamHeaders=_,l.serializeRequestStreamBody=f,l.serializeAmendStream=g,l.serializeStreamResponseAck=h,l.serializeStreamResponse=y,l.serializePayload=C,l.deserializeRequestStreamHeaders=b,l.deserializeRequestStreamBody=v,l.deserializeAmendStream=S,l.deserializeStreamResponseAck=R,l.deserializeStreamResponse=L,l.deserializePayload=E}),98);
__d("RequestStreamState",["RequestStreamCommonRequestStreamCommonTypes"],(function(t,n,r,o,a,i,l){"use strict";function e(e,t){switch(t){case o("RequestStreamCommonRequestStreamCommonTypes").FlowStatus.Accepted:return e.seenAccepted||e.flowStatus===o("RequestStreamCommonRequestStreamCommonTypes").FlowStatus.Started?e:{flowStatus:o("RequestStreamCommonRequestStreamCommonTypes").FlowStatus.Accepted,seenAccepted:!0};default:return!e.seenAccepted||e.flowStatus===t?e:{flowStatus:t,seenAccepted:!0}}}l.getNextState=e}),98);
__d("StreamRetryState",[],(function(t,n,r,o,a,i){"use strict";var e=1e3,l=120*1e3,s=(function(){function t(){this.$1=0}var n=t.prototype;return n.resetErrorAndRetryCount=function(){this.$1=0},n.onRetry=function(){this.$1+=1},n.getRetryCount=function(){return this.$1},n.getBackoffDelayMs=function(){if(this.$1<=1)return 0;if(this.$1===2)return e*Math.random();var t=e*Math.pow(2,this.$1-3),n=t*Math.random(),r=t+n;return Math.min(r,l)},t})();i.default=s}),66);
__d("DGWRequestStreamRef",["CompactSerializerPolyfill","DGWRequestStreamUtils","DGWStream","DGWStreamHandler","InflightAmends","ODS","Promise","RequestStreamCloseReason","RequestStreamCommonRequestStreamCommonTypes","RequestStreamE2EClientLoggerEvent","RequestStreamE2EClientLoggerMessageType","RequestStreamE2ELogger","RequestStreamE2ESampling","RequestStreamSingleChannelSingleChannelRequestStreamSerializers","RequestStreamSingleChannelSingleChannelRequestStreamTypes","RequestStreamState","RequestStreamTransport","RtiWebRequestStreamClient","StreamRetryState","asyncToGeneratorRuntime","err","gkx","justknobx","qex"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c,d=4,m=0,p=1e3,_=2,f=r("gkx")("20915")?3e4:5e3,g="dgw_stream_send_ack_failure",h=(e=r("qex")._("2097"))!=null?e:!1,y=(s=r("qex")._("2100"))!=null?s:!1;function C(e){if(!e){var t=r("err")(g);throw t.stack,t}}function b(e,t){if(e==null||e.length===0)return null;var n=JSON.parse(e);return n.auxId=t,new TextEncoder().encode(JSON.stringify(n))}function v(e){var t={},n=e.delta;return n.forEach(function(e){if(e.flow_status)switch(t.type=o("RequestStreamCommonRequestStreamCommonTypes").StreamResponseDelta$Types.Flow_status,e.flow_status){case o("RequestStreamCommonRequestStreamCommonTypes").FlowStatus.Accepted:t.flow_status="Accepted";break;case o("RequestStreamCommonRequestStreamCommonTypes").FlowStatus.Started:t.flow_status="Started";break;case o("RequestStreamCommonRequestStreamCommonTypes").FlowStatus.Stopped:t.flow_status="Stopped";break}else e.log?t.type=o("RequestStreamCommonRequestStreamCommonTypes").StreamResponseDelta$Types.Log:e.rewrite?t.type=o("RequestStreamCommonRequestStreamCommonTypes").StreamResponseDelta$Types.Rewrite:e.data?t.type=o("RequestStreamCommonRequestStreamCommonTypes").StreamResponseDelta$Types.Data:e.termination?t.type=o("RequestStreamCommonRequestStreamCommonTypes").StreamResponseDelta$Types.Termination:e.amend_ack&&(t.type=o("RequestStreamCommonRequestStreamCommonTypes").StreamResponseDelta$Types.Amend_ack)}),t}var S=(function(){function e(e,t,n,a,i,l){var s=this,u,c,m;this.$6=null,this.$7={},this.$10=!1,this.$15=new(r("StreamRetryState")),this.$16=0,this.$17=0,this.$18=0,this.$21=0;var p=null;typeof t=="string"?p=new TextEncoder().encode(t):typeof t=="object"&&(p=t),this.$1={headers:e,body:p},this.$3=n,this.$4=a,this.$12=d,this.$9=!1,this.$14=!1,this.$20=l;var _=a==null?void 0:a.serviceId;i!=null&&(this.$22()||(i.dgwStreamGroupLoggingId=this.$20.getStreamGroupLoggingId(_)),i.dgwCountPriorStreamsInGroup=this.$20.guessStreamGroupPriorStreamCount(_),i.transport="WEB_RS_STARGATE"),this.$5=o("RequestStreamE2ESampling").validateInstrumentationData(e,i,a==null?void 0:a.requestLogContext,a==null?void 0:a.upsampleMultiplier),this.$22()?this.$7.disableFalcoLogging=!0:this.$6=o("RequestStreamE2ELogger").createStreamLogger(e,this.$5,o("RequestStreamTransport").RequestStreamTransport.WEB_RS_STARGATE),(a==null?void 0:a.deviceId)!=null&&(this.$7.deviceId=a.deviceId),this.$6&&(this.$7.loggingId=this.$6.getRequestId()),a&&a.overrideUrl!=null&&(this.$7.overrideUrl=a.overrideUrl),_!=null&&(this.$7.serviceId=_),this.$8={flowStatus:o("RequestStreamCommonRequestStreamCommonTypes").FlowStatus.Stopped,seenAccepted:!1},this.$19=new(r("InflightAmends"))(f,function(e,t){var n;(n=s.$6)==null||n.logE2EEvent(r("RequestStreamE2EClientLoggerMessageType").AMENDMENT_ACK,r("RequestStreamE2EClientLoggerEvent").RECEIVED,babelHelpers.extends({},s.$23(),{latency:t.toString()}),e)},function(e,t){if(t.message!==g){var n;(n=s.$6)==null||n.logE2EEvent(r("RequestStreamE2EClientLoggerMessageType").AMENDMENT_ACK,r("RequestStreamE2EClientLoggerEvent").FAILURE,babelHelpers.extends({},s.$23(),{reason:t.message}),e)}}),(u=this.$6)==null||u.logE2EEvent(r("RequestStreamE2EClientLoggerMessageType").REQUEST_STREAM,r("RequestStreamE2EClientLoggerEvent").RECEIVED,{data_size:(c=t==null||(m=t.length)==null?void 0:m.toString())!=null?c:"0"},"0","0")}var t=e.prototype;return t.getInstrumentationData=function(){return this.$5},t.getE2EClientLogger=function(){return this.$6},t.amendWithAck=function(t){var e=this.$24(t,!0);return e==null?(c||(c=n("Promise"))).resolve(!1):this.$19.getPromise(e)||(c||(c=n("Promise"))).resolve(!1)},t.amendWithoutAck=function(t){this.$24(t,!1)},t.cancel=function(){var e;(e=this.$6)==null||e.logE2EEvent(r("RequestStreamE2EClientLoggerMessageType").CANCEL,r("RequestStreamE2EClientLoggerEvent").RECEIVED),this.$9=!0,this.$25(o("RequestStreamCloseReason").RequestStreamCloseReason.UserIntention,"user cancel the stream",!0)},t.start=function(t){var e=this;t===void 0&&(t=!1);var a=String(this.$16++),i=Date.now();return this.$26(a).then(function(){var t;e.$14=!1,e.$21=0;var n=(Date.now()-i).toString();(t=e.$6)==null||t.logE2EEvent(r("RequestStreamE2EClientLoggerMessageType").REQUEST_STREAM,r("RequestStreamE2EClientLoggerEvent").PUBACK,{latency:n},a,String(e.$18))}).catch(function(i){if(i.stack,!(i.message===g&&e.$10))if(e.$14=!1,i!==o("DGWStream").StreamError.ESTABLISHMENT_ERROR){var l,s=i.message;if(i===o("DGWStream").StreamError.UNAUTHENTICATED?s="UNAUTHENTICATED":i===o("DGWStream").StreamError.UNAUTHORIZED&&(s="UNAUTHORIZED"),(l=e.$6)==null||l.logE2EEvent(r("RequestStreamE2EClientLoggerMessageType").REQUEST_STREAM,r("RequestStreamE2EClientLoggerEvent").FAILURE,{reason:s},a,String(e.$18)),e.$25(t?o("RequestStreamCloseReason").RequestStreamCloseReason.ReestablishError:o("RequestStreamCloseReason").RequestStreamCloseReason.StartStreamFailure,s,!0),i===o("DGWStream").StreamError.UNAUTHENTICATED||i===o("DGWStream").StreamError.UNAUTHORIZED)return;throw i}else{var u,d;(u=e.$6)==null||u.logE2EEvent(r("RequestStreamE2EClientLoggerMessageType").REQUEST_STREAM,r("RequestStreamE2EClientLoggerEvent").FAILURE,{reason:(d=i.message)!=null?d:i},a,String(e.$18)),e.$15.onRetry();var m=r("gkx")("20916")?e.$15.getBackoffDelayMs():p*Math.pow(_,e.$21);return new(c||(c=n("Promise")))(function(e){return window.setTimeout(e,m)}).then(function(){return e.$21++,e.$18++,e.start()})}})},t.getFlowStatus=function(){return this.$8.flowStatus},t.shouldTerminateOrRetry=function(t,a,i,l){var e=this;if(!this.$14){var s=a;if(this.$12||(s="cannot retry for error: "+a+" because of hit max retry limitation"),t!==o("RequestStreamCloseReason").RequestStreamCloseReason.ClientError){var u;(u=this.$6)==null||u.logE2EEvent(r("RequestStreamE2EClientLoggerMessageType").REQUEST_STREAM,r("RequestStreamE2EClientLoggerEvent").FAILURE,{reason:s},null,String(this.$18))}var d=i&&(r("gkx")("20916")||this.$12);if(this.$25(t,s,!d),d){var p=r("gkx")("20916")?Math.max(l!=null?l:0,this.$15.getBackoffDelayMs()):l!=null?l:m;return this.$14=!0,new(c||(c=n("Promise")))(function(e){return window.setTimeout(e,p)}).then(function(){return e.$27()}).catch(function(e){})}}},t.$28=function(){return this.$11!=null},t.$24=function(t,n){var e,a=this,i=typeof t=="string"?new TextEncoder().encode(t):t,l=String(this.$17++);(e=this.$6)==null||e.logE2EEvent(r("RequestStreamE2EClientLoggerMessageType").AMENDMENT,r("RequestStreamE2EClientLoggerEvent").RECEIVED,{},l);var s=b(this.$5,l),u={amend:{amendment:i,instrumentation_data:s}};n&&u.amend&&(u.amend.amendment_id=l);var c=o("CompactSerializerPolyfill").serialize(u,o("RequestStreamSingleChannelSingleChannelRequestStreamSerializers").serializePayload),d=Date.now();if(this.$29()&&this.$11!=null){var m,p,_;return n&&this.$19.add(l),this.$11.send(c).then(function(e){var t;C(e);var n=(Date.now()-d).toString();(t=a.$6)==null||t.logE2EEvent(r("RequestStreamE2EClientLoggerMessageType").AMENDMENT,r("RequestStreamE2EClientLoggerEvent").PUBACK,{latency:n},l)}).catch(function(e){var t;(t=a.$6)==null||t.logE2EEvent(r("RequestStreamE2EClientLoggerMessageType").AMENDMENT,r("RequestStreamE2EClientLoggerEvent").FAILURE,{reason:e.message},l),a.$19.reject(l,e)}),(m=this.$6)==null||m.logE2EEvent(r("RequestStreamE2EClientLoggerMessageType").AMENDMENT,r("RequestStreamE2EClientLoggerEvent").SENT,{data_size:(p=t==null||(_=t.length)==null?void 0:_.toString())!=null?p:"0"},l),l}else{var f;(f=this.$6)==null||f.logE2EEvent(r("RequestStreamE2EClientLoggerMessageType").AMENDMENT,r("RequestStreamE2EClientLoggerEvent").FAILURE,{reason:"not_started"},l)}},t.$26=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=this;if(this.$9)throw new Error("stream_already_canceled");var n,a=this.$2||this.$1;try{var i=this.$30();this.$13=i;var l=a.headers.graphiql_sandbox,s=babelHelpers.extends({},a.headers,this.$31());l!=null&&(s=babelHelpers.extends({},s,{www_sandbox:l,distillery_sandbox:l+":8086"}));var u=o("DGWRequestStreamUtils").convertHeaders(s,a.body!=null,this.$5);this.$11=yield this.$20.establishStream(u,i,this.$7)}catch(e){if(e===o("DGWStream").StreamError.ESTABLISHMENT_ERROR||o("DGWStream").StreamError.isValid(e)&&!o("DGWStream").isRetryableError(e))throw e;if(o("DGWStream").StreamError.isValid(e)&&o("DGWStream").isRetryableError(e)){this.$32(e);return}throw e}if(this.$9){this.$25(o("RequestStreamCloseReason").RequestStreamCloseReason.UserIntention,"user cancel the stream",!0);return}var c=new Uint8Array([]);if(a.body!=null){var m={request_body:{body:a.body}};c=o("CompactSerializerPolyfill").serialize(m,o("RequestStreamSingleChannelSingleChannelRequestStreamSerializers").serializePayload)}if(!this.$11)throw new Error("dgwstream_is_null");var p=this.$11.send(c).then(function(e){C(e),t.$9&&t.$25(o("RequestStreamCloseReason").RequestStreamCloseReason.UserIntention,"user cancel the stream",!0)});return(n=this.$6)==null||n.logE2EEvent(r("RequestStreamE2EClientLoggerMessageType").REQUEST_STREAM,r("RequestStreamE2EClientLoggerEvent").SENT,{},e,String(this.$18)),this.$12=d,p});function t(t){return e.apply(this,arguments)}return t})(),t.$29=function(){return this.$8.flowStatus===o("RequestStreamCommonRequestStreamCommonTypes").FlowStatus.Started||this.$8.flowStatus===o("RequestStreamCommonRequestStreamCommonTypes").FlowStatus.Accepted},t.$25=function(t,n,r){var e;this.$11&&t!==o("RequestStreamCloseReason").RequestStreamCloseReason.StreamError&&t!==o("RequestStreamCloseReason").RequestStreamCloseReason.RemoteTermination&&this.$11.close(),(e=this.$13)==null||e.stop(),this.$11=null,this.$10=!0,this.$33(o("RequestStreamCommonRequestStreamCommonTypes").FlowStatus.Stopped)&&this.$3.onFlowStatus(o("RequestStreamCommonRequestStreamCommonTypes").FlowStatus.Stopped),r&&!this.$9&&this.$3.onTermination("terminate stream because "+t+" with msg : "+n)},t.$33=function(t){var e=this.$8;return this.$8=o("RequestStreamState").getNextState(e,t),e!==this.$8},t.$27=function(){return this.$12--,this.$18++,this.$15.onRetry(),this.start(!0)},t.$34=function(t){var e=this,n=o("CompactSerializerPolyfill").deserialize(t,o("RequestStreamSingleChannelSingleChannelRequestStreamSerializers").deserializePayload);if(n.response){var a,i,l=o("DGWRequestStreamUtils").getInstrumentationDataFieldsFromPayload(n),s=l==null?void 0:l.auxId,c=l==null?void 0:l.dfTraceId;if(!this.$28()){var d;(d=this.$6)==null||d.logE2EEvent(r("RequestStreamE2EClientLoggerMessageType").RESPONSE,r("RequestStreamE2EClientLoggerEvent").FAILURE,{reason:"response_received_after_close"},s,String(this.$18),c);return}var m;(a=this.$6)==null||a.logE2EEvent(r("RequestStreamE2EClientLoggerMessageType").RESPONSE,r("RequestStreamE2EClientLoggerEvent").RECEIVED,v(n.response),s,String(this.$18),c,m);var p=n.response.delta;p.forEach(function(t){if(t.data)e.$15.resetErrorAndRetryCount(),r("justknobx")._("4109")?e.$3.onData(new TextDecoder("utf-8").decode(t.data.bytes)):e.$8.flowStatus===o("RequestStreamCommonRequestStreamCommonTypes").FlowStatus.Started?e.$3.onData(new TextDecoder("utf-8").decode(t.data.bytes)):(u||(u=o("ODS"))).bumpEntityKey(110,"RequestStream","data_before_started_"+(e.$22()?"falco":"graphql"));else if(t.flow_status){var n=t.flow_status;n===o("RequestStreamCommonRequestStreamCommonTypes").FlowStatus.Started&&e.$15.resetErrorAndRetryCount(),e.$33(n)&&e.$3.onFlowStatus(n)}else if(t.termination){var a,i=(a=t.termination.message)!=null?a:"unknown termination msg";e.$2=null,e.shouldTerminateOrRetry(o("RequestStreamCloseReason").RequestStreamCloseReason.RemoteTermination,i,t.termination.reason===o("RequestStreamCommonRequestStreamCommonTypes").TerminationReason.TryAgain,t.termination.retry_delay_ms!=null?parseInt(t.termination.retry_delay_ms,10):null)}else if(t.log)e.$3.onLog(t.log.message);else if(t.amend_ack){var l=t.amend_ack.amendment_id;if(l!=null){var s=t.amend_ack.accepted||!1;e.$19.resolve(l,s)}}else if(t.rewrite){var c=o("DGWRequestStreamUtils").transformContextWithRewriteDelta(e.$1,t.rewrite);t.rewrite.temporary===!0?e.$2=c:e.$1=c}}),(i=this.$6)==null||i.logE2EEvent(r("RequestStreamE2EClientLoggerMessageType").RESPONSE,r("RequestStreamE2EClientLoggerEvent").SENT,v(n.response),s,String(this.$18),c),n.response.ack_level===o("RequestStreamCommonRequestStreamCommonTypes").AckLevel.Device&&n.response.response_id!=null&&this.$35(n.response.response_id,s)}else{var _;(_=this.$6)==null||_.logE2EEvent(r("RequestStreamE2EClientLoggerMessageType").RESPONSE,r("RequestStreamE2EClientLoggerEvent").FAILURE,{reason:"unexpected_payload_type"},null,String(this.$18))}},t.$35=function(t,n){var e={ack:{response_id:t,ack:o("RequestStreamSingleChannelSingleChannelRequestStreamTypes").Ack.Success}},a=o("CompactSerializerPolyfill").serialize(e,o("RequestStreamSingleChannelSingleChannelRequestStreamSerializers").serializePayload);if(this.$11!=null){var i;this.$11.send(a),(i=this.$6)==null||i.logE2EEvent(r("RequestStreamE2EClientLoggerMessageType").RESPONSE_ACK,r("RequestStreamE2EClientLoggerEvent").SENT,{},n,String(this.$18))}else{var l;(l=this.$6)==null||l.logE2EEvent(r("RequestStreamE2EClientLoggerMessageType").RESPONSE_ACK,r("RequestStreamE2EClientLoggerEvent").FAILURE,{reason:"not_started"},n,String(this.$18))}},t.$22=function(){return this.$1.headers.method==="Falco"},t.$30=function(){return new(r("DGWStreamHandler"))(this.$36.bind(this),this.$37.bind(this),this.$32.bind(this),this.$38.bind(this),this.$39.bind(this))},t.$39=function(t){var e;(e=this.$6)==null||e.logE2EEvent(r("RequestStreamE2EClientLoggerMessageType").REQUEST_STREAM,r("RequestStreamE2EClientLoggerEvent").FAILURE,{reason:"OnClose: Server Has FinishedSendingData"},null,String(this.$18)),this.$25(o("RequestStreamCloseReason").RequestStreamCloseReason.ServerDataEnd,"Client receive OnServerHasFinishedSendingData and Server will not send more data",!0)},t.$36=function(t){var e;(e=this.$6)==null||e.logE2EEvent(r("RequestStreamE2EClientLoggerMessageType").REQUEST_STREAM,r("RequestStreamE2EClientLoggerEvent").FAILURE,{reason:"OnClose: Server Close Connection"},null,String(this.$18)),this.$25(o("RequestStreamCloseReason").RequestStreamCloseReason.RemoteTermination,"Client receive OnClose and Server will not send more data",!0)},t.$37=function(t){try{this.$34(t)}catch(t){var e;(e=this.$6)==null||e.logE2EEvent(r("RequestStreamE2EClientLoggerMessageType").RESPONSE,r("RequestStreamE2EClientLoggerEvent").FAILURE,{reason:t.message},null,String(this.$18)),this.shouldTerminateOrRetry(o("RequestStreamCloseReason").RequestStreamCloseReason.ClientError,t.message,!1)}},t.$32=function(t){var e="",n=o("DGWStream").isRetryableError(t);e="StreamError: Received "+t;var r=h?this.$12>0:n,a=y?p*_:void 0;this.shouldTerminateOrRetry(o("RequestStreamCloseReason").RequestStreamCloseReason.StreamError,e,r,a)},t.$38=function(t,n){this.shouldTerminateOrRetry(o("RequestStreamCloseReason").RequestStreamCloseReason.ServerDrain,n,!0)},t.$31=function(){return r("RtiWebRequestStreamClient").overrideHeaders},t.$23=function(){var e={};return r("gkx")("20918")&&(e.pending_amendments_size=this.$19.getSize().toString()),e},e})();l.default=S}),98);
__d("DGWStreamGroupHandler",[],(function(t,n,r,o,a,i){"use strict";var e=(function(){function e(e,t,n){this.$1=e,this.$2=t,this.$3=n}var t=e.prototype;return t.onStreamGroupError=function(t){this.$1(t)},t.onStreamGroupMustDrain=function(t){this.$2(t)},t.onStreamGroupTransportClose=function(){this.$3()},e})();i.default=e}),66);
__d("DGWStreamFactory",["DGWClient","DGWStreamGroupHandler","Promise","gkx","uuidv4"],(function(t,n,r,o,a,i,l){"use strict";var e,s="realtime",u=1e4,c=null,d=(function(){function t(){this.$1={}}t.get=function(){return c==null&&(c=new t),c};var o=t.prototype;return o.$2=function(t){var e;this.$1=(e={},e[t]={dgwStreamGroup:null,multiStreamGroupLoggingId:null,multiStreamGroupPriorStreamCountGuess:0},e)},o.getStreamGroupLoggingId=function(t){var e;return t===void 0&&(t=null),(e=this.$1[t!=null?t:s])==null?void 0:e.multiStreamGroupLoggingId},o.guessStreamGroupPriorStreamCount=function(t){var e;return t===void 0&&(t=null),((e=this.$1[t!=null?t:s])==null?void 0:e.multiStreamGroupPriorStreamCountGuess)||0},o.establishStream=function(o,a,i){var t,l=this,c=i.serviceId==null?s:i.serviceId,d=(t=this.$1[c])==null?void 0:t.dgwStreamGroup;if(d==null||!d.canCreateGroupedStream()){var m={deviceId:i.deviceId,serviceId:c,disableFalcoLogging:i.disableFalcoLogging,streamGroupAppHeaders:{"stream-group":"group1"},authToken:i.authToken,authType:i.authType};i.overrideUrl!=null&&(m.overrideUrl=i.overrideUrl),m.keepAliveMs=u,r("gkx")("20920")&&(m.loggingId=r("uuidv4")());try{d=r("DGWClient")().createStreamGroup(new(r("DGWStreamGroupHandler"))(function(){l.$2(c)},function(){l.$2(c)},function(){l.$2(c)}),m),this.$1[c]={dgwStreamGroup:d,multiStreamGroupLoggingId:m.loggingId,multiStreamGroupPriorStreamCountGuess:0}}catch(t){return(e||(e=n("Promise"))).reject(t)}}return this.$1[c].multiStreamGroupPriorStreamCountGuess++,d.establishStream({loggingId:i.loggingId,disableFalcoLogging:i.disableFalcoLogging,groupedStreamHeaders:o},a)},t})();l.default=d}),98);
__d("DGWRequestStreamClient",["DGWRequestStreamRef","DGWStreamFactory","Promise","cr:2046346"],(function(t,n,r,o,a,i,l){"use strict";var e,s=(function(){function t(e){this.$1=e!=null?e:r("DGWStreamFactory").get()}var o=t.prototype;return o.createStream=function(o,a,i,l,s){return n("cr:2046346")!=null&&n("cr:2046346").startPulsarTest(),(e||(e=n("Promise"))).resolve(new(r("DGWRequestStreamRef"))(o,a,l,s,i,this.$1))},t})();l.default=s}),98);
__d("DGWRequestStreamDeferredClient",["Promise","nullthrows","requireDeferred"],(function(t,n,r,o,a,i,l){"use strict";var e,s=(function(){function t(){this.$1=null}var o=t.prototype;return o.createStream=function(t,n,o,a,i){return this.$2(),r("nullthrows")(this.$1).then(function(e){return e.createStream(t,n,o,a,i)})},o.$2=function(){this.$1==null&&(this.$1=new(e||(e=n("Promise")))(function(e){r("requireDeferred")("DGWRequestStreamClient").__setRef("DGWRequestStreamDeferredClient").onReady(function(t){e(new t)})}))},t})(),u=new s;l.default=u}),98);
__d("EmptyStream",["Promise"],(function(t,n,r,o,a,i){"use strict";var e,l={amendWithoutAck:function(t){},amendWithAck:function(r){return new(e||(e=n("Promise")))(function(){return!1})},cancel:function(){},start:function(){return new(e||(e=n("Promise")))(function(){return null})}},s=l;i.default=s}),66);
__d("EventListenerImplForCacheStorage",["CometEventListener"],(function(t,n,r,o,a,i){"use strict";i.default=n("CometEventListener")}),66);
__d("MQTTRequestStreamUtils",["BladeRunnerStreamHandler","BladeRunnerStreamStatus","RequestStreamCommonRequestStreamCommonTypes"],(function(t,n,r,o,a,i,l){"use strict";var e="Stream closed",s="Stream rejected";function u(t){var n=function(r){switch(r){case o("BladeRunnerStreamStatus").StreamStatus.ACCEPTED:t.onFlowStatus(o("RequestStreamCommonRequestStreamCommonTypes").FlowStatus.Accepted);break;case o("BladeRunnerStreamStatus").StreamStatus.STARTED:t.onFlowStatus(o("RequestStreamCommonRequestStreamCommonTypes").FlowStatus.Started);break;case o("BladeRunnerStreamStatus").StreamStatus.STOPPED:t.onFlowStatus(o("RequestStreamCommonRequestStreamCommonTypes").FlowStatus.Stopped);break;case o("BladeRunnerStreamStatus").StreamStatus.CLOSED:t.onTermination(e);break;case o("BladeRunnerStreamStatus").StreamStatus.REJECTED:t.onTermination(s);break}};return new(r("BladeRunnerStreamHandler"))(function(e){return t.onData(e)},null,n,function(e){return t.onLog(e)},null,function(){return t.onRetryUpdateRequestBody()})}l.TERMINATION_REASON_CLOSED=e,l.TERMINATION_REASON_REJECTED=s,l.convertToBRHandler=u}),98);
__d("PromiseResult",["Promise"],(function(t,n,r,o,a,i){"use strict";var e,l=(function(){function t(){var t=this;this.promise=new(e||(e=n("Promise")))(function(e,n){t.$1=e,t.$2=n})}var r=t.prototype;return r.resolve=function(t){this.$1(t)},r.reject=function(t){this.$2(t)},t})();i.default=l}),66);
__d("MqttFetchClient",["MqttEnv","MqttProtocolCodec","MqttUserName","MqttUtils","Promise","PromiseResult"],(function(t,n,r,o,a,i,l){"use strict";var e,s="fetch_pull",u="fetch_pull_finish",c="fetch_",d=6e4,m="action",p="chunked",_="send",f="true",g=5,h=20,y=10,C=5e3,b=typeof window!="undefined"?window:self,v=(function(){function t(){this.$1="",this.$2=o("MqttEnv").Env.getLoggerInstance(),this.$3=0,this.$4="",this.$5=new(r("MqttUserName"))("",0,1,"",0,!0),this.$6=function(){},this.$7=function(e){},this.$8=function(){},this.$9=function(e){},this.$10=0,this.$11=0,this.$12=0,this.$13=0,this.$14="Ready",this.$15=[],this.$16=[],this.$17=null,this.$18=!1,this.$19=0}t.isSupported=function(){return typeof b.fetch=="function"};var a=t.prototype;return a.run=function(t,n,r,a,i,l,s,u){var e=this;this.$1=o("MqttUtils").endpointWithSessionId(t,n),this.$3=n,this.$4=r,this.$5=a,this.$6=i,this.$7=l,this.$8=s,this.$9=u,o("MqttEnv").Env.setTimeout(function(){return e.$20()},0)},a.isTopicSupported=function(t){return!0},a.publish=function(t,n){return this.$21(t,n)},a.publishBinary=function(t,n){return this.$21(t,n)},a.$21=function(o,a){if(this.$14!=="ReceivingData")return this.$2.bumpCounter(c+"publish."+o+".invalidstate"),(e||(e=n("Promise"))).reject("not connected");this.$2.bumpCounter(c+"publish."+o+".publish");var t=new(r("PromiseResult")),i={topic:o,payload:a,promiseResult:t};return this.$15.push(i),this.$22(),t.promise},a.abort=function(){this.$6=function(){},this.$7=function(e){},this.$8=function(){},this.$9=function(e){}},a.$23=function(t){var e=this;t.forEach(function(t){e.$2.bumpCounter(c+"publish."+t.topic+".resolved"),t.promiseResult.resolve()}),this.$12+=t.length},a.$24=function(t,n){var e=this;t.forEach(function(t){e.$2.bumpCounter(c+"publish."+t.topic+".rejected"),t.promiseResult.reject(n)})},a.$25=function(t,n,r,o){var e=t.map(function(e){return e.topic}).join(",");this.$2.debugTrace("FetchClient","Fetch publish request failed. Publishes:"+e+", retry:"+r),this.$2.bumpCounter(c+"publish_request_failed"),this.$14!=="ReceivingData"||r===g?(this.$24(t,o),this.$18=!1,this.$2.bumpCounter(c+"publish_request_failed_final"),this.$22()):this.$26(t,n,r+1)},a.$27=function(t,n,r,o){if(!o.ok){if(this.$2.bumpCounter(c+"publish_request_failed.http."+o.status),o.status===409&&(this.$19++,this.$19>=y)){this.$2.bumpCounter(c+"409_reset"),this.$28(new Error("Too many 409 errors"));return}this.$25(t,n,r,this.$29(o));return}this.$2.bumpCounter(c+"publish_request_success");var e=t.map(function(e){return e.topic}).join(",");this.$2.debugTrace("FetchClient","Fetch publish request success. Publishes:"+e+", retry:"+r),this.$23(t),this.$18=!1,this.$22()},a.$22=function(){if(this.$14==="ReceivingData"&&!this.$18&&!(this.$15.length===0&&this.$16.length===0)){this.$18=!0;var e=this.$15.slice(0,h);this.$15=this.$15.slice(h,this.$15.length),this.$17!=null&&o("MqttEnv").Env.clearTimeout(this.$17),this.$17=null;var t=this.$16.slice(0,h);this.$16=this.$16.slice(h,this.$16.length),this.$26(e,t,0)}},a.$26=function(t,n,r){var e=this,a=t.map(function(e){return e.topic}).join(",");this.$2.debugTrace("FetchClient","Fetch publish request sent. Publishes:"+a+", retry:"+r);var i=o("MqttUtils").endpointWithExtraParameter(this.$1,m,_),l=t.map(function(e){return{topic:e.topic,payload:e.payload,qos:0,messageId:o("MqttEnv").Env.random()}}),s=this.$5.gen(this.$3,[],l,n);this.$2.bumpCounter(c+"publish_request"),o("MqttUtils").promiseDoneWithTimeout(b.fetch(i,{method:"POST",mode:"cors",cache:"no-cache",credentials:"include",referrer:"no-referrer",body:s,keepalive:!1}),function(o){return e.$27(t,n,r,o)},function(o){return e.$25(t,n,r,o)},d)},a.$30=function(t){var e=t.message;this.$2.debugTrace("FetchClient","Fetch request failed with error:"+e),this.$9(e),this.$31(!1,e),this.$2.bumpCounter(c+"error"),this.$14="Error"},a.$32=function(t){var e=this;this.$2.debugTrace("FetchClient","Fetch response data received");var n=o("MqttProtocolCodec").decodeByteMessages(new Uint8Array(t)),r=n.messages,a=r.filter(function(e){return e.messageType===o("MqttProtocolCodec").MESSAGE_TYPE.PINGREQ}),i=r.filter(function(e){return e.messageType===o("MqttProtocolCodec").MESSAGE_TYPE.PUBLISH}).map(function(t){if(!(t instanceof o("MqttProtocolCodec").WireMessage.Publish))return{};var n=t;return n.qos===1&&n.messageIdentifier!=null&&(e.$16.push(n.messageIdentifier),e.$17==null&&(e.$17=o("MqttEnv").Env.setTimeout(function(){e.$22()},C))),{topic:n.topic,payload:n.payloadMessage,qos:n.qos}});for(var l of i){var s;this.$2.bumpCounter(c+"response_"+((s=l.topic)!=null?s:"void"))}i&&i.length>0&&(this.$13+=i.length,this.$7(i)),a&&a.length>0&&this.$33()},a.$33=function(){this.$2.debugTrace("FetchClient","Got server ping request"),this.$2.bumpCounter(c+"ping")},a.$28=function(t){this.$2.debugTrace("FetchClient","Fetch request ended: "+t.toString()),this.$2.bumpCounter(c+"done"),this.$34(t.message),this.$8(),this.$14="Done"},a.$35=function(t,n,r){var e=this;if(r!=null)try{this.$32(r)}catch(e){this.$28(e),this.$2.bumpCounter(c+"dataDecodeException");return}if(n){this.$28(new Error("EOF"));return}o("MqttUtils").promiseDone(t.read(),function(n){var r=n.done,o=n.value;return e.$35(t,r,o)},function(t){return e.$28(t)})},a.$36=function(t){if(!t.ok){this.$2.bumpCounter(c+"error.http."+t.status),this.$30(this.$29(t));return}var e=t.body;if(!e){this.$30(new Error("Empty body"));return}var n=e.getReader();this.$6(),this.$2.bumpCounter(c+"success"),this.$31(!0,null),this.$11=Date.now(),this.$14="ReceivingData",this.$2.debugTrace("FetchClient","Fetch request success"),this.$35(n,!1,null)},a.$34=function(t){this.$2.eventLogPullFinish({pullEventName:u,sessionID:this.$3,duration:Date.now()-this.$11,errorMessage:t,publishReceived:this.$13,publishSent:this.$12})},a.$31=function(t,n){this.$2.eventLogPull({pullEventName:s,sessionID:this.$3,status:t,duration:Date.now()-this.$10,hostname:this.$1,errorMessage:n})},a.$20=function(){var e=this;if(this.$14==="Ready"){this.$2.debugTrace("FetchClient","Sending fetch request"),this.$2.bumpCounter(c+"request"),this.$10=Date.now();var t=o("MqttUtils").endpointWithExtraParameter(this.$1,p,f);o("MqttUtils").promiseDoneWithTimeout(b.fetch(t,{method:"POST",mode:"cors",cache:"no-cache",credentials:"include",referrer:"no-referrer",body:this.$4,keepalive:!1}),function(t){return e.$36(t)},function(t){return e.$30(t)},d)}},a.$29=function(t){return new Error("Http error, status="+t.status)},t})();l.default=v}),98);
__d("XHRHttpError",[],(function(t,n,r,o,a,i){"use strict";var e="HTTP_CLIENT_ERROR",l="HTTP_PROXY_ERROR",s="HTTP_SERVER_ERROR",u="HTTP_TRANSPORT_ERROR",c="HTTP_UNKNOWN_ERROR";function d(t,n){if(n===0){var r=t.getProtocol();return r==="file"||r==="ftp"?null:u}else return n>=100&&n<200?l:n>=200&&n<300?null:n>=400&&n<500?e:n>=500&&n<600?s:n>=12001&&n<12156?u:c}i.HTTP_CLIENT_ERROR=e,i.HTTP_PROXY_ERROR=l,i.HTTP_SERVER_ERROR=s,i.HTTP_TRANSPORT_ERROR=u,i.HTTP_UNKNOWN_ERROR=c,i.getErrorCode=d}),66);
__d("xhrSimpleDataSerializer",[],(function(t,n,r,o,a,i){"use strict";function e(e){var t=[];for(var n in e)t.push(encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t.join("&")}i.default=e}),66);
__d("XHRRequest",["invariant","DTSGUtils","Env","ErrorGuard","FBLogger","LSD","Log","NetworkStatus","ResourceTimingsStore","ResourceTypes","SprinkleConfig","TimeSlice","URI","XHRHttpError","ZeroRewrites","cr:8959","cr:8960","fb-error","getAsyncHeaders","performance","xhrSimpleDataSerializer"],(function(t,n,r,o,a,i,l){var e,s,u,c,d=n("fb-error").ErrorXFBDebug,m=!1,p=!1,_={loadedBytes:0,totalBytes:0};function f(t){return n("ZeroRewrites").rewriteURI(new(e||(e=n("URI")))(t))}var g=(function(){"use strict";function t(e){this.$3=function(){return null},this.$20=f(e),this.$7="POST",this.$6={},this.setResponseType(null),this.setTransportBuilder(n("ZeroRewrites").getTransportBuilderForURI(this.getURI())),this.setDataSerializer(n("xhrSimpleDataSerializer")),this.$12=n("ResourceTimingsStore").getUID(n("ResourceTypes").XHR,e!=null?e.toString():"")}var r=t.prototype;return r.setURI=function(t){return this.$20=f(t),this},r.getURI=function(){return this.$20},r.setResponseType=function(t){return this.$14=t,this},r.setMethod=function(t){return this.$7=t,this},r.getMethod=function(){return this.$7},r.setData=function(t){return this.$2=t,this},r.getData=function(){return this.$2},r.setRawData=function(t){return this.$11=t,this},r.setRequestHeader=function(t,n){return this.$6[t]=n,this},r.setTimeout=function(t){return this.$15=t,this},r.getTimeout=function(){return this.$15},r.setResponseHandler=function(t){return this.$13=t,this},r.getResponseHandler=function(){return this.$13},r.setErrorHandler=function(t){return this.$5=t,this},r.getErrorHandler=function(){return this.$5},r.setNetworkFailureHandler=function(t){return this.$8=t,this},r.getNetworkFailureHandler=function(){return this.$8},r.getResponseHeader=function(t){var e=this.$9;return e?e.getResponseHeader(t):null},r.setAbortHandler=function(t){return this.$1=t,this},r.getAbortHandler=function(){return this.$1},r.setTimeoutHandler=function(t){return this.$16=t,this},r.getTimeoutHandler=function(){return this.$16},r.setUploadProgressHandler=function(t){return this.$19=t,this},r.setDownloadProgressHandler=function(t){return this.$4=t,this},r.setTransportBuilder=function(t){return!this.$18||!n("ZeroRewrites").isRewritten(this.$20)?this.$18=t:n("FBLogger")("iorg-FOS").blameToPreviousFile().mustfix("can not set new TransportBuilder for the request %s",String(this.getURI())),this},r.setDataSerializer=function(t){return this.$3=t,this},r.setWithCredentials=function(t){return this.$21=t,this},r.send=function(){var t=this.$15,r=this.$18;if(!r)return;var o=r(),a=this.getURI();if(a.toString().includes("/../")||a.toString().includes("/..\\")||a.toString().includes("\\../")||a.toString().includes("\\..\\"))return n("Log").error("XHRRequest.send(): path traversal is not allowed."),!1;if(m===!0)return;var i=new(e||(e=n("URI")))(a).getQualifiedURI().toString(),u=this.$12;n("ResourceTimingsStore").updateURI(n("ResourceTypes").XHR,u,i),n("ResourceTimingsStore").measureRequestSent(n("ResourceTypes").XHR,u),this.$9=o;var c;this.$7==="POST"||!this.$11||l(0,2346,this.$11,a);var d=(s||(s=n("Env"))).force_param;if(d&&(this.$2=babelHelpers.extends({},this.getData()||{},d)),this.$7==="GET"&&n("DTSGUtils").shouldAppendToken(a)){var p=n("cr:8960").getCachedToken?n("cr:8960").getCachedToken():n("cr:8960").getToken();p&&(this.$2?this.$2.fb_dtsg_ag=p:this.$2={fb_dtsg_ag:p},n("SprinkleConfig").param_name&&(this.$2[n("SprinkleConfig").param_name]=n("DTSGUtils").getNumericValue(p)))}if(this.$7==="POST"&&n("DTSGUtils").shouldAppendToken(a)){var _=n("cr:8959").getCachedToken?n("cr:8959").getCachedToken():n("cr:8959").getToken();_&&(this.$2?this.$2.fb_dtsg=_:this.$2={fb_dtsg:_},n("SprinkleConfig").param_name&&(this.$2[n("SprinkleConfig").param_name]=n("DTSGUtils").getNumericValue(_))),n("LSD").token&&(this.$2?this.$2.lsd=n("LSD").token:this.$2={lsd:n("LSD").token},n("SprinkleConfig").param_name&&!_&&(this.$2[n("SprinkleConfig").param_name]=n("DTSGUtils").getNumericValue(n("LSD").token)))}this.$7==="GET"||this.$11?(a.addQueryData(this.$2),c=this.$11):c=this.$3(this.$2);function f(e){n("ResourceTimingsStore").measureResponseReceived(n("ResourceTypes").XHR,u);for(var t=arguments.length,r=new Array(t>1?t-1:0),o=1;o<t;o++)r[o-1]=arguments[o];e.apply(this,r)}var g=n("TimeSlice").guard(f,"XHRRequest response received",{propagationType:n("TimeSlice").PropagationType.CONTINUATION});o.onreadystatechange=this.$22(g),o.onerror=this.$23(g),o.upload&&this.$19&&(o.upload.onprogress=this.$24.bind(this)),this.$4&&(o.onprogress=this.$25.bind(this)),t&&(this.$17=setTimeout(this.$26.bind(this),t)),this.$21!=null&&(o.withCredentials=this.$21),o.open(this.$7,a.toString(),!0);var h=!1;if(this.$6)for(var y in this.$6)y.toLowerCase()==="content-type"&&(h=!0),o.setRequestHeader(y,this.$6[y]);this.$7=="POST"&&!this.$11&&!h&&o.setRequestHeader("Content-Type","application/x-www-form-urlencoded");var C=n("getAsyncHeaders")(a);Object.keys(C).forEach(function(e){o.setRequestHeader(e,C[e])}),this.$14==="arraybuffer"&&("responseType"in o?o.responseType="arraybuffer":"overrideMimeType"in o?o.overrideMimeType("text/plain; charset=x-user-defined"):"setRequestHeader"in o&&o.setRequestHeader("Accept-Charset","x-user-defined")),this.$14==="blob"&&(o.responseType=this.$14),o.send(c)},r.abort=function(t){this.$27(),this.$1&&(u||(u=n("ErrorGuard"))).applyWithGuard(this.$1,null,[t],{name:"XHRRequest:_abortHandler"})},r.$27=function(){var e=this.$9;e&&(e.onreadystatechange=null,e.abort()),this.$28()},r.$26=function(){this.$27(),this.$16&&(u||(u=n("ErrorGuard"))).applyWithGuard(this.$16,null,[],{name:"XHRRequest:_abortHandler"})},r.$29=function(t){if(this.$14){if("response"in t)return t.response;if(this.$14==="arraybuffer"&&window.VBArray)return window.VBArray(t.responseBody).toArray()}return t.responseText},r.$23=function(t){var e=this,r=this.$9;return function(){var o,a={errorCode:n("XHRHttpError").HTTP_TRANSPORT_ERROR,errorMsg:"Network Failure.",errorType:"Network",errorRawResponseHeaders:null,errorRawTransport:r==null||(o=r.constructor)==null?void 0:o.name,errorRawTransportStatus:0};e.$8?(u||(u=n("ErrorGuard"))).applyWithGuard(t.bind(void 0,e.$8),null,[a],{name:"XHRRequest:_networkFailureHandler"}):t(function(){}),n("NetworkStatus").reportError()}},r.$22=function(t){var e=this,r=n("TimeSlice").guard(function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e.apply(this,n)},"XHRRequest onreadystatechange",{propagationType:n("TimeSlice").PropagationType.EXECUTION});return function(){var o=e.$9;if(o!=null){var a=o.readyState;if(a>=2){var i=a===4;i&&d.addFromXHR(o);var l=e.getURI(),s=n("XHRHttpError").getErrorCode(l,o.status),m=e.$13;if(s!=null){if(i){var _=119500;s==="HTTP_TRANSPORT_ERROR"&&e.$10&&e.$10+_<(c||(c=n("performance"))).now()&&(s="HTTP_STREAM_TIMEOUT");var f={errorCode:s,errorMsg:e.$29(o),errorRawTransport:o.constructor.name,errorRawTransportStatus:o.status,errorRawResponseHeaders:m&&m.includeHeaders?o.getAllResponseHeaders():null,errorType:o.status?"HTTP "+o.status:"HTTP"};e.$5?(u||(u=n("ErrorGuard"))).applyWithGuard(t.bind(void 0,e.$5),null,[f],{name:"XHRRequest:_errorHandler"}):t(function(){})}}else if(m){if(i||m.parseStreaming&&a===3){var g=i?t:r,h=m!=null&&m.includeHeaders?o.getAllResponseHeaders():null,y=e.$29(o);e.$10=(c||(c=n("performance"))).now();var C=200*1e3*1e3;m.parseStreaming&&typeof y=="string"&&y.length>C&&!p&&(p=!0,n("FBLogger")("comet_infra").mustfix("Streaming reponse exceeding size limits and will OOM soon: %s",String(e.getURI()))),(u||(u=n("ErrorGuard"))).applyWithGuard(g.bind(void 0,m),null,[y,h,i],{name:"XHRRequest:handler"})}}else i&&t(function(){});i&&(s!="HTTP_TRANSPORT_ERROR"&&n("NetworkStatus").reportSuccess(),e.$28())}}}},r.$24=function(t){_.loadedBytes=t.loaded,_.totalBytes=t.total,this.$19&&(u||(u=n("ErrorGuard"))).applyWithGuard(this.$19,null,[_],{name:"XHRRequest:_uploadProgressHandler"})},r.$25=function(t){var e={loadedBytes:t.loaded,totalBytes:t.total};this.$4&&(u||(u=n("ErrorGuard"))).applyWithGuard(this.$4,null,[e],{name:"XHRRequest:_downloadProgressHandler"})},r.$28=function(){clearTimeout(this.$17),delete this.$9},t.disable=function(){m=!0},t})();a.exports=g}),null);
__d("MqttLongPollingClient",["MqttEnv","MqttProtocolCodec","MqttUserName","Promise","XHRRequest","getCrossOriginTransport","getErrorSafe"],(function(t,n,r,o,a,i,l){"use strict";var e,s=12e4,u="simple_pull",c="longpolling_",d=(function(){function t(){this.$3="",this.$4=0,this.$2=o("MqttEnv").Env.getLoggerInstance(),this.$1="Ready",this.$5="",this.$6=new(r("MqttUserName"))("",0,1,"",0,!0),this.$7=function(){},this.$8=function(e){},this.$9=function(){},this.$10=function(e){},this.$11=0,this.$12=null,this.$13=new Set(["/t_ms","/messenger_sync_get_diffs","/messenger_sync_create_queue","/webrtc","/rtc_multi"])}var a=t.prototype;return a.run=function(t,n,r,o,a,i,l,s){this.$3=t,this.$4=n,this.$5=r,this.$6=o,this.$7=a,this.$8=i,this.$9=l,this.$10=s,this.$14(this.$5)},a.isTopicSupported=function(t){return this.$13.has(t)},a.publish=function(r,o){return(e||(e=n("Promise"))).reject("not supported")},a.publishBinary=function(r,o){return(e||(e=n("Promise"))).reject("not supported")},a.abort=function(){this.$12!=null&&this.$12.abort("Disconnected")},a.$15=function(t,n){this.$1!==t&&(this.$1=t,t==="Error"&&n!=null&&this.$10(n),this.$2.debugTrace("LongPollingClient","_changeStatus : "+t))},a.$16=function(t){if(this.$1==="RequestSend"){if(!t){this.$17("EmptyResponse",null);return}this.$7(),this.$2.bumpCounter(c+"success"),this.$18(!0,null),this.$15("ResponseReceived");var e=o("MqttProtocolCodec").decodeByteMessages(new Uint8Array(t)),n=e.messages.filter(function(e){return e instanceof o("MqttProtocolCodec").WireMessage.Publish}).map(function(e){if(e instanceof o("MqttProtocolCodec").WireMessage.Publish){var t=e;return{topic:t.topic,payload:t.payloadMessage,qos:t.qos}}else return{}});this.$8(n),this.$9()}},a.$17=function(t,n){var e=n!=null?n.message:"null";this.$2.debugTrace("LongPollingClient Error","Poll failed with error:"+t+", errorMsg:"+e),this.$18(!1,t+":"+e),this.$2.bumpCounter(c+"error."+t),this.$15("Error",t)},a.$18=function(t,n){this.$2.eventLogPull({pullEventName:u,sessionID:this.$4,status:t,duration:Date.now()-this.$11,hostname:this.$3,errorMessage:n})},a.$14=function(t){var e=this;if(!(this.$1!=="Ready"||this.$12)){this.$2.bumpCounter(c+"request");try{this.$11=Date.now(),this.$12=new(r("XHRRequest"))(this.$3).setResponseType("arraybuffer").setRawData(t).setTransportBuilder(r("getCrossOriginTransport").withCredentials).setResponseHandler(function(t){return e.$16(t)}).setNetworkFailureHandler(function(t){e.$17("Network",t)}).setErrorHandler(function(t){e.$17("Error",t)}).setAbortHandler(function(t){e.$17("Abort",null)}).setTimeoutHandler(function(){e.$17("Timeout",null)}).setTimeout(s).send(),this.$15("RequestSend")}catch(e){this.$17("Error",r("getErrorSafe")(e))}}},t})();l.default=d}),98);
__d("MqttLongPollingHookCollection",[],(function(t,n,r,o,a,i){"use strict";var e=(function(){function e(){this.$1=new Set}var t=e.prototype;return t.addHook=function(t){this.$1.add(t)},t.removeHook=function(t){this.$1.delete(t)},t.onPollRequestSent=function(){this.$1.forEach(function(e){e.onPollRequestSent()})},t.onPollRequestSuccess=function(){this.$1.forEach(function(e){e.onPollRequestSuccess()})},t.onPollResponse=function(t){this.$1.forEach(function(e){e.onPollResponse(t)})},t.onPollFinish=function(){this.$1.forEach(function(e){e.onPollFinish()})},t.onPollRequestFailed=function(t){this.$1.forEach(function(e){e.onPollRequestFailed(t)})},t.onPollShutdownAbort=function(){this.$1.forEach(function(e){e.onPollShutdownAbort()})},e})();i.default=e}),66);
__d("exponentialBackoff",["MqttEnv"],(function(t,n,r,o,a,i,l){function e(e,t){t===void 0&&(t=null);var n=null,r=0;function a(){for(var a=arguments.length,i=new Array(a),l=0;l<a;l++)i[l]=arguments[l];var s=function(){e.apply(t,i)};if(n===null){var u=Math.max(0,Math.pow(2,Math.min(r,6))*(1e3+o("MqttEnv").Env.random()*100)-2e3);n=o("MqttEnv").Env.setTimeout(function(){s(),n=null},u)}r++}return a.reset=function(){r=0,n!=null&&(o("MqttEnv").Env.clearTimeout(n),n=null)},a.isPending=function(){return n!=null},a}l.default=e}),98);
__d("MqttLongPollingRunner",["MqttEnv","MqttFetchClient","MqttLongPollingClient","MqttLongPollingHookCollection","MqttTypes","MqttUtils","MqttWebSocketUtils","Promise","exponentialBackoff","getErrorSafe"],(function(t,n,r,o,a,i,l){"use strict";var e,s=4,u=1e3,c=3e3,d="mqtt_should_longpoll",m="last_lp",p="yes",_="no",f=(function(){function t(e,t,n,a,i,l,s,u,c){var d=this;this.$23=function(){try{if(!d.$30())return;d.$5.debugTrace("LongPollingRunner","_startPollingIfNecessary called");var e=d.$31();d.$14=e;var t=d.$9(),n=d.$10(),a=t.filter(function(t){return e.isTopicSupported(t)}),i=n.filter(function(t){return e.isTopicSupported(t.topic)});if(a.length===0&&i.length===0){d.$5.debugTrace("LongPollingRunner","Poll skipped, nothing to do"),d.$14=null,o("MqttEnv").Env.setTimeout(function(){d.$23()},1e3);return}var l=o("MqttUtils").generateSessionId();e.run(d.$6,l,d.$7.gen(l,a,i),d.$7,function(){return d.$32()},function(e){return d.$33(e)},function(){return d.$34()},function(e){return d.$35(e)}),d.$19.onPollRequestSent();var s=a.join(","),u=i.map(function(e){return e.topic}).join(",");d.$5.debugTrace("LongPollingRunner","Making a poll request to "+d.$6+". SubscribedTopics:"+s+". Publishes:"+u)}catch(e){var c=r("getErrorSafe")(e);d.$5.logErrorWarn(c,"lp_js_error"),d.$11(new(o("MqttTypes")).MqttChannelError(!1,"js error lp",c)),d.$35("lp_js_error")}},this.$6=e,this.$7=t,this.$1=a,this.$2=0,this.$3=n,this.$4=o("MqttWebSocketUtils").hasWSSupport(),this.$5=o("MqttEnv").Env.getLoggerInstance(),this.$8=i,this.$9=l,this.$10=s,this.$11=u,this.$12=c,this.$13=!1,this.$14=null,this.$15="LPInactive",this.$16="NotSent",this.$17=0,this.$19=new(r("MqttLongPollingHookCollection")),this.$18=r("exponentialBackoff")(this.$23,this),this.$20=0,this.$21=_;var m=o("MqttEnv").Env.genGk(o("MqttEnv").MqttGkNames.mqtt_lp_use_fetch),p=r("MqttFetchClient").isSupported();m?this.$5.bumpCounter("fetch_gk_pass"):this.$5.bumpCounter("fetch_gk_fail"),p?this.$5.bumpCounter("fetch_api_supported"):this.$5.bumpCounter("fetch_api_not_supported"),this.$22=m&&p}var a=t.prototype;return a.addHook=function(t){this.$19.addHook(t)},a.start=function(){var e=this;this.$21=o("MqttEnv").Env.configRead(m,_),this.$5.debugTrace("LongPollingRunner","Runner loaded, last status "+this.$21),this.$20=Date.now(),this.$23(),o("MqttEnv").Env.setTimeout(function(){e.$23()},u+100),o("MqttEnv").Env.setTimeout(function(){e.$23()},c+100)},a.shutdown=function(){this.$5.debugTrace("LongPollingRunner","Shutdown called"),this.$14&&this.$14.abort(),this.$19.onPollShutdownAbort(),this.$14=null},a.canPublish=function(){return this.$15==="LPActive"&&this.$16==="ReceivingData"},a.publish=function(t,n,r){return this.$24(t,n)},a.publishBinary=function(t,n,r){return this.$24(t,n)},a.$24=function(r,a){return o("MqttEnv").Env.genGk(o("MqttEnv").MqttGkNames.mqtt_enable_publish_over_polling)&&this.$14&&this.$14.isTopicSupported(r)?typeof a=="string"?this.$14.publish(r,a):this.$14.publishBinary(r,a):(e||(e=n("Promise"))).reject()},a.onConnectAttempt=function(){},a.onConnectFailure=function(){this.$2++,this.$23()},a.onConnected=function(){},a.onConnectSuccess=function(){this.$1=!0,o("MqttEnv").Env.configWrite(m,null)},a.onConnectionLost=function(){},a.onConnectionDisconnect=function(){},a.onSubscribe=function(t){},a.onUnsubscribe=function(t){},a.onPublish=function(t){},a.onMessage=function(t){},a.onWSFatal=function(){this.$3=!0,this.$23()},a.getStatus=function(){return this.$15},a.getRequestStatus=function(){return this.$16},a.$25=function(t){t!==this.$15&&(this.$5.debugTrace("LongPollingRunner","status changed to "+t+" from "+this.$15),this.$15=t,this.$12(this.$15,this.$16))},a.$26=function(t){this.$22&&t!==this.$16&&(this.$5.debugTrace("LongPollingRunner","request status changed to "+t+" from "+this.$16),this.$16=t,this.$12(this.$15,this.$16))},a.$27=function(){this.$17=0},a.$28=function(){this.$17++,this.$17>=s&&this.$25("LPError")},a.$29=function(){var e,t=(e=o("MqttEnv")).Env.genGk(e.MqttGkNames.mqtt_lp_no_delay),n=e.Env.genGk(e.MqttGkNames.mqtt_ws_polling_enabled),r=e.Env.genGk(e.MqttGkNames.mqtt_fast_lp);if(this.$5.debugTrace("LongPollingRunner","_shouldPoll? pollNow:"+String(t)+" enabled:"+String(n)+" fastPoll:"+String(r)+" hasWSSupport:"+String(this.$4)+" hasWsSuccessBefore:"+String(this.$1)+" failureCount:"+this.$2+" wsFatal:"+String(this.$3)),!n)return!1;if(t)return this.$5.bumpCounter(d+".nd"),!0;if(!this.$4)return this.$5.bumpCounter(d+".na"),!0;if(this.$3)return this.$5.bumpCounter(d+".fatal"),!0;if(this.$1)return!1;if(r){var a=Date.now()-this.$20;if(this.$21===p){if(this.$2>=1)return!0;if(a>u)return this.$5.bumpCounter(d+".fastdelay"),!0}else if(a>c)return this.$5.bumpCounter(d+".regulardelay"),!0}return this.$2>=3?(this.$5.bumpCounter(d+".failure"),!0):!1},a.$30=function(){if(this.$14!=null)return!1;var e=this.$29();return!this.$13&&e&&(this.$5.bumpCounter("polling_kickin"),this.$13=!0,this.$25("LPActive"),this.$27()),this.$13&&!e&&(this.$5.bumpCounter("polling_stopped"),this.$13=!1,this.$25("LPInactive"),this.$27()),e},a.$31=function(){return this.$22?(this.$5.debugTrace("LongPollingRunner","Creating polling client using Fetch API"),new(r("MqttFetchClient"))):(this.$5.debugTrace("LongPollingRunner","Creating regular Polling client"),new(r("MqttLongPollingClient")))},a.$32=function(){this.$5.debugTrace("LongPollingRunner","Poll success"),this.$19.onPollRequestSuccess(),this.$18.reset(),this.$25("LPActive"),this.$27(),o("MqttEnv").Env.configWrite(m,p),this.$26("ReceivingData")},a.$33=function(t){var e=t.map(function(e){return e.topic}).join(",");this.$5.debugTrace("LongPollingRunner","Poll response received, message received:"+e);for(var n of t)this.$19.onPollResponse(n.topic),this.$8(n.topic,n.payload,n.qos)},a.$34=function(){this.$5.debugTrace("LongPollingRunner","Poll finish"),this.$19.onPollFinish(),this.$14&&this.$14.abort(),this.$14=null,this.$23(),this.$26("NotSent")},a.$35=function(t){this.$19.onPollRequestFailed(t),this.$14&&this.$14.abort(),this.$14=null,this.$18(),this.$28(),this.$26("NotSent")},t})();l.default=f}),98);
__d("PluginConnectButton",["Arbiter","CSS","DOM","DOMEvent","DOMEventListener","Focus","FormSubmit","PlatformWidgetEndpoint","Plugin","PluginOptin","URI"],(function(t,n,r,o,a,i){var e,l="new",s=n("Arbiter").subscribe,u=function(t,r){return n("DOMEventListener").add(t,"click",r)};function c(e){var t=this;this.config=e,this.busy=!1;var r=n("DOM").find(e.form,".pluginConnectButton");this.buttons=r,this.node_connected=n("DOM").find(r,".pluginConnectButtonConnected"),this.node_disconnected=n("DOM").find(r,".pluginConnectButtonDisconnected");var o=function(r){new(n("DOMEvent"))(r).kill(),t.busy||(t.submit(),t.busy=t.canpersonalize)};u(this.node_disconnected,o),e.buttontype===1?u(n("DOM").find(r,".pluginButtonX button"),o):e.buttontype===2&&u(this.node_connected,o),u(this.node_connected,function(e){return n("Arbiter").inform(n("Plugin").DIALOG,e)});var a=this.update.bind(this);s(n("Plugin").CONNECT,a,l),s(n("Plugin").DISCONNECT,a,l),s(n("Plugin").ERROR,this.error.bind(this),l)}Object.assign(c.prototype,{update:function(t,r){this.busy=!1;var e=this.config;if(r.identifier===e.identifier){var o=t===n("Plugin").CONNECT,a=n("PlatformWidgetEndpoint").plugins(e.plugin);a+="/"+(o?"disconnect":"connect"),n("CSS")[o?"show":"hide"](this.node_connected),n("CSS")[o?"hide":"show"](this.node_disconnected);try{if(document.activeElement.nodeName.toLowerCase()==="button"){var i=o?this.node_connected:this.node_disconnected,l=n("DOM").find(i,"button");l.disabled=!1,n("Focus").set(l)}}catch(e){}e.connected=o,e.form.setAttribute("action",a),e.form.setAttribute("ajaxify",a)}},error:function(t,r){if(this.busy=!1,r.action in{connect:1,disconnect:1}){n("DOM").setContent(this.buttons,r.content);var e=n("DOM").scry(this.buttons,".confirmButton");e.length===1&&n("Focus").set(e[0])}},submit:function(){if(!this.config.canpersonalize)return this.login();n("FormSubmit").send(this.config.form),this.fireStateToggle()},fireStateToggle:function(){var e=this.config;e.connected?n("Plugin").disconnect(e.identifier):n("Plugin").connect(e.identifier)},login:function(){var t=this.config.plugin;new(n("PluginOptin"))(t,(e||(e=n("URI"))).getRequestURI().getQueryData().api_key).addReturnParams({act:"connect"}).addLoginParams({social_plugin_action:this.config.pluginaction,kid_directed_site:this.config.kidDirectedSite}).start()}}),a.exports=c}),null);
__d("RequestStreamHandler",["err"],(function(t,n,r,o,a,i,l){"use strict";var e=(function(){function e(e){var t=e.onData,n=e.onTermination,r=e.onLog,o=e.onFlowStatus,a=e.onRetryUpdateRequestBody;this.$1=t||function(e){},this.$2=n||function(e){},this.$3=r||function(e){},this.$4=o,this.$5=a}var t=e.prototype;return t.onFlowStatus=function(t){this.$4(t)},t.onData=function(t){this.$1(t)},t.onTermination=function(t){this.$2(r("err")(t))},t.onLog=function(t){this.$3(t)},t.onRetryUpdateRequestBody=function(){if(this.$5!=null)return this.$5()},e})();l.default=e}),98);
__d("SCIsolationRollout",["gkx"],(function(t,n,r,o,a,i,l){"use strict";function e(e){return e.startsWith("FBLQ:")||e.startsWith("GRAPHQL:")||e.startsWith("FBGQLS:")||e.startsWith("IGGQLS:")?!0:e==="MLCInternCollab"||e==="MLCCollab"?r("gkx")("3193"):!1}l.shouldUseSCIsolation=e}),98);
__d("TransportSelectingClientCCResolver",["Promise","TransportSelectingClientContextualConfig","asyncToGeneratorRuntime","nullthrows","requireDeferred"],(function(t,n,r,o,a,i,l){var e,s=(function(){function t(){this.$1=null}var o=t.prototype;return o.getCCGroupName=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){this.$2();var t=yield r("nullthrows")(this.$1),n=new t(JSON.parse(r("TransportSelectingClientContextualConfig").rawConfig)).resolve({method:e});return n.get("group","default_group")});function t(t){return e.apply(this,arguments)}return t})(),o.getCCDGWUpsampleMultiplier=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){this.$2();var t=yield r("nullthrows")(this.$1),n=new t(JSON.parse(r("TransportSelectingClientContextualConfig").rawConfig)).resolve({method:e});return n.get("dgwUpsampleMultiplier",1)});function t(t){return e.apply(this,arguments)}return t})(),o.$2=function(){this.$1==null&&(this.$1=new(e||(e=n("Promise")))(function(e){r("requireDeferred")("ContextualConfig").__setRef("TransportSelectingClientCCResolver").onReady(function(t){e(t)})}))},t})(),u=new s;l.default=u}),98);
__d("TransportSelectingClientUtils",["BladeRunnerInstrumentedStreamHandler","DGWEnvUtil","MQTTRequestStreamUtils","TransportSelectingClientCCResolver","asyncToGeneratorRuntime","gkx"],(function(t,n,r,o,a,i,l){"use strict";function e(e,t){var n=o("MQTTRequestStreamUtils").convertToBRHandler(e);return t.startsWith("FBGQLS")||t.startsWith("SKY")?new(r("BladeRunnerInstrumentedStreamHandler"))(n,t):n}function s(e){var t=!1;switch(e){case"group1":t=r("gkx")("20921");break;case"group2":t=r("gkx")("20922");break;case"group3":t=r("gkx")("20923");break;case"group4":t=r("gkx")("20924");break;case"group5":t=r("gkx")("20925");break;case"group6":t=r("gkx")("20926");break}return t}function u(e){var t=!1;switch(e){case"skywalker":t=!0;break;case"skywalker_experiment1":t=!0;break;case"skywalker_experiment2":t=!0;break;case"skywalker_bulletin":t=!0;break}return t}function c(e){if(e!=null){var t=e.lastIndexOf("/"),n=t>0?e.substr(0,t):e;return n}}function d(e){return m.apply(this,arguments)}function m(){return m=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=c(e);if(t!=null){var n=yield r("TransportSelectingClientCCResolver").getCCGroupName(t);return u(n)&&r("DGWEnvUtil").isDGWEnvCompatible()}return!1}),m.apply(this,arguments)}function p(e,t){var n=c(t);return e!=null&&e==="SKY"&&n!=null?n:e!=null?e:"unknown"}l.BRHandlerConverter=e,l.isDGWStream=s,l.isDGWAllowedSKYTopic=u,l.getTopicPrefix=c,l.isDGWSupportedSKYTopic=d,l.getMethodContextForCC=p}),98);
__d("ThrottlingClient",["EmptyStream","Promise","RtiWebRequestStreamClient","TransportSelectingClientUtils"],(function(t,n,r,o,a,i,l){var e,s=(function(){function t(e){this.$2=r("RtiWebRequestStreamClient").ThrottledMethods,this.$1=e}var a=t.prototype;return a.createStream=function(a,i,l,s,u){var t=o("TransportSelectingClientUtils").getMethodContextForCC(a.method,a.topic);return this.$2[t]?(s.onTermination("RequestStream method "+t+" has been throttled on this client"),(e||(e=n("Promise"))).resolve(r("EmptyStream"))):this.$1.createStream(a,i,l,s,u)},t})();l.default=s}),98);
__d("TransportSelectingClient",["BladeRunnerDeferredClient","DGWEnvUtil","DGWRequestStreamDeferredClient","ODS","RequestStreamHandler","SCIsolationRollout","ThrottlingClient","TransportSelectingClientUtils","asyncToGeneratorRuntime","uuidv4"],(function(t,n,r,o,a,i,l){var e,s="streamcontroller",u=(function(){function t(){this.$1=null,r("DGWRequestStreamDeferredClient")!=null&&(this.$2=new(r("ThrottlingClient"))(r("DGWRequestStreamDeferredClient")))}var a=t.prototype;return a.requestStream=(function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,n,a,i){var l,u=new(r("RequestStreamHandler"))(a),c=this.$2;if(c!=null&&r("DGWEnvUtil").isDGWEnvCompatible()){t.method!=null&&(e||(e=o("ODS"))).bumpEntityKey(110,"TransportSelectingClient",t.method+".dgw_client.request_stream");var d=yield c.createStream(t,n,i,u,{deviceId:r("uuidv4")(),serviceId:o("SCIsolationRollout").shouldUseSCIsolation(t.method)?s:null});return yield d.start(),d}t.method!=null&&(e||(e=o("ODS"))).bumpEntityKey(110,"TransportSelectingClient",t.method+".bladerunner_client.request_stream");var m=yield r("BladeRunnerDeferredClient").requestStream(t,n,o("TransportSelectingClientUtils").BRHandlerConverter(u,(l=t.method)!=null?l:"unknown"),i);return m});function a(e,n,r,o){return t.apply(this,arguments)}return a})(),t})();l.default=u}),98);
__d("TransportSelectingClientSingleton",["TransportSelectingClient"],(function(t,n,r,o,a,i,l){"use strict";var e=new(r("TransportSelectingClient"));l.default=e}),98);
__d("VideoDisplayTimePlayButton",["CSS","DataStore","Event"],(function(t,n,r,o,a,i,l){"use strict";var e={},s="_spinner";function u(e){return o("DataStore").get(e,"clicked",!1)}function c(t,n){var a=t.id;e[a]=r("Event").listen(t,"click",function(){n&&(o("CSS").hide(t),o("CSS").show(n)),o("DataStore").set(t,"clicked",!0)}),n&&(e[a+s]=r("Event").listen(n,"click",function(){n&&o("CSS").hide(n),o("CSS").show(t),o("DataStore").set(t,"clicked",!1)}))}function d(t){var n=t.id;Object.prototype.hasOwnProperty.call(e,n)&&e[n].remove();var r=n+s;Object.prototype.hasOwnProperty.call(e,r)&&e[r].remove()}l.getClicked=u,l.register=c,l.unregister=d}),98);
__d("VideosRenderingInstrumentation",["DataStore","VideoPlayerHTML5Experiments","performanceAbsoluteNow"],(function(t,n,r,o,a,i,l){var e;function s(t){var n=r("VideoPlayerHTML5Experiments").useMonotonicallyIncreasingTimers?(e||(e=r("performanceAbsoluteNow")))():Date.now();return o("DataStore").set(t,"videos_rendering_instrumentation",n),n}function u(e){var t=o("DataStore").get(e,"videos_rendering_instrumentation",NaN);return Number.isNaN(t)&&(t=s(e)),t}l.storeRenderTime=s,l.retrieveRenderTime=u}),98);